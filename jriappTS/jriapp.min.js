var RIAPP;
(function(a){a.ERRS={ERR_APP_NEED_JQUERY:"The project is dependent on JQuery",ERR_ASSERTION_FAILED:'Assertion "{0}" was not satisfied',ERR_BINDING_CONTENT_NOT_FOUND:"BindingContent is not found",ERR_DBSET_READONLY:"DbSet: {0} is readOnly and can not be edited",ERR_DBSET_INVALID_FIELDNAME:"DbSet: {0} has no field with the name: {1}",ERR_FIELD_READONLY:"Field is readOnly and can not be edited",ERR_FIELD_ISNOT_NULLABLE:"Field is not nullable and can not be set to null",ERR_FIELD_WRONG_TYPE:"Value: {0} can not be assigned to {1} type field",ERR_FIELD_MAXLEN:"Value exceeds field maxlength: {0}",
ERR_FIELD_DATATYPE:"Unknown field data type: {0}",ERR_FIELD_REGEX:"Value {0} can not be accepted as the right value for this field",ERR_FIELD_RANGE:"Value {0} is outside the allowed range {1} for this field",ERR_EVENT_INVALID:"Invalid event name: {0}",ERR_EVENT_INVALID_FUNC:"Invalid event function value",ERR_MODULE_UNDEFINED:"User module: {0} is undefined",ERR_MODULE_ALREDY_REGISTERED:"User module: {0} is already registered",ERR_PROP_NAME_EMPTY:"Empty property name parameter",ERR_GLOBAL_SINGLTON:"There must be only one instance of Global object",
ERR_OBJ_ALREADY_REGISTERED:"Object with the name: {0} is already registered in the type system",ERR_TEMPLATE_ALREADY_REGISTERED:"TEMPLATE with the name: {0} is already registered",ERR_TEMPLATE_NOTREGISTERED:"TEMPLATE with the name: {0} is not registered",ERR_TEMPLATE_GROUP_NOTREGISTERED:"TEMPLATE's group: {0} is not registered",ERR_CONVERTER_NOTREGISTERED:"Converter: {0} is not registered",ERR_JQUERY_DATEPICKER_NOTFOUND:"Application is dependent on JQuery.UI.datepicker",ERR_PARAM_INVALID:"Parameter: {0} has invalid value: {1}",
ERR_PARAM_INVALID_TYPE:"Parameter: {0} has invalid type. Must be {1}",ERR_KEY_IS_EMPTY:"Key value must not be empty",ERR_KEY_IS_NOTFOUND:"Can not find item with the key: {0}",ERR_ITEM_IS_ATTACHED:"Operation invalid, reason: Item already has been attached",ERR_ITEM_IS_DETACHED:"Operation invalid, reason: Item is detached",ERR_ITEM_IS_NOTFOUND:"Operation invalid, reason: Item is not found",ERR_ITEM_NAME_COLLISION:'The "{0}" DbSet\'s field name: "{1}" is invalid, because a property with that name already exists on the entity type.',
ERR_DICTKEY_IS_NOTFOUND:"Dictionary keyName: {0} does not exist in item's properties",ERR_DICTKEY_IS_EMPTY:"Dictionary key property: {0} must be not empty",ERR_CONV_INVALID_DATE:"Converter cannot parse datetime string value: {0}",ERR_CONV_INVALID_NUM:"Converter cannot parse numeric string value: {0}",ERR_QUERY_NAME_NOTFOUND:"Can not find Query with the name: {0}",ERR_QUERY_BETWEEN:'"BETWEEN" Query operator expects two values',ERR_QUERY_OPERATOR_INVALID:"Invalid query operator {0}",ERR_OPER_REFRESH_INVALID:"Refresh operation can not be done with items in Detached or Added State",
ERR_CALC_FIELD_DEFINE:'Field: "{0}" definition error: Calculated fields can be dependent only on items fields',ERR_CALC_FIELD_SELF_DEPEND:'Field: "{0}" definition error: Calculated fields can not be dependent on themselves',ERR_DOMAIN_CONTEXT_INITIALIZED:"DbContext already initialized",ERR_DOMAIN_CONTEXT_NOT_INITIALIZED:"DbContext is not initialized",ERR_SVC_METH_PARAM_INVALID:"Invalid parameter {0} value {1} for service method: {2} invocation",ERR_DB_LOAD_NO_QUERY:"Query parameter is not supplied",
ERR_DBSET_NAME_INVALID:"Invalid dbSet Name: {0}",ERR_APP_NAME_NOT_UNIQUE:"Application instance with the name: {0} already exists",ERR_ELVIEW_NOT_REGISTERED:"Can not find registered element view with the name: {0}",ERR_ELVIEW_NOT_CREATED:"Can not create element view for element with Tag Name: {0}",ERR_BIND_TARGET_EMPTY:"Binding target is empty",ERR_BIND_TGTPATH_INVALID:"Binding targetPath has invalid value: {0}",ERR_BIND_MODE_INVALID:"Binding mode has invalid value: {0}",ERR_BIND_TARGET_INVALID:"Binding target must be a descendant of BaseObject",
ERR_APP_SETUP_INVALID:"Application's setUp method parameter must be a valid function",ERR_GRID_DATASRC_INVALID:"DataGrid's datasource must be a descendant of Collection type",ERR_COLLECTION_CHANGETYPE_INVALID:"Invalid Collection change type value: {0}",ERR_GRID_COLTYPE_INVALID:"Invalid Column type type value: {0}",ERR_PAGER_DATASRC_INVALID:"Pager datasource must be a descendant of Collection type",ERR_STACKPNL_DATASRC_INVALID:"StackPanel datasource must be a descendant of Collection type",ERR_STACKPNL_TEMPLATE_INVALID:"StackPanel templateID is not provided in the options",
ERR_LISTBOX_DATASRC_INVALID:"ListBox datasource must be a descendant of Collection type",ERR_DATAFRM_DCTX_INVALID:"DataForm's dataContext must be a descendant of BaseObject type",ERR_DCTX_HAS_NO_FIELDINFO:"DataContext has no getFieldInfo method",ERR_TEMPLATE_ID_INVALID:"Element can not be found by TemplateID: {0}",ERR_STRING_FORMAT_INVALID:"String format has invalid expression value: {0}",ERR_ITEM_DELETED_BY_ANOTHER_USER:"The record was deleted by another user",ERR_ACCESS_DENIED:"The access is denied. Please, ask administrator to assign user rights to your account.",
ERR_CONCURRENCY:"The record has been modified by another user. Please, refresh record before editing.",ERR_VALIDATION:"Data validation error",ERR_SVC_VALIDATION:"Data validation error: {0}",ERR_SVC_ERROR:"Service error: {0}",ERR_UNEXPECTED_SVC_ERROR:"Unexpected service error: {0}",ERR_ASSOC_NAME_INVALID:"Invalid association name: {0}",ERR_DATAVIEW_DATASRC_INVALID:"DataView datasource must not be null and should be descendant of Collection type",ERR_DATAVIEW_FILTER_INVALID:"DataView fn_filter option must be valid function which accepts entity and returns bool value"};
a.localizable={PAGER:{firstText:"<<",lastText:">>",previousText:"<",nextText:">",pageInfo:"Page {0} of {1}",firstPageTip:"to first page",prevPageTip:"back to page {0}",nextPageTip:"next to page {0}",lastPageTip:"last page",showingTip:"showing result {0} to {1} of {2}",showTip:"show result {0} to {1} of {2}"},VALIDATE:{errorInfo:"Validation errors:",errorField:"field:"},TEXT:{txtEdit:"Edit",txtAddNew:"Add new",txtDelete:"Delete",txtCancel:"Cancel",txtOk:"Ok",txtRefresh:"Refresh",txtAskDelete:"Are you sure, you want to delete row?",
txtSubmitting:"Submitting data ...",txtSave:"Save",txtClose:"Close",txtField:"Field"}}})(RIAPP||(RIAPP={}));"use strict";
(function(a){var r=function(){function a(){}a.clone=function(a){return 1===a.length?[a[0]]:Array.apply(null,a)};a.fromList=function(a){for(var e=Array(a.length),f=0,l=a.length;f<l;f++)e[f]=a[f];return e};a.fromCollection=function(q){return a.fromList(q)};a.distinct=function(a){var e={},f,l=a.length,b=[];for(f=0;f<l;f+=1)e[a[f]]=a[f];a=Object.keys(e);f=0;for(l=a.length;f<l;f+=1)b.push(e[a[f]]);return b};return a}();a.ArrayHelper=r;var k=function(){function g(){}g.isFunc=function(a){if(!a)return!1;
var e=/Function/;return"function"===typeof a?e.test(a.constructor.toString()):!1};g.endsWith=function(a,e){return a.substr(a.length-e.length)===e};g.startsWith=function(a,e){return a.substr(0,e.length)===e};g.fastTrim=function(a){return a.replace(/^\s+|\s+$/g,"")};g.trim=function(a,e){return!e?g.fastTrim(a):g.ltrim(g.rtrim(a,e),e)};g.ltrim=function(a,e){return a.replace(RegExp("^["+(e||"\\s")+"]+","g"),"")};g.rtrim=function(a,e){return a.replace(RegExp("["+(e||"\\s")+"]+$","g"),"")};g.isArray=function(a){return!a?
!1:Array.isArray(a)};g.format=function(q){for(var e=[],f=0;f<arguments.length-1;f++)e[f]=arguments[f+1];for(var f="",l=0;;){var b=q.indexOf("{",l),d=q.indexOf("}",l);if(0>b&&0>d){f+=q.slice(l);break}if(0<d&&(d<b||0>b)){if("}"!==q.charAt(d+1))throw Error(g.format(a.ERRS.ERR_STRING_FORMAT_INVALID,q));f+=q.slice(l,d+1);l=d+2}else if(f+=q.slice(l,b),l=b+1,"{"===q.charAt(l))f+="{",l++;else{if(0>d)throw Error(g.format(a.ERRS.ERR_STRING_FORMAT_INVALID,q));var b=q.substring(l,d),c=b.indexOf(":"),l=parseInt(0>
c?b:b.substring(0,c),10);if(isNaN(l))throw Error(g.format(a.ERRS.ERR_STRING_FORMAT_INVALID,q));b=0>c?"":b.substring(c+1);l=e[l];if(void 0===l||null===l)l="";f=l.format?f+l.format(b):f+l.toString();l=d+1}}return f};return g}();a.baseUtils=k;k=function(){function g(){this._isDestroyCalled=this._isDestroyed=!1;this.__events=null}g.prototype._getEventNames=function(){return["error","destroyed"]};g.prototype._addHandler=function(q,e,f,l){if(!this._isDestroyed){if(!a.baseUtils.isFunc(e))throw Error(a.ERRS.ERR_EVENT_INVALID_FUNC);
if(!q)throw Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,q));null===this.__events&&(this.__events={});var b=this.__events,d="*";f&&(d=""+f);b[q]||(b[q]=[]);q=b[q];q.some(function(a){return a.fn===e&&a.ns==d})||(l?q.unshift({fn:e,ns:d}):q.push({fn:e,ns:d}))}};g.prototype._removeHandler=function(a,e){var f=this.__events,l="*";if(f){e&&(l=""+e);var b,d,c;if(a){if(f[a])if("*"==l)delete f[a];else{b=f[a];d=b.filter(function(a){return a.ns==l});for(c=b.length;0<c;)c-=1,-1<d.indexOf(b[c])&&b.splice(c,
1);0==b.length&&delete f[a]}}else"*"!=l?Object.keys(f).forEach(function(a){var b=f[a],d=b.filter(function(a){return a.ns==l});for(c=b.length;0<c;)c-=1,-1<d.indexOf(b[c])&&b.splice(c,1);0==b.length&&delete f[a]}):this.__events=null}};g.prototype._raiseEvent=function(q,e){var f=this,l=f.__events;if(null!==l){if(void 0===l)throw Error("Object's constructor was not called");q&&("0*"!=q&&a.baseUtils.startsWith(q,"0")&&this._raiseEvent("0*",e),l[q]&&r.clone(l[q]).forEach(function(a){a.fn.apply(f,[f,e])}))}};
g.prototype._onError=function(q,e){if(a.global&&a.global._checkIsDummy(q))return!0;q.message||(q=Error(""+q));var f={error:q,source:e,isHandled:!1};this._raiseEvent("error",f);return f.isHandled};g.prototype._checkEventName=function(q){if(-1===this._getEventNames().indexOf(q))throw Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,q));};g.prototype.raisePropertyChanged=function(a){this._raiseEvent("0"+a,{property:a})};g.prototype.addHandler=function(a,e,f){this._checkEventName(a);this._addHandler(a,
e,f,!1)};g.prototype.removeHandler=function(a,e){a&&this._checkEventName(a);this._removeHandler(a,e)};g.prototype.addOnDestroyed=function(a,e){this._addHandler("destroyed",a,e,!1)};g.prototype.removeOnDestroyed=function(a){this._removeHandler("destroyed",a)};g.prototype.addOnError=function(a,e){this._addHandler("error",a,e,!1)};g.prototype.removeOnError=function(a){this.removeHandler("error",a)};g.prototype.removeNSHandlers=function(a){this._removeHandler(null,a)};g.prototype.raiseEvent=function(a,
e){this._checkEventName(a);this._raiseEvent(a,e)};g.prototype.addOnPropertyChange=function(q,e,f){if(!q)throw Error(a.ERRS.ERR_PROP_NAME_EMPTY);this._addHandler("0"+q,e,f,!1)};g.prototype.removeOnPropertyChange=function(a,e){a&&(a="0"+a);this._removeHandler(a,e)};g.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=this._isDestroyed=!0;try{this._raiseEvent("destroyed",{})}finally{this.__events=null}}};return g}();a.BaseObject=k})(RIAPP||(RIAPP={}));
var __extends=this.__extends||function(a,r){function k(){this.constructor=a}k.prototype=r.prototype;a.prototype=new k};
(function(a){a.global=null;a.css_riaTemplate="ria-template";var r=function(k){function g(q,e){k.call(this);if(a.global)throw Error(a.ERRS.ERR_GLOBAL_SINGLTON);if(!e)throw Error(a.ERRS.ERR_APP_NEED_JQUERY);this._window=q;this._appInst={};this._$=e;this._currentSelectable=null;this._userCode={};this._exports={};this._templateLoaders={};this._templateGroups={};this._promises=[];this._moduleNames=[];this._parser=null;this._isReady=!1;this._init()}__extends(g,k);g.vesion="2.0.0.1";g._TEMPLATES_SELECTOR=
["section.",a.css_riaTemplate].join("");g._TEMPLATE_SELECTOR='*[data-role="template"]';g.create=function(a,e){return new g(a,e)};g.prototype._init=function(){var q=this;q.$(q.document).ready(function(e){q._waitQueue=new a.MOD.utils.WaitQueue(q);q._isReady=!0;q._processTemplateSections(q.document);q.raiseEvent("load",{});setTimeout(function(){q.removeHandler("load",null)},0)});q.$(q.document).on("click.global",function(a){a.stopPropagation();q.currentSelectable=null});q.$(q.document).on("keydown.global",
function(a){a.stopPropagation();q._currentSelectable&&q._currentSelectable._onKeyDown(a.which,a)});q.$(q.document).on("keyup.global",function(a){a.stopPropagation();q._currentSelectable&&q._currentSelectable._onKeyUp(a.which,a)});q.$(q.window).unload(function(){q.raiseEvent("unload",{})});q.window.onerror=function(a,f,l){if(a&&-1<a.indexOf("DUMMY_ERROR"))return!0;alert("Error message: "+a+"\nURL: "+f+"\nLine Number: "+l);return!1}};g.prototype._registerObjectCore=function(q,e,f,l){var b=e.split("."),
d;for(d=0;d<b.length-1;d+=1)q[b[d]]||(q[b[d]]={}),q=q[b[d]];b=b[b.length-1];if(l&&q[b])throw Error(a.baseUtils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,e));q[b]=f;return q};g.prototype._getObjectCore=function(a,e){var f=e.split("."),l=a,b,d;for(b=0;b<f.length;b+=1){d=l[f[b]];if(!d)return null;l=d}return d};g.prototype._removeObjectCore=function(a,e){var f=e.split("."),l=a,b;b=null;for(b=0;b<f.length-1;b+=1){if(!l[f[b]])return null;l=l[f[b]]}f=f[f.length-1];(b=l[f])&&delete l[f];return b};g.prototype._getEventNames=
function(){var a=k.prototype._getEventNames.call(this);return["load","unload"].concat(a)};g.prototype.addOnLoad=function(a,e){this._addHandler("load",a,e,!1)};g.prototype.addOnUnLoad=function(a,e){this._addHandler("unload",a,e,!1)};g.prototype._addHandler=function(a,e,f,l){var b=this;"load"==a&&b._isReady?setTimeout(function(){e.apply(b,[b,{}])},0):k.prototype._addHandler.call(this,a,e,f,l)};g.prototype._trackSelectable=function(a){var e=this,f=e.utils,l=a.containerEl;e.$(l).on("click."+a.uniqueID,
function(b){b.stopPropagation();f.isContained(b.target,l)&&(e.currentSelectable=a)})};g.prototype._untrackSelectable=function(a){this.$(a.containerEl).off("click."+a.uniqueID);this.currentSelectable===a&&(this.currentSelectable=null)};g.prototype._registerApp=function(a){this._appInst[a.appName]||(this._appInst[a.appName]=a)};g.prototype._unregisterApp=function(a){this._appInst[a.appName]&&(delete this._appInst[a.appName],delete this._templateLoaders[a.appName],delete this._templateGroups[a.appName])};
g.prototype._destroyApps=function(){var a=this;this.utils.forEachProp(this._appInst,function(e){a._appInst[e].destroy()})};g.prototype._throwDummy=function(g){var e=a.MOD.errors;if(e&&g&&!g.isDummy)throw e.DummyError.create(g);throw g;};g.prototype._checkIsDummy=function(a){return!!a.isDummy};g.prototype._registerObject=function(a,e,f){return this._registerObjectCore(a._exports,e,f,!0)};g.prototype._getObject=function(a,e){return this._getObjectCore(a._exports,e)};g.prototype._removeObject=function(a,
e){return this._removeObjectCore(a._exports,e)};g.prototype._processTemplateSections=function(q){var e=this;a.ArrayHelper.fromList(q.querySelectorAll(g._TEMPLATES_SELECTOR)).forEach(function(a){e._processTemplateSection(a,null);e.utils.removeNode(a)})};g.prototype._processTemplateSection=function(q,e){var f=this;a.ArrayHelper.fromList(q.querySelectorAll(g._TEMPLATE_SELECTOR)).forEach(function(a){var b=f.document.createElement("div"),d=a.getAttribute("id"),c=f.utils.createDeferred();a.removeAttribute("id");
b.appendChild(a);c.resolve(b.innerHTML);e&&(d=e.appName+"."+d);f._registerTemplateLoader(d,{fn_loader:function(){return c.promise()}})})};g.prototype._registerTemplateLoaderCore=function(a,e){return this._registerObjectCore(this._templateLoaders,a,e,!1)};g.prototype._getTemplateLoaderCore=function(a){return this._getObjectCore(this._templateLoaders,a)};g.prototype._loadTemplatesAsync=function(a,e){var f=this,l=a(),b=f.isLoading;f._promises.push(l);f.isLoading!==b&&f.raisePropertyChanged("isLoading");
var d=f.utils.createDeferred();l.done(function(a){f.utils.removeFromArray(f._promises,l);try{var b=f.document.createElement("div");b.innerHTML=a;f._processTemplateSection(b,e);d.resolve()}catch(g){f._onError(g,f),d.reject()}f.isLoading||f.raisePropertyChanged("isLoading")});l.fail(function(a){f.utils.removeFromArray(f._promises,l);f.isLoading||f.raisePropertyChanged("isLoading");d.reject();a&&a.message?f._onError(a,f):a&&a.responseText?f._onError(Error(a.responseText),f):f._onError(Error("Failed to load templates"),
f)});return d.promise()};g.prototype._registerTemplateLoader=function(g,e){e=this.utils.extend(!1,{fn_loader:null,groupName:null},e);if(!e.groupName&&!this.utils.check.isFunction(e.fn_loader))throw Error(a.baseUtils.format(a.ERRS.ERR_ASSERTION_FAILED,"fn_loader is Function"));var f=this._getTemplateLoaderCore(g);if(f){if(!f.fn_loader&&f.groupName&&!e.groupName&&e.fn_loader)return this._registerTemplateLoaderCore(g,e);throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_ALREADY_REGISTERED,g));}return this._registerTemplateLoaderCore(g,
e)};g.prototype._getTemplateLoader=function(g){var e=this,f=e._getTemplateLoaderCore(g);if(!f)return null;if(!f.fn_loader&&f.groupName){var l=e._getTemplateGroup(f.groupName);if(!l)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_GROUP_NOTREGISTERED,f.groupName));return function(){l.promise||(l.promise=e._loadTemplatesAsync(l.fn_loader,l.app));var b=e.utils.createDeferred();l.promise.done(function(){try{l.promise=null;l.names.forEach(function(b){l.app&&(b=l.app.appName+"."+b);var c=e._getTemplateLoaderCore(b);
if(!c||!c.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,b));});var d=e._getTemplateLoaderCore(g);if(!d||!d.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,g));delete e._templateGroups[d.groupName];d.fn_loader().done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)})}catch(c){b.reject(c)}});l.promise.fail(function(a){l.promise=null;b.reject(a)});return b.promise()}}return f.fn_loader};g.prototype._registerTemplateGroup=function(a,e){var f=
this;e=f.utils.extend(!1,{fn_loader:null,url:null,names:null,app:null,promise:null},e);e.url&&!e.fn_loader&&(e.fn_loader=function(){return f.utils.performAjaxGet(e.url)});this._registerObjectCore(f._templateGroups,a,e,!0);e.names.forEach(function(l){e.app&&(l=e.app.appName+"."+l);f._registerTemplateLoader(l,{groupName:a,fn_loader:null})})};g.prototype._getTemplateGroup=function(a){return this._getObjectCore(this._templateGroups,a)};g.prototype._waitForNotLoading=function(a,e){this._waitQueue.enQueue({prop:"isLoading",
groupName:null,predicate:function(a){return!a},action:a,actionArgs:e})};g.prototype.reThrow=function(a,e){if(e)this._throwDummy(a);else throw a;};g.prototype.onModuleLoaded=function(g,e){if(this.isModuleLoaded(g))throw Error(a.baseUtils.format("Module: {0} is already loaded!",g));this._moduleNames.push(g);switch(g){case "utils":this._utils=new a.MOD.utils.Utils;break;case "defaults":this._defaults=new a.MOD.defaults.Defaults;this._defaults.dateFormat="dd.mm.yy";this._defaults.imagesPath="/Scripts/jriapp/img/";
break;case "parser":this._parser=new a.MOD.parser.Parser}};g.prototype.isModuleLoaded=function(a){return-1<this._moduleNames.indexOf(a)};g.prototype.findApp=function(a){return this._appInst[a]};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue&&(this._waitQueue.destroy(),this._waitQueue=null),this._promises=[],this.removeHandler(),this._destroyApps(),this._exports={},this._templateLoaders={},this._templateGroups={},this._parser=null,this.$(this.document).off(".global"),
a.global=null,this.window.onerror=null,k.prototype.destroy.call(this))};g.prototype.registerType=function(a,e){return this._registerObject(this,"types."+a,e)};g.prototype.getType=function(a){return this._getObject(this,"types."+a)};g.prototype.registerConverter=function(g,e){var f="converters."+g;if(this._getObject(this,f))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,g));this._registerObject(this,f,e)};g.prototype._getConverter=function(g){var e=this._getObject(this,"converters."+
g);if(!e)throw Error(this.utils.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,g));return e};g.prototype.registerElView=function(g,e){var f="elvws."+g;if(this._getObject(this,f))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,g));this._registerObject(this,f,e)};g.prototype.getImagePath=function(a){return this.defaults.imagesPath+a};g.prototype.loadTemplates=function(a){var e=this;this._loadTemplatesAsync(function(){return e.utils.performAjaxGet(a)},null)};g.prototype.toString=function(){return"Global"};
Object.defineProperty(g.prototype,"parser",{get:function(){return this._parser},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"isLoading",{get:function(){return 0<this._promises.length},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"$",{get:function(){return this._$},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"window",{get:function(){return this._window},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"document",{get:function(){return this._window.document},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"currentSelectable",{get:function(){return this._currentSelectable},set:function(a){this._currentSelectable!==a&&(this._currentSelectable=a,this.raisePropertyChanged("currentSelectable"))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"defaults",{get:function(){return this._defaults},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"consts",{get:function(){return a.MOD.consts},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"utils",{get:function(){return this._utils},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"UC",{get:function(){return this._userCode},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"moduleNames",{get:function(){return a.ArrayHelper.clone(this._moduleNames)},enumerable:!0,configurable:!0});return g}(a.BaseObject);a.Global=r;a.global=r.create(window,jQuery)})(RIAPP||(RIAPP={}));
(function(a){var r=a.MOD||(a.MOD={}),r=r.consts||(r.consts={});r.CHUNK_SEP="$&@";r.DATA_ATTR={EL_VIEW_KEY:"data-elvwkey",DATA_BIND:"data-bind",DATA_VIEW:"data-view",DATA_APP:"data-app",DATA_EVENT_SCOPE:"data-scope",DATA_ITEM_KEY:"data-key",DATA_CONTENT:"data-content",DATA_COLUMN:"data-column",DATA_NAME:"data-name"};r.DATA_TYPE={None:0,String:1,Bool:2,Integer:3,Decimal:4,Float:5,DateTime:6,Date:7,Time:8,Guid:9,Binary:10};r.DATE_CONVERSION={None:0,ServerLocalToClientLocal:1,UtcToClientLocal:2};r.CHANGE_TYPE=
{NONE:0,ADDED:1,UPDATED:2,DELETED:3};r.KEYS={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:127};r.ELVIEW_NM={DATAFORM:"dataform",DYNACONT:"dynacontent"};r.LOADER_GIF={SMALL:"loader2.gif",NORMAL:"loader.gif"};a.global.onModuleLoaded("consts",r)})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){function g(a,p,t){var b=t||{};Object.getOwnPropertyNames(b).forEach(function(a){a=b[a];void 0===a.enumerable&&(a.enumerable=!0);void 0===a.configurable&&(a.configurable=!1)});if(p)for(var c=Object.getOwnPropertyNames(p),d=0,f=c.length;d<f;d+=1)t=c[d],b.hasOwnProperty(t)||(b[t]=Object.getOwnPropertyDescriptor(p,t));return Object.defineProperties(a,b)}function q(a,p){function t(){this.constructor=a}t.prototype=p.prototype;a.prototype=new t}var e=a.baseUtils,f=
0;k.defineProps=g;k.__extendType=function(a,p,t){var b=function(){a.apply(this,arguments)};q(b,a);g(b.prototype,p,t);return b};var l=function(){function b(){}b.isNull=function(a){return null===a};b.isUndefined=function(a){return void 0===a};b.isNt=function(a){return null===a||void 0===a};b.isFunction=e.isFunc;b.isString=function(a){if(b.isNt(a))return!1;var t=/string/i;return"string"===typeof a?!0:"object"===typeof a?t.test(a.constructor.toString()):!1};b.isArray=e.isArray;b.isBoolean=function(a){if(b.isNt(a))return!1;
var t=/boolean/i;return"boolean"===typeof a?!0:"object"===typeof a?t.test(a.constructor.toString()):!1};b.isDate=function(a){if(b.isNt(a))return!1;var t=/date/i;return"date"===typeof a?!0:"object"===typeof a?t.test(a.constructor.toString()):!1};b.isHTML=function(a){if(b.isNt(a))return!1;var t=/html/i;return"object"===typeof a?t.test(a.constructor.toString()):!1};b.isNumber=function(a){if(b.isNt(a))return!1;var t=/Number/;return"number"===typeof a?!0:"object"===typeof a?t.test(a.constructor.toString()):
!1};b.isObject=function(a){if(b.isNt(a))return!1;var t=/object/i;return"object"===typeof a?t.test(a.constructor.toString()):!1};b.isSimpleObject=function(a){return b.isNt(a)?!1:b.isObject(a)&&Object.prototype===Object.getPrototypeOf(a)};b.isRegExp=function(a){if(b.isNt(a))return!1;var t=/regexp/i;return"function"===typeof a?t.test(a.constructor.toString()):!1};b.isNumeric=function(a){return b.isNumber(a)||b.isString(a)&&!isNaN(Number(a))};b.isBoolString=function(a){return b.isNt(a)?!1:"true"==a||
"false"==a};b.isProtoOf=function(a,b){return!!b&&b instanceof a};b.isBaseObj=function(p){return!!p&&p instanceof a.BaseObject};b.isBinding=function(p){return!!p&&p instanceof a.MOD.binding.Binding};b.isElView=function(p){return!!p&&p instanceof a.MOD.baseElView.BaseElView};b.isTemplateElView=function(p){return!!p&&p instanceof a.MOD.baseElView.TemplateElView};b.isEditable=function(p){return!!p&&!!p.beginEdit&&!!p.endEdit&&!!p.cancelEdit&&a.global.utils.hasProp(p,"isEditing")};b.isDataForm=function(p){if(!p)return!1;
p=p.getAttribute(a.global.consts.DATA_ATTR.DATA_VIEW);if(!p)return!1;p=a.global.parser.parseOptions(p);return 0<p.length&&p[0].name===a.global.consts.ELVIEW_NM.DATAFORM};b.isInsideDataForm=function(a){return!a?!1:(a=a.parentElement)?b.isDataForm(a)?!0:b.isInsideDataForm(a):!1};return b}();k.Checks=l;var b=function(){function a(){}a.endsWith=e.endsWith;a.startsWith=e.startsWith;a.trim=e.trim;a.formatNumber=function(a,b,c,d){a=(a+"").replace(/[^0-9+-Ee.]/g,"");var f=!isFinite(+a)?0:+a;a=!isFinite(+b)?
0:Math.abs(b);d=void 0===d?",":d;c=void 0===c?".":c;var h=[""],h=function(a,p){var n=Math.pow(10,p);return""+Math.round(a*n)/n};l.isNt(b)?(h=(""+f).split("."),a=2):h=(a?h(f,a):""+Math.round(f)).split(".");var f="",m=h[0].length;if(3<m){for(b=0;b<m;b+=1)f+=h[0].charAt(b),b<m-1&&0===(m-b-1)%3&&(f+=d);h[0]=f}if((h[1]||"").length<a)h[1]=h[1]||"",h[1]+=Array(a-h[1].length+1).join("0");return h.join(c)};a.stripNonNumeric=function(a){a+="";for(var b=/^\d|\.|-$/,c="",d=0;d<a.length;d++)b.test(a.charAt(d))&&
("."==a.charAt(d)&&-1!=c.indexOf(".")||"-"==a.charAt(d)&&0!=c.length||(c+=a.charAt(d)));return c};return a}();k.StringUtils=b;var d=function(){function b(){}b.checkNumRange=function(p,b){var c=b.split(",");if(c[0]&&p<parseFloat(c[0]))throw Error(e.format(a.ERRS.ERR_FIELD_RANGE,p,b));if(c[1]&&p>parseFloat(c[1]))throw Error(e.format(a.ERRS.ERR_FIELD_RANGE,p,b));};b._dtRangeToDate=function(a){a=a.split("-");return new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10))};b.checkDateRange=function(p,
t){var c=t.split(",");if(c[0]&&p<b._dtRangeToDate(c[0]))throw Error(e.format(a.ERRS.ERR_FIELD_RANGE,p,t));if(c[1]&&p>b._dtRangeToDate(c[1]))throw Error(e.format(a.ERRS.ERR_FIELD_RANGE,p,t));};return b}();k.Validations=d;k.valueUtils={valueToDate:function(b,p,t){if(!b)return null;b=""+b;var c=b.split("&");if(7!=c.length)throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"val",b));b=new Date(parseInt(c[0],10),parseInt(c[1],10)-1,parseInt(c[2],10),parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),parseInt(c[6],
10));var c=r.consts.DATE_CONVERSION,d=a.global.utils.get_timeZoneOffset();switch(p){case c.None:break;case c.ServerLocalToClientLocal:b.setMinutes(b.getMinutes()+t);b.setMinutes(b.getMinutes()-d);break;case c.UtcToClientLocal:b.setMinutes(b.getMinutes()-d);break;default:throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"dtcnv",p));}return b},dateToValue:function(b,p,c){if(null===b)return null;if(!l.isDate(b))throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"dt",b));var d=r.consts.DATE_CONVERSION,f=a.global.utils.get_timeZoneOffset();
switch(p){case d.None:break;case d.ServerLocalToClientLocal:b.setMinutes(b.getMinutes()+f);b.setMinutes(b.getMinutes()-c);break;case d.UtcToClientLocal:b.setMinutes(b.getMinutes()+f);break;default:throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"dtcnv",p));}return""+b.getFullYear()+"&"+(b.getMonth()+1)+"&"+b.getDate()+"&"+b.getHours()+"&"+b.getMinutes()+"&"+b.getSeconds()+"&"+b.getMilliseconds()},compareVals:function(a,p,b){if(null===a&&null!==p||null!==a&&null===p)return!1;var c=r.consts.DATA_TYPE;
switch(b){case c.DateTime:case c.Date:case c.Time:return l.isDate(a)&&l.isDate(p)?a.getTime()===p.getTime():!1;default:return a===p}},stringifyValue:function(a,p,b){return l.isNt(a)?null:l.isDate(a)?k.valueUtils.dateToValue(a,p,b):""+a},parseValue:function(b,p,c,d){var f=null;if(void 0===b||null===b)return f;f=r.consts.DATA_TYPE;switch(p){case f.None:f=b;break;case f.String:f=b;break;case f.Bool:f=a.global.utils.parseBool(b);break;case f.Integer:f=parseInt(b,10);break;case f.Decimal:case f.Float:f=
parseFloat(b);break;case f.DateTime:case f.Date:case f.Time:f=k.valueUtils.valueToDate(b,c,d);break;case f.Guid:case f.Binary:f=b;break;default:throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"dataType",p));}return f}};var c=function(b){function p(){b.call(this);this._objs=[]}__extends(p,b);p.create=function(){return new p};p.prototype.addObj=function(a){0>this._objs.indexOf(a)&&this._objs.push(a)};p.prototype.removeObj=function(p){a.global.utils.removeFromArray(this._objs,p)};p.prototype.getObjs=function(){return this._objs};
p.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._objs.forEach(function(a){a._isDestroyCalled||a.destroy()}),this._objs=[],b.prototype.destroy.call(this))};p.prototype.toString=function(){return"LifeTimeScope"};return p}(a.BaseObject);k.LifeTimeScope=c;var h=function(b){function p(){b.call(this);this._objId="prw"+a.global.utils.getNewID();this._objs=[]}__extends(p,b);p.create=function(){return new p};p.prototype.addPropWatch=function(a,p,b){a.addOnPropertyChange(p,
function(a,p){b(p.property)},this.uniqueID);0>this._objs.indexOf(a)&&this._objs.push(a)};p.prototype.addWatch=function(a,p,b){a.addOnPropertyChange("*",function(a,c){-1<p.indexOf(c.property)&&b(c.property)},this.uniqueID);0>this._objs.indexOf(a)&&this._objs.push(a)};p.prototype.removeWatch=function(a){a.removeNSHandlers(this.uniqueID)};p.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this;this._objs.forEach(function(p){a.removeWatch(p)});this._objs=[];b.prototype.destroy.call(this)}};
p.prototype.toString=function(){return"PropWatcher "+this._objId};Object.defineProperty(p.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});return p}(a.BaseObject);k.PropWatcher=h;var w=function(b){function p(p){b.call(this);this._objId="wq"+a.global.utils.getNewID();this._owner=p;this._queue={}}__extends(p,b);p.create=function(a){return new p(a)};p.prototype._checkQueue=function(a,p){if(this._owner&&!this._owner._isDestroyCalled){var b=this,c=this._queue[a],
d;if(c&&0!=c.length){var m,f,s=null,n=[],u=[],A=[];for(m=0;m<c.length;m+=1)if(d=c[m],d.predicate(p))if(!d.group&&0==n.length){f=d;break}else d.group&&(s||(s=d.group),s===d.group&&n.push(d));if(f)u.push(f),A.push(f);else for(;0<n.length;)d=n.pop(),f||(f=d),f.lastWins?0==u.length&&u.push(d):u.push(d),A.push(d);try{if(0<u.length){for(m=c.length;0<m;)m-=1,-1<A.indexOf(c[m])&&c.splice(m,1);u.forEach(function(a){try{a.action.apply(b._owner,a.args)}catch(n){b._owner._onError(n,b)}})}}finally{0==c.length&&
(delete this._queue[a],this._owner.removeOnPropertyChange(a,this.uniqueID))}}}};p.prototype.enQueue=function(p){p=a.global.utils.extend(!1,{prop:"",groupName:null,predicate:null,action:null,actionArgs:[],lastWins:!1,syncCheck:!1},p);var b=this;if(this._owner){var c=p.prop,d=this._queue[c];d||(d=[],this._queue[c]=d,this._owner.addOnPropertyChange(c,function(a,p){setTimeout(function(){b._isDestroyCalled||b._checkQueue(c,b._owner[c])},0)},b.uniqueID));d.push({predicate:p.predicate,action:p.action,group:p.groupName,
lastWins:p.lastWins,args:!p.actionArgs?[]:p.actionArgs});p.syncCheck?b._checkQueue(c,b._owner[c]):setTimeout(function(){b._isDestroyCalled||b._checkQueue(c,b._owner[c])},0)}};p.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._owner.removeOnPropertyChange(null,this.uniqueID),this._queue={},this._owner=null,b.prototype.destroy.call(this))};p.prototype.toString=function(){return"WaitQueue "+this._objId};Object.defineProperty(p.prototype,"uniqueID",{get:function(){return this._objId},
enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0});return p}(a.BaseObject);k.WaitQueue=w;var v=function(){function c(){this.slice=Array.prototype.slice;this.get_timeZoneOffset=function(){var a=(new Date).getTimezoneOffset();return function(){return a}}();this.format=e.format;this.uuid=function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(b,c){var d,f=[],
h=Math.random;c=c||a.length;if(b)for(d=0;d<b;d+=1)f[d]=a[0|h()*c];else{var m;f[8]=f[13]=f[18]=f[23]="-";f[14]="4";for(d=0;36>d;d+=1)f[d]||(m=0|16*h(),f[d]=a[19==d?m&3|8:m&15])}return f.join("")}}()}c.create=function(){return new c};Object.defineProperty(c.prototype,"check",{get:function(){return l},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"str",{get:function(){return b},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"validation",{get:function(){return d},
enumerable:!0,configurable:!0});c.prototype.getNewID=function(){var a=f;f+=1;return a};c.prototype.isContained=function(a,b){if(!a)return!1;for(;a=a.parentNode;)if(a===b)return!0;return!1};c.prototype.parseBool=function(p){if(l.isBoolean(p))return p;var b=e.trim(p).toLowerCase();if("false"===b)return!1;if("true"===b)return!0;throw Error(this.format(a.ERRS.ERR_PARAM_INVALID,"bool_value",p));};c.prototype.round=function(a,b){return parseFloat(a.toFixed(b))};c.prototype.performAjaxCall=function(p,b,
c,d,f,h){var m=new XMLHttpRequest;m.open("POST",p,c);var e=this.createDeferred();m.responseType="text";m.onload=function(a){200==this.status&&e.resolve(this.response)};m.onerror=function(a){e.reject(Error(a.target.status))};m.ontimeout=function(){e.reject(Error("The request for "+p+" timed out."))};m.timeout=1E3*a.global.defaults.ajaxTimeOut;m.setRequestHeader("Content-Type","application/json; charset=utf-8");m.send(b);b=e.promise();d&&b.done(function(a){d.call(h,a)});f&&b.fail(function(a){f.call(h,
a)});return b};c.prototype.performAjaxGet=function(p){var b=new XMLHttpRequest;b.open("GET",p,!0);var c=this.createDeferred();b.responseType="text";b.onload=function(a){200==this.status&&c.resolve(this.response)};b.onerror=function(a){c.reject(Error(a.target.status))};b.ontimeout=function(){c.reject(Error("The request for "+p+" timed out."))};b.timeout=1E3*a.global.defaults.ajaxTimeOut;b.send(null);return c.promise()};c.prototype.extend=function(a,b,c){return a?this.cloneObj(c,b):this.mergeObj(c,
b)};c.prototype.removeNode=function(a){if(a){var b=a.parentNode;b&&b.removeChild(a)}};c.prototype.insertAfter=function(a,b){var c=a.parentNode;c.lastChild===a?c.appendChild(b):c.insertBefore(b,a.nextSibling)};c.prototype.getProps=function(a){return Object.getOwnPropertyNames(a)};c.prototype.forEachProp=function(a,b){Object.getOwnPropertyNames(a).forEach(b)};c.prototype.addToolTip=function(b,c,d){d={content:{text:c},style:{classes:d?d:null},position:{my:"top left",at:"bottom right",target:b,viewport:a.global.$(a.global.window),
adjust:{method:"flip none",x:0,y:0}},hide:{fixed:!0,delay:250}};b.data("qtip")?c?b.qtip("option","content.text",c):b.qtip("destroy"):c&&b.qtip(d)};c.prototype.hasProp=function(a,b){if(!a)return!1;if(a.hasOwnProperty(b))return!0;if(Object===a)return!1;var c=Object.getPrototypeOf(a);return this.hasProp(c,b)};c.prototype.createDeferred=function(){return a.global.$.Deferred()};c.prototype.cloneObj=function(a,b){var c,d,f;if(!a)return a;if(this.check.isArray(a)){f=a.length;c=Array(f);for(d=0;d<f;d+=1)c[d]=
this.cloneObj(a[d],null)}else if(this.check.isSimpleObject(a)){c=b||{};var h,m=Object.getOwnPropertyNames(a);f=m.length;for(d=0;d<f;d+=1)h=m[d],c[h]=this.cloneObj(a[h],null)}else return a;return c};c.prototype.shallowCopy=function(a){return this.mergeObj(a,{})};c.prototype.mergeObj=function(a,b){b||(b={});if(!a)return b;for(var c=Object.getOwnPropertyNames(a),d,f=0,h=c.length;f<h;f+=1)d=c[f],b[d]=a[d];return b};c.prototype.removeFromArray=function(a,b){var c=a.indexOf(b);-1<c&&a.splice(c,1);return c};
c.prototype.insertIntoArray=function(a,b,c){a.splice(c,0,b)};c.prototype.destroyJQueryPlugin=function(a,b){if(a.data(b))a[b]("destroy")};return c}();k.Utils=v;a.global.registerType("PropWatcher",h);a.global.registerType("LifeTimeScope",c);a.global.registerType("WaitQueue",w);a.global.onModuleLoaded("utils",k)})(r.utils||(r.utils={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=function(a){function e(f){a.call(this);this._message=f;this._isDummy=!1;this._origError=null}__extends(e,a);e.create=function(a){return new e(a)};e.prototype.toString=function(){return this._message};Object.defineProperty(e.prototype,"message",{get:function(){return this._message},set:function(a){this._message=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isDummy",{get:function(){return this._isDummy},set:function(a){this._isDummy=
a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"origError",{get:function(){return this._origError},set:function(a){this._origError=a},enumerable:!0,configurable:!0});return e}(a.BaseObject);k.BaseError=g;g=function(a){function e(f){a.call(this,"DUMMY_ERROR");this._origError=f;this._isDummy=!0}__extends(e,a);e.create=function(a){return new e(a)};return e}(g);k.DummyError=g;a.global.onModuleLoaded("errors",k)})(r.errors||(r.errors={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils;k.NUM_CONV={None:0,Integer:1,Decimal:2,Float:3,SmallInt:4};var q=function(){function a(){}a.prototype.convertToSource=function(a,b,p){return a};a.prototype.convertToTarget=function(a,b,p){return g.check.isNt(a)?null:a};return a}();k.BaseConverter=q;var q=new q,e=function(){function b(){}b.prototype.convertToSource=function(b,c,p){return!b?null:a.global.$.datepicker.parseDate(c,b)};b.prototype.convertToTarget=function(b,c,p){return g.check.isNt(b)?
"":a.global.$.datepicker.formatDate(c,b)};b.prototype.toString=function(){return"DateConverter"};return b}();k.DateConverter=e;var e=new e,f=function(){function b(){}b.prototype.convertToSource=function(b,c,p){if(!b)return null;c=Date.parseExact(b,c);if(!c)throw Error(g.format(a.ERRS.ERR_CONV_INVALID_DATE,b));return c};b.prototype.convertToTarget=function(a,b,p){return g.check.isNt(a)?"":a.toString(b)};b.prototype.toString=function(){return"DateTimeConverter"};return b}();k.DateTimeConverter=f;var f=
new f,l=function(){function b(){}b.prototype.convertToSource=function(b,c,p){if(g.check.isNt(b))return null;p=a.global.defaults;var d=p.decimalPoint,f=4,h=b.replace(p.thousandSep,""),h=h.replace(d,"."),h=g.str.stripNonNumeric(h);if(""===h)return null;d=null;switch(c){case k.NUM_CONV.SmallInt:d=parseInt(h,10);break;case k.NUM_CONV.Integer:d=parseInt(h,10);break;case k.NUM_CONV.Decimal:f=p.decPrecision;d=g.round(parseFloat(h),f);break;case k.NUM_CONV.Float:d=parseFloat(h);break;default:d=Number(h)}if(!g.check.isNumber(d))throw Error(g.format(a.ERRS.ERR_CONV_INVALID_NUM,
b));return d};b.prototype.convertToTarget=function(b,c,p){if(g.check.isNt(b))return"";var d=a.global.defaults;p=d.decimalPoint;var f=d.thousandSep;switch(c){case k.NUM_CONV.Integer:return g.str.formatNumber(b,0,p,f);case k.NUM_CONV.Decimal:return c=d.decPrecision,g.str.formatNumber(b,c,p,f);case k.NUM_CONV.SmallInt:return g.str.formatNumber(b,0,p,"");case k.NUM_CONV.Float:return g.str.formatNumber(b,null,p,f);default:return g.str.formatNumber(b,null,p,f)}};b.prototype.toString=function(){return"NumberConverter"};
return b}();k.NumberConverter=l;var b=new l,l=function(){function a(){}a.prototype.convertToSource=function(a,c,p){return b.convertToSource(a,k.NUM_CONV.Integer,p)};a.prototype.convertToTarget=function(a,c,p){return b.convertToTarget(a,k.NUM_CONV.Integer,p)};a.prototype.toString=function(){return"IntegerConverter"};return a}();k.IntegerConverter=l;var l=new l,d=function(){function a(){}a.prototype.convertToSource=function(a,c,p){return b.convertToSource(a,k.NUM_CONV.SmallInt,p)};a.prototype.convertToTarget=
function(a,c,p){return b.convertToTarget(a,k.NUM_CONV.SmallInt,p)};a.prototype.toString=function(){return"SmallIntConverter"};return a}();k.SmallIntConverter=d;var d=new d,c=function(){function a(){}a.prototype.convertToSource=function(a,c,p){return b.convertToSource(a,k.NUM_CONV.Decimal,p)};a.prototype.convertToTarget=function(a,c,p){return b.convertToTarget(a,k.NUM_CONV.Decimal,p)};a.prototype.toString=function(){return"DecimalConverter"};return a}();k.DecimalConverter=c;var c=new c,h=function(){function a(){}
a.prototype.convertToSource=function(a,c,p){return b.convertToSource(a,k.NUM_CONV.Float,p)};a.prototype.convertToTarget=function(a,c,p){return b.convertToTarget(a,k.NUM_CONV.Float,p)};a.prototype.toString=function(){return"FloatConverter"};return a}();k.FloatConverter=h;h=new h;a.global.registerConverter("BaseConverter",q);a.global.registerConverter("dateConverter",e);a.global.registerConverter("dateTimeConverter",f);a.global.registerConverter("numberConverter",b);a.global.registerConverter("integerConverter",
l);a.global.registerConverter("smallIntConverter",d);a.global.registerConverter("decimalConverter",c);a.global.registerConverter("floatConverter",h);a.global.onModuleLoaded("converter",k)})(r.converter||(r.converter={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=function(g){function e(){g.call(this);this._datepickerRegional=this._imagesPath="";var f=a.global.$;if(!f.datepicker)throw Error(a.ERRS.ERR_JQUERY_DATEPICKER_NOTFOUND);this._datepickerDefaults=f.datepicker.regional[this._datepickerRegional];this._dateTimeFormat="dd.MM.yyyy HH:mm:ss";this._timeFormat="HH:mm:ss";this._decimalPoint=",";this._thousandSep=" ";this._decPrecision=2;this._ajaxTimeOut=600}__extends(e,g);e.create=function(){return new e};e.prototype._setDatePickerRegion=
function(f){var e=a.global.$;this.datepickerDefaults=f?e.datepicker.regional[f]:e.datepicker.regional[""]};e.prototype.toString=function(){return"Defaults"};Object.defineProperty(e.prototype,"ajaxTimeOut",{get:function(){return this._ajaxTimeOut},set:function(a){this._ajaxTimeOut!==a&&(this._ajaxTimeOut=a,this.raisePropertyChanged("ajaxTimeOut"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dateFormat",{get:function(){return this._datepickerDefaults.dateFormat},set:function(f){var e=
a.global.$;this._datepickerDefaults.dateFormat!==f&&(this._datepickerDefaults.dateFormat=f,e.datepicker.setDefaults(this._datepickerDefaults),this.raisePropertyChanged("dateFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(a){this._timeFormat!==a&&(this._timeFormat=a,this.raisePropertyChanged("timeFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dateTimeFormat",{get:function(){return this._dateTimeFormat},
set:function(a){this._dateTimeFormat!==a&&(this._dateTimeFormat=a,this.raisePropertyChanged("timeFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"datepickerDefaults",{get:function(){return this._datepickerDefaults},set:function(f){var e=a.global.$;f||(f=e.datepicker.regional[this._datepickerRegional]);var b=this._datepickerDefaults;this._datepickerDefaults=f;e.datepicker.setDefaults(f);b.dateFormat!==f.dateFormat&&this.raisePropertyChanged("dateFormat")},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"datepickerRegional",{get:function(){return this._datepickerRegional},set:function(a){a||(a="");this._datepickerRegional!==a&&(this._datepickerRegional=a,this._setDatePickerRegion(a),this.raisePropertyChanged("datepickerRegional"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"imagesPath",{get:function(){return this._imagesPath},set:function(f){f||(f="");this._imagesPath!==f&&(a.baseUtils.endsWith(f,"/")?this._imagesPath=f:
this._imagesPath=f+"/",this.raisePropertyChanged("imagesPath"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"decimalPoint",{get:function(){return this._decimalPoint},set:function(a){this._decimalPoint!==a&&(this._decimalPoint=a,this.raisePropertyChanged("decimalPoint"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"thousandSep",{get:function(){return this._thousandSep},set:function(a){this._thousandSep!==a&&(this._thousandSep=a,this.raisePropertyChanged("thousandSep"))},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"decPrecision",{get:function(){return this._decPrecision},set:function(a){this._decPrecision!==a&&(this._decPrecision=a,this.raisePropertyChanged("decPrecision"))},enumerable:!0,configurable:!0});return e}(a.BaseObject);k.Defaults=g;a.global.onModuleLoaded("defaults",k)})(r.defaults||(r.defaults={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=function(){function e(){}e.__trimOuterBracesRX=/^([{]){0,1}|([}]){0,1}$/g;e.__trimQuotsRX=/^(['"])+|(['"])+$/g;e.__trimBracketsRX=/^(\[)+|(\])+$/g;e.__indexedPropRX=/(^\w+)\s*\[\s*['"]?\s*([^'"]+)\s*['",]?\s*\]/i;e.__valueDelimeter1=":";e.__valueDelimeter2="=";e.__keyValDelimeter=",";e.prototype._getPathParts=function(a){var l=[];(!a?[]:a.split(".")).forEach(function(a){var d;(d=a.match(e.__indexedPropRX))?(a=d[1],d=d[2],l.push(a),l.push("["+
d+"]")):l.push(a)});return l};e.prototype._resolveProp=function(f,e){return!e?f:g.str.startsWith(e,"[")?(e=this.trimQuotes(this.trimBrackets(e)),f instanceof a.MOD.collection.Dictionary?f.getItemByKey(e):f instanceof a.MOD.collection.Collection?f.getItemByPos(parseInt(e,10)):g.check.isArray(f)?f[parseInt(e,10)]:f[e]):f[e]};e.prototype._resolvePath=function(a,e){return!a?void 0:0===e.length?a:1===e.length?this._resolveProp(a,e[0]):this._resolvePath(this._resolveProp(a,e[0]),e.slice(1))};e.prototype._setPropertyValue=
function(a,e,b){g.str.startsWith(e,"[")?(e=this.trimQuotes(this.trimBrackets(e)),g.check.isArray(a)?a[parseInt(e,10)]=b:a[e]=b):a[e]=b};e.prototype._getKeyVals=function(a){var l,b,d,c=[],h={key:"",val:""},k=!0,q=e.__valueDelimeter1,z=e.__valueDelimeter2,p=e.__keyValDelimeter,t=function(a){a.val&&(g.check.isNumeric(a.val)?a.val=Number(a.val):g.check.isBoolString(a.val)&&(a.val=g.parseBool(a.val)));c.push(a)};for(l=0;l<a.length;l+=1){b=a.charAt(l);if("'"===b||'"'===b)d?d===b&&(d=null):d=b;!d&&"{"===
b&&!k?(b=a.substr(l),b=this.getBraceParts(b,!0)[0],h.val+=b,l+=b.length-1):!d&&b===p?h.key&&(t(h),h={key:"",val:""},k=!0):!d&&(b===q||b===z)?k=!1:k?h.key+=b:h.val+=b}h.key&&t(h);c.forEach(function(a){a.key=g.str.trim(a.key);g.check.isString(a.val)&&(a.val=g.str.trim(a.val));""===a.val&&g.str.startsWith(a.key,"this.")&&(a.val=a.key.substr(5),a.key="targetPath")});return c=c.filter(function(a){return""!==a.val})};e.prototype.resolveBindingSource=function(a,e){if(a){if(0===e.length)return a;if(0<e.length)return this.resolveBindingSource(this._resolveProp(a,
e[0]),e.slice(1));throw Error("Invalid operation");}};e.prototype.resolvePath=function(a,e){if(!e)return a;var b=this._getPathParts(e);return this._resolvePath(a,b)};e.prototype.getBraceParts=function(a,e){var b,d="",c,h,g=0,k=[];for(b=0;b<a.length;b+=1){c=a.charAt(b);if("'"===c||'"'===c)h?h===c&&(h=null):h=c;if(!h&&"{"===c)g+=1,d+=c;else if(!h&&"}"===c){if(g-=1,d+=c,0===g&&(k.push(d),d="",e))break}else 0<g&&(d+=c)}return k};e.prototype.trimOuterBraces=function(a){return g.str.trim(a.replace(e.__trimOuterBracesRX,
""))};e.prototype.trimQuotes=function(a){return g.str.trim(a.replace(e.__trimQuotsRX,""))};e.prototype.trimBrackets=function(a){return g.str.trim(a.replace(e.__trimBracketsRX,""))};e.prototype.isWithOuterBraces=function(a){return g.str.startsWith(a,"{")&&g.str.endsWith(a,"}")};e.prototype.parseOption=function(a){var e={},b=this;a=g.str.trim(a);b.isWithOuterBraces(a)&&(a=b.trimOuterBraces(a));b._getKeyVals(a).forEach(function(a){var c=g.check.isString(a.val);c&&b.isWithOuterBraces(a.val)?e[a.key]=
b.parseOption(a.val):e[a.key]=c?b.trimQuotes(a.val):a.val});return e};e.prototype.parseOptions=function(a){var e=[],b=this;a=g.str.trim(a);var d=[a];b.isWithOuterBraces(a)&&(d=b.getBraceParts(a,!1));d.forEach(function(a){e.push(b.parseOption(a))});return e};e.prototype.toString=function(){return"Parser"};return e}();k.Parser=q;a.global.onModuleLoaded("parser",k)})(r.parser||(r.parser={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=function(a){function e(b,d,c){a.call(this);this._action=b;this._thisObj=d;this._canExecute=c;this._objId="cmd"+g.getNewID()}__extends(e,a);e.prototype._getEventNames=function(){var b=a.prototype._getEventNames.call(this);return["canExecute_changed"].concat(b)};e.prototype.addOnCanExecuteChanged=function(a,d){this.addHandler("canExecute_changed",a,d)};e.prototype.removeOnCanExecuteChanged=function(a){this.removeHandler("canExecute_changed",
a)};e.prototype.canExecute=function(a,d){return!this._canExecute?!0:this._canExecute.apply(this._thisObj,[a,d])};e.prototype.execute=function(a,d){this._action&&this._action.apply(this._thisObj,[a,d])};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._canExecute=this._thisObj=this._action=null,a.prototype.destroy.call(this))};e.prototype.raiseCanExecuteChanged=function(){this.raiseEvent("canExecute_changed",{})};e.prototype.toString=function(){return"Command"};return e}(a.BaseObject);
k.Command=q;var e=function(e){function l(a){e.call(this);this._app=a;this._objId="vm"+g.getNewID()}__extends(l,e);l.prototype._onError=function(a,d){var c=e.prototype._onError.call(this,a,d);return!c?this._app._onError(a,d):c};l.prototype.toString=function(){return"BaseViewModel"};l.prototype.destroy=function(){this._app=null;e.prototype.destroy.call(this)};Object.defineProperty(l.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,
"$",{get:function(){return a.global.$},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return l}(a.BaseObject);k.BaseViewModel=e;a.global.registerType("Command",q);a.global.registerType("BaseViewModel",e);a.global.onModuleLoaded("mvvm",k)})(r.mvvm||(r.mvvm={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts,e=a.localizable.VALIDATE,f=function(a){function b(A,u,c){a.call(this,A,u,c)}__extends(b,a);return b}(a.MOD.mvvm.Command);k.PropChangedCommand=f;k.css={fieldError:"ria-field-error",errorTip:"ui-tooltip-red",commandLink:"ria-command-link"};f=function(n){function b(a,u,c){n.call(this);this._app=a;this._el=u;this._oldDisplay=this._$el=null;this._objId="elv"+g.getNewID();this._propChangedCommand=null;a._setElView(this._el,this);
this._errors=null;this._toolTip=c.tip;this._css=c.css;this._init(c);this._applyToolTip()}__extends(b,n);b.prototype._applyToolTip=function(){this._toolTip&&this._setToolTip(this.$el,this._toolTip)};b.prototype._init=function(a){this._css&&this.$el.addClass(this._css)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._$el,b=this._el;a&&a.off("."+this._objId);try{this._$el=this._el=this.toolTip=this.validationErrors=this._propChangedCommand=null}finally{this._app._setElView(b,
null),this._app=null}n.prototype.destroy.call(this)}};b.prototype.invokePropChanged=function(a){a={property:a};this._propChangedCommand&&this._propChangedCommand.execute(this,a)};b.prototype._getErrorTipInfo=function(a){var n=["<b>",e.errorInfo,"</b>","<br/>"];a.forEach(function(a){var b="";a.errors.forEach(function(a){b=b+" "+a});n.push(b);b=""});return n.join("")};b.prototype._setFieldError=function(a){var n=this.$el;a?n.addClass(k.css.fieldError):n.removeClass(k.css.fieldError)};b.prototype._updateErrorUI=
function(a,n){if(a){var b=this.$el;n&&0<n.length?(g.addToolTip(b,this._getErrorTipInfo(n),k.css.errorTip),this._setFieldError(!0)):(this._setToolTip(b,this.toolTip),this._setFieldError(!1))}};b.prototype._onError=function(b,u){var c=n.prototype._onError.call(this,b,u);return!c?a.global._onError(b,u):c};b.prototype._setToolTip=function(a,n,b){g.addToolTip(a,n,b)};b.prototype.toString=function(){return"BaseElView"};Object.defineProperty(b.prototype,"$el",{get:function(){this._el&&!this._$el&&(this._$el=
a.global.$(this._el));return this._$el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isVisible",{get:function(){return"none"!==this.el.style.display},set:function(a){a=!!a;a!==this.isVisible&&(a?this.el.style.display=this._oldDisplay?this._oldDisplay:"":(this._oldDisplay=
this.el.style.display,this.el.style.display="none"),this.raisePropertyChanged("isVisible"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"propChangedCommand",{get:function(){return this._propChangedCommand},set:function(a){a!==this._propChangedCommand&&(this._propChangedCommand=a,this.invokePropChanged("*"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"validationErrors",{get:function(){return this._errors},set:function(a){a!==this._errors&&(this._errors=
a,this.raisePropertyChanged("validationErrors"),this._updateErrorUI(this._el,this._errors))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataNameAttr",{get:function(){return this._el.getAttribute(q.DATA_ATTR.DATA_NAME)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"toolTip",{get:function(){return this._toolTip},set:function(a){this._toolTip!=a&&(this._toolTip=a,this._setToolTip(this.$el,a),this.raisePropertyChanged("toolTip"))},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"css",{get:function(){return this._css},set:function(a){var n=this.$el;this._css!=a&&(this._css&&n.removeClass(this._css),(this._css=a)&&n.addClass(this._css),this.raisePropertyChanged("css"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return b}(a.BaseObject);k.BaseElView=f;var l=function(a){function b(A,u,c){a.call(this,A,u,c)}__extends(b,a);Object.defineProperty(b.prototype,
"isEnabled",{get:function(){return!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){var a=this.el;return!a?"":a.value},set:function(a){if(this._el){var n=this.el,b=n.value;a=null===a?"":""+a;b!==a&&(n.value=a,this.raisePropertyChanged("value"))}},
enumerable:!0,configurable:!0});return b}(f);k.InputElView=l;var b=function(a){function b(A,u,c){a.call(this,A,u,c);this._commandParam=this._command=null;this.isEnabled||this.$el.addClass("disabled")}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._command&&this._command.removeNSHandlers(this._objId),this.commandParam=this.command=null,a.prototype.destroy.call(this))};b.prototype.invokeCommand=function(){var a=this,n=a.command,b=a.commandParam;n&&n.canExecute(a,
b)&&setTimeout(function(){n.canExecute(a,b)&&n.execute(a,b)},0)};b.prototype._onCommandChanged=function(){this.raisePropertyChanged("command")};b.prototype._setCommand=function(a){var n=this;a!==this._command&&(this._command&&this._command.removeNSHandlers(this._objId),(this._command=a)?(this._command.addOnCanExecuteChanged(function(a,b){n.isEnabled=a.canExecute(n,n.commandParam)},this._objId),n.isEnabled=this._command.canExecute(n,n.commandParam)):n.isEnabled=!1,this._onCommandChanged())};b.prototype.toString=
function(){return"CommandElView"};Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.$el.prop("disabled")},set:function(a){a!==this.isEnabled&&(this.$el.prop("disabled",!a),a?this.$el.removeClass("disabled"):this.$el.addClass("disabled"),this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"command",{get:function(){return this._command},set:function(a){this._setCommand(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"commandParam",{get:function(){return this._commandParam},set:function(a){a!==this._commandParam&&(this._commandParam=a,this.raisePropertyChanged("commandParam"))},enumerable:!0,configurable:!0});return b}(f);k.CommandElView=b;var d=function(a){function b(A,u,c){a.call(this,A,u,c)}__extends(b,a);return b}(a.MOD.mvvm.Command);k.TemplateCommand=d;d=function(a){function b(A,u,c){a.call(this,A,u,c);this._template=null;this._isEnabled=!0}__extends(b,a);b.prototype.templateLoaded=function(a){var n=this._commandParam;
this._template=a;this._template.isDisabled=!this._isEnabled;this._commandParam={template:a,isLoaded:!0};this.invokeCommand();this._commandParam=n;this.raisePropertyChanged("template")};b.prototype.templateUnloading=function(a){var n=this._commandParam;try{this._commandParam={template:a,isLoaded:!1},this.invokeCommand()}finally{this._commandParam=n,this._template=null}this.raisePropertyChanged("template")};b.prototype.toString=function(){return"TemplateElView"};Object.defineProperty(b.prototype,"isEnabled",
{get:function(){return this._isEnabled},set:function(a){this._isEnabled!==a&&(this._isEnabled=a,this._template&&(this._template.isDisabled=!this._isEnabled),this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});return b}(b);k.TemplateElView=d;var c=function(n){function b(a,c,u){n.call(this,a,c,u)}__extends(b,n);b.prototype._init=function(b){n.prototype._init.call(this,b);var c;c=b.img?b.img:q.LOADER_GIF.NORMAL;this._delay=400;this._timeOut=null;g.check.isNt(b.delay)||(this._delay=
parseInt(b.delay));this._loaderPath=a.global.getImagePath(c);this._$loader=a.global.$(new Image);this._$loader.css({position:"absolute",display:"none",zIndex:"10000"});this._$loader.prop("src",this._loaderPath);this._$loader.appendTo(this.el);this._isBusy=!1};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._timeOut&&(clearTimeout(this._timeOut),this._timeOut=null),this._$loader.remove(),this._$loader=null,n.prototype.destroy.call(this))};b.prototype.toString=function(){return"BusyElView"};
Object.defineProperty(b.prototype,"isBusy",{get:function(){return this._isBusy},set:function(n){var b=this,c=function(){b._timeOut=null;b._$loader.show();b._$loader.position({of:a.global.$(b.el)})};n!==b._isBusy&&(b._isBusy=n,b._isBusy?(b._timeOut&&(clearTimeout(b._timeOut),b._timeOut=null),0<b._delay?b._timeOut=setTimeout(c,b._delay):c()):b._timeOut?(clearTimeout(b._timeOut),b._timeOut=null):b._$loader.hide(),b.raisePropertyChanged("isBusy"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"delay",{get:function(){return this._delay},set:function(a){a!==this._delay&&(this._delay=a,this.raisePropertyChanged("delay"))},enumerable:!0,configurable:!0});return b}(f);k.BusyElView=c;var h=function(n){function b(a,c,u){n.call(this,a,c,u);this._template=this._dataContext=null}__extends(b,n);b.prototype._templateChanged=function(){this.raisePropertyChanged("templateID");this._template&&this.$el.empty().append(this._template.el)};b.prototype.updateTemplate=function(n){var b=this;try{if(!n&&this._template){this._template.destroy();
this._template=null;b._templateChanged();return}}catch(c){this._onError(c,this),a.global._throwDummy(c)}try{this._template?this._template.templateID=n:(this._template=new a.MOD.template.Template(this.app,n),this._template.dataContext=this._dataContext,this._template.addOnPropertyChange("templateID",function(a,n){b._templateChanged()},this._objId),b._templateChanged())}catch(u){this._onError(u,this),a.global._throwDummy(u)}};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._template&&(this._template.destroy(),this._template=null),this._dataContext=null,n.prototype.destroy.call(this))};Object.defineProperty(b.prototype,"templateID",{get:function(){return!this._template?null:this._template.templateID},set:function(a){this.updateTemplate(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataContext",{get:function(){return this._dataContext},
set:function(a){this._dataContext!==a&&(this._dataContext=a,this._template&&(this._template.dataContext=this._dataContext))},enumerable:!0,configurable:!0});return b}(f);k.DynaContentElView=h;var w=function(n){function b(){n.apply(this,arguments)}__extends(b,n);b.prototype._init=function(a){var b=this;n.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(a){a.stopPropagation();b.checked=this.checked})};b.prototype._setFieldError=function(n){var b=this.$el;
n?(n=a.global.$("<div></div>").addClass(k.css.fieldError),b.wrap(n)):0<b.parent("."+k.css.fieldError).length&&b.unwrap()};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.off("."+this._objId),n.prototype.destroy.call(this))};b.prototype.toString=function(){return"CheckBoxElView"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},set:function(a){var n=this.el;null!==a&&(a=!!a);a!==this._val&&(this._val=a,n&&(n.checked=!!this._val),null===
this._val?this.$el.css("opacity",0.33):this.$el.css("opacity",1),this.raisePropertyChanged("checked"))},enumerable:!0,configurable:!0});return b}(l);k.CheckBoxElView=w;var v=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(b){var c=this;a.prototype._init.call(this,b);var p=this.$el;p.on("change."+this._objId,function(a){a.stopPropagation();c.raisePropertyChanged("value")});p.on("keypress."+this._objId,function(a){a.stopPropagation();var n={keyCode:a.which,
value:a.target.value,isCancel:!1};c.raiseEvent("keypress",n);n.isCancel&&a.preventDefault()});if(b.updateOnKeyUp)p.on("keyup."+this._objId,function(a){a.stopPropagation();c.raisePropertyChanged("value")})};b.prototype._getEventNames=function(){var b=a.prototype._getEventNames.call(this);return["keypress"].concat(b)};b.prototype.addOnKeyPress=function(a,n){this.addHandler("keypress",a,n)};b.prototype.removeOnKeyPress=function(a){this.removeHandler("keypress",a)};b.prototype.toString=function(){return"TextBoxElView"};
Object.defineProperty(b.prototype,"color",{get:function(){return this.$el.css("color")},set:function(a){var n=this.$el,b=n.css("color");a!==b&&(n.css("color",a),this.raisePropertyChanged("color"))},enumerable:!0,configurable:!0});return b}(l);k.TextBoxElView=v;var z=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"EditableElView"};return b}(l);k.HiddenElView=z;var p=function(a){function b(c,p,u){a.call(this,c,p,u)}__extends(b,a);b.prototype._init=
function(b){a.prototype._init.call(this,b);var c=this;b.rows&&(this.rows=b.rows);b.cols&&(this.cols=b.cols);b.wrap&&(this.wrap=b.wrap);var p=this.$el;p.on("change."+this._objId,function(a){a.stopPropagation();c.raisePropertyChanged("value")});p.on("keypress."+this._objId,function(a){a.stopPropagation();var n={keyCode:a.which,value:a.target.value,isCancel:!1};c.raiseEvent("keypress",n);n.isCancel&&a.preventDefault()});if(b.updateOnKeyUp)p.on("keyup."+this._objId,function(a){a.stopPropagation();c.raisePropertyChanged("value")})};
b.prototype._getEventNames=function(){var b=a.prototype._getEventNames.call(this);return["keypress"].concat(b)};b.prototype.addOnKeyPress=function(a,n){this.addHandler("keypress",a,n)};b.prototype.removeOnKeyPress=function(a){this.removeHandler("keypress",a)};b.prototype.toString=function(){return"TextAreaElView"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){var a=this.el;return!a?
"":a.value},set:function(a){if(this._el){var n=this.el,b=n.value;a=null===a?"":""+a;b!==a&&(n.value=a,this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rows",{get:function(){var a=this.el;return!a?1:a.rows},set:function(a){var n=
this.el;if(n){var b=n.rows;a=!a?1:a;b!==a&&(n.rows=a,this.raisePropertyChanged("rows"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"cols",{get:function(){var a=this.el;return!a?1:a.cols},set:function(a){var n=this.el;if(n){var b=n.cols;a=!a?1:a;b!==a&&(n.cols=a,this.raisePropertyChanged("cols"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"wrap",{get:function(){var a=this.el;return!a?"off":a.wrap},set:function(a){var n=this.el;if(n){var b=n.wrap;a=
!a?"off":a;0>["hard","off","soft"].indexOf(a)&&(a="off");b!==a&&(n.wrap=a,this.raisePropertyChanged("wrap"))}},enumerable:!0,configurable:!0});return b}(f);k.TextAreaElView=p;var t=function(n){function b(){n.apply(this,arguments)}__extends(b,n);b.prototype._init=function(a){var b=this;n.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(a){a.stopPropagation();b.checked=this.checked;b._updateGroup()})};b.prototype._updateGroup=function(){var n=this.el.getAttribute("name"),
b=this;if(n){var c=this.el.parentElement;if(c){var b=this,p=b.el;a.global.$('input[type="radio"][name="'+n+'"]',c).each(function(a,n){if(p!==this){var c=b.app._getElView(this);c&&(c.checked=this.checked)}})}}};b.prototype._setFieldError=function(n){var b=this.$el;n?(n=a.global.$("<div></div>").addClass(k.css.fieldError),b.wrap(n)):0<b.parent("."+k.css.fieldError).length&&b.unwrap()};b.prototype.toString=function(){return"RadioElView"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},
set:function(a){var n=this.el;null!==a&&(a=!!a);a!==this._val&&(this._val=a,n&&(n.checked=!!this._val),null===this._val?this.$el.css("opacity",0.33):this.$el.css("opacity",1),this.raisePropertyChanged("checked"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this.el.value},set:function(a){var n=this.el;if(n){var b=""+a;null===a&&(b="");b!==n.value&&(n.value=b,this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"name",{get:function(){return this.el.name},enumerable:!0,configurable:!0});return b}(l);k.RadioElView=t;var B=function(a){function b(c,p,u){this._preventDefault=!1;a.call(this,c,p,u)}__extends(b,a);b.prototype._init=function(b){a.prototype._init.call(this,b);var c=this,p=this.$el;b.preventDefault&&(this._preventDefault=!0);p.on("click."+this._objId,function(a){c._onClick(a)})};b.prototype._onClick=function(a){this._preventDefault&&a.preventDefault();this.invokeCommand()};b.prototype.toString=function(){return"ButtonElView"};
Object.defineProperty(b.prototype,"value",{get:function(){return!this._el?"":this.$el.val()},set:function(a){if(this._el){var n=this.$el.val();a=null===a?"":""+a;n!==a&&(this.$el.val(a),this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"text",{get:function(){return!this._el?"":this.$el.text()},set:function(a){if(this._el){var n=this.$el.text();a=null===a?"":""+a;n!==a&&(this.$el.text(a),this.raisePropertyChanged("text"))}},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"html",{get:function(){return!this._el?"":this.$el.html()},set:function(a){if(this._el){var n=this.$el.html();a=null===a?"":""+a;n!==a&&(this.$el.html(a),this.raisePropertyChanged("html"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"preventDefault",{get:function(){return this._preventDefault},set:function(a){this._preventDefault!==a&&(this._preventDefault=a,this.raisePropertyChanged("preventDefault"))},enumerable:!0,configurable:!0});return b}(b);
k.ButtonElView=B;var C=function(n){function b(a,c,p){this._image=this._imageSrc=null;this._preventDefault=!1;n.call(this,a,c,p)}__extends(b,n);b.prototype._init=function(a){n.prototype._init.call(this,a);var b=this,c=this.$el;a.imageSrc&&(this.imageSrc=a.imageSrc);a.preventDefault&&(this._preventDefault=!0);c.addClass(k.css.commandLink);c.on("click."+this._objId,function(a){b._onClick(a)})};b.prototype._onClick=function(a){this._preventDefault&&a.preventDefault();this.invokeCommand()};b.prototype._updateImage=
function(n){var b=this.$el,c=this;this._imageSrc!==n&&(this._imageSrc=n,this._image&&!n&&(a.global.$(this._image).remove(),this._image=null),n&&(this._image?this._image.src=n:(c.html=null,n=a.global.$(new Image).attr("src",n).mouseenter(function(n){c.isEnabled&&a.global.$(this).css("opacity",0.5)}).mouseout(function(n){c.isEnabled&&a.global.$(this).css("opacity",1)}).appendTo(b),this._image=n.get(0))))};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.removeClass(k.css.commandLink),
this.imageSrc=null,n.prototype.destroy.call(this))};b.prototype.toString=function(){return"AncorButtonElView"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"imageSrc",{get:function(){return this._imageSrc},set:function(a){this._$el&&this._imageSrc!==a&&(this._updateImage(a),this.raisePropertyChanged("imageSrc"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"html",{get:function(){return!this._el?
"":this.$el.html()},set:function(a){if(this._el){var n=this.$el.html();a=null===a?"":""+a;n!==a&&(this.$el.html(a),this.raisePropertyChanged("html"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"text",{get:function(){return!this._el?"":this.$el.text()},set:function(a){if(this._el){var n=this.$el.text();a=null===a?"":""+a;n!==a&&(this.$el.text(a),this.raisePropertyChanged("text"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"href",{get:function(){return!this._el?
"":this.el.href},set:function(a){if(this._el){var n=this.href;a=null===a?"":""+a;n!==a&&(this.el.href=a,this.raisePropertyChanged("href"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"preventDefault",{get:function(){return this._preventDefault},set:function(a){this._preventDefault!==a&&(this._preventDefault=a,this.raisePropertyChanged("preventDefault"))},enumerable:!0,configurable:!0});return b}(b);k.AnchorElView=C;var D=function(n){function b(){n.apply(this,arguments)}__extends(b,
n);b.prototype._init=function(b){this._expandedsrc=b.expandedsrc||a.global.getImagePath("collapse.jpg");this._collapsedsrc=b.collapsedsrc||a.global.getImagePath("expand.jpg");this._isExpanded=!!b.isExpanded;n.prototype._init.call(this,{imageSrc:this._isExpanded?this._expandedsrc:this._collapsedsrc})};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._collapsedsrc=this._expandedsrc=null,this._isExpanded=!1,n.prototype.destroy.call(this))};b.prototype._onCommandChanged=
function(){n.prototype._onCommandChanged.call(this);this.invokeCommand()};b.prototype._onClick=function(a){this._isExpanded=!this._isExpanded;n.prototype._onClick.call(this,a)};b.prototype.invokeCommand=function(){this.imageSrc=this._isExpanded?this._expandedsrc:this._collapsedsrc;n.prototype.invokeCommand.call(this)};b.prototype.toString=function(){return"ExpanderElView"};Object.defineProperty(b.prototype,"isExpanded",{get:function(){return this._isExpanded},set:function(a){this._isExpanded!==a&&
(this._isExpanded=a,this.invokeCommand(),this.raisePropertyChanged("isExpanded"))},enumerable:!0,configurable:!0});return b}(C);k.ExpanderElView=D;var y=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"SpanElView"};Object.defineProperty(b.prototype,"text",{get:function(){return this.$el.text()},set:function(a){var n=this.$el,b=n.text();a=null===a?"":""+a;b!==a&&(n.text(a),this.raisePropertyChanged("text"),this.raisePropertyChanged("value"))},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this.text},set:function(a){this.text=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"html",{get:function(){return this.el.innerHTML},set:function(a){var n=this.el.innerHTML;a=null===a?"":""+a;n!==a&&(this.el.innerHTML=a,this.raisePropertyChanged("html"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"color",{get:function(){return this.$el.css("color")},set:function(a){var n=
this.$el,b=n.css("color");a!==b&&(n.css("color",a),this.raisePropertyChanged("color"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fontSize",{get:function(){return this.$el.css("font-size")},set:function(a){var n=this.$el,b=n.css("font-size");a!==b&&(n.css("font-size",a),this.raisePropertyChanged("fontSize"))},enumerable:!0,configurable:!0});return b}(f);k.SpanElView=y;var m=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.toString=function(){return"DivElView"};
Object.defineProperty(b.prototype,"borderColor",{get:function(){return this.$el.css("border-top-color")},set:function(a){var n=this.$el.css("border-top-color");a!==n&&(this.el.style.borderColor=a,this.raisePropertyChanged("borderColor"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"borderStyle",{get:function(){return this.$el.css("border-top-style")},set:function(a){var n=this.$el,b=n.css("border-top-style");a!==b&&(n.css("border-style",a),this.raisePropertyChanged("borderStyle"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"width",{get:function(){return this.$el.width()},set:function(a){var n=this.$el,b=n.width();a!==b&&(n.width(a),this.raisePropertyChanged("width"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this.$el.height()},set:function(a){var n=this.$el,b=n.height();a!==b&&(n.height(a),this.raisePropertyChanged("height"))},enumerable:!0,configurable:!0});return b}(y);k.BlockElView=m;var x=function(a){function b(c,
p,d){a.call(this,c,p,d)}__extends(b,a);b.prototype.toString=function(){return"ImgElView"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"src",{get:function(){return this.el.src},set:function(a){this.el.src!==a&&(this.el.src=a,this.raisePropertyChanged("src"))},enumerable:!0,configurable:!0});return b}(f);k.ImgElView=x;var s=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(b){a.prototype._init.call(this,
b);this._tabsEventCommand=null;this._tabOpts=b;this._createTabs()};b.prototype._createTabs=function(){var a=this.$el,b=this,n={select:function(a,n){b.invokeTabsEvent("select",n)},show:function(a,n){b.invokeTabsEvent("show",n)},disable:function(a,n){b.invokeTabsEvent("disable",n)},enable:function(a,n){b.invokeTabsEvent("enable",n)},add:function(a,n){b.invokeTabsEvent("add",n)},remove:function(a,n){b.invokeTabsEvent("remove",n)},load:function(a,n){b.invokeTabsEvent("load",n)}},n=g.extend(!1,n,b._tabOpts);
a.tabs(n)};b.prototype._destroyTabs=function(){g.destroyJQueryPlugin(this.$el,"tabs")};b.prototype.invokeTabsEvent=function(a,n){var b={eventName:a,args:n};this._tabsEventCommand&&this._tabsEventCommand.execute(this,b)};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._tabsEventCommand=null,this._destroyTabs(),a.prototype.destroy.call(this))};b.prototype.toString=function(){return"TabsElView"};Object.defineProperty(b.prototype,"tabsEventCommand",{get:function(){return this._tabsEventCommand},
set:function(a){var n=this._tabsEventCommand;a!==n&&(n&&this._destroyTabs(),(this._tabsEventCommand=a)&&this._createTabs())},enumerable:!0,configurable:!0});return b}(f);k.TabsElView=s;a.global.registerType("BaseElView",f);a.global.registerType("InputElView",l);a.global.registerType("CommandElView",b);a.global.registerType("TemplateElView",d);a.global.registerElView("template",d);a.global.registerType("BusyElView",c);a.global.registerElView("busy_indicator",c);a.global.registerType("DynaContentElView",
h);a.global.registerElView(a.global.consts.ELVIEW_NM.DYNACONT,h);a.global.registerType("CheckBoxElView",w);a.global.registerElView("input:checkbox",w);a.global.registerType("TextBoxElView",v);a.global.registerElView("input:text",v);a.global.registerType("HiddenElView",z);a.global.registerElView("input:hidden",z);a.global.registerType("TextAreaElView",p);a.global.registerElView("textarea",p);a.global.registerType("RadioElView",t);a.global.registerElView("input:radio",t);a.global.registerType("ButtonElView",
B);a.global.registerElView("input:button",B);a.global.registerElView("input:submit",B);a.global.registerElView("button",B);a.global.registerType("AnchorElView",C);a.global.registerElView("a",C);a.global.registerElView("abutton",C);a.global.registerType("ExpanderElView",D);a.global.registerElView("expander",D);a.global.registerType("SpanElView",y);a.global.registerElView("span",y);a.global.registerType("BlockElView",m);a.global.registerElView("div",m);a.global.registerElView("section",m);a.global.registerElView("block",
m);a.global.registerType("ImgElView",x);a.global.registerElView("img",x);a.global.registerType("TabsElView",s);a.global.registerElView("tabs",s);a.global.onModuleLoaded("baseElView",k)})(r.baseElView||(r.baseElView={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils;k.BINDING_MODE=["OneTime","OneWay","TwoWay"];k._checkIsErrorNotification=function(a){if(!a||!g.check.isFunction(a.getIErrorNotification))return!1;a=a.getIErrorNotification();return!!a&&g.check.isFunction(a.getIErrorNotification)};var q=function(e){function g(b,d){var c=a.ERRS.ERR_VALIDATION+"\r\n",h=0;b.forEach(function(b){0<h&&(c+="\r\n");c=b.fieldName?c+" "+a.localizable.TEXT.txtField+": "+b.fieldName+" -> "+b.errors.join(", "):c+b.errors.join(", ");
h+=1});e.call(this,c);this._errors=b;this._item=d}__extends(g,e);Object.defineProperty(g.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"errors",{get:function(){return this._errors},enumerable:!0,configurable:!0});return g}(a.MOD.errors.BaseError);k.ValidationError=q;var e=function(e){function l(b){e.call(this);b=g.extend(!1,{target:null,source:null,targetPath:null,sourcePath:null,mode:k.BINDING_MODE[1],converter:null,converterParam:null,
isSourceFixed:!1},b);if(!b.target)throw Error(a.ERRS.ERR_BIND_TARGET_EMPTY);if(!g.check.isString(b.targetPath))throw Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,b.targetPath));if(0>k.BINDING_MODE.indexOf(b.mode))throw Error(g.format(a.ERRS.ERR_BIND_MODE_INVALID,b.mode));if(!g.check.isBaseObj(b.target))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);this._state=null;this._mode=b.mode;this._converter=b.converter||a.global._getConverter("BaseConverter");this._converterParam=b.converterParam;this._srcPath=
a.global.parser._getPathParts(b.sourcePath);this._tgtPath=a.global.parser._getPathParts(b.targetPath);if(1>this._tgtPath.length)throw Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,b.targetPath));this._isSourceFixed=!!b.isSourceFixed;this._bounds={};this._objId="bnd"+g.getNewID();this._ignoreTgtChange=this._ignoreSrcChange=!1;this._target=this._source=this._targetObj=this._sourceObj=null;this.target=b.target;this.source=b.source;this._sourceObj&&g.check.isFunction(this._sourceObj.getIErrorNotification)&&
this._sourceObj.getIsHasErrors()&&this._onSrcErrorsChanged()}__extends(l,e);l.create=function(a){return new l(a)};l.prototype._getOnTgtDestroyedProxy=function(){var a=this;return function(d,c){a._onTgtDestroyed(d,c)}};l.prototype._getOnSrcDestroyedProxy=function(){var a=this;return function(d,c){a._onSrcDestroyed(d,c)}};l.prototype._getUpdTgtProxy=function(){var a=this;return function(){a._updateTarget()}};l.prototype._getUpdSrcProxy=function(){var a=this;return function(){a._updateSource()}};l.prototype._getSrcErrChangedProxy=
function(){var a=this;return function(d,c){a._onSrcErrorsChanged()}};l.prototype._onSrcErrorsChanged=function(){var a=[],d=this._targetObj,c=this._sourceObj,e=this._srcPath;d&&g.check.isElView(d)&&(c&&0<e.length&&(a=c.getFieldErrors(e[e.length-1])),d.validationErrors=a)};l.prototype._onError=function(b,d){var c=e.prototype._onError.call(this,b,d);return!c?a.global._onError(b,d):c};l.prototype._getTgtChangedFn=function(b,d,c,e,f){return function(g,l){var p=a.global.parser._resolveProp(d,c);0<e.length&&
b._checkBounded(null,"target",f,e);b._parseTgtPath(p,e,f)}};l.prototype._getSrcChangedFn=function(b,d,c,e,f){return function(g,l){var p=a.global.parser._resolveProp(d,c);0<e.length&&b._checkBounded(null,"source",f,e);b._parseSrcPath(p,e,f)}};l.prototype._parseSrcPath=function(a,d,c){this._sourceObj=null;0===d.length?this._sourceObj=a:this._parseSrcPath2(a,d,c);this._targetObj&&this._updateTarget()};l.prototype._parseSrcPath2=function(b,d,c){var e=!!b&&g.check.isBaseObj(b);e&&(b.addOnDestroyed(this._getOnSrcDestroyedProxy(),
this._objId),this._checkBounded(b,"source",c,d));1<d.length?(e&&b.addOnPropertyChange(d[0],this._getSrcChangedFn(this,b,d[0],d.slice(1),c+1),this._objId),b&&(b=a.global.parser._resolveProp(b,d[0]))&&this._parseSrcPath2(b,d.slice(1),c+1)):b&&1===d.length&&((this._mode===k.BINDING_MODE[1]||this._mode===k.BINDING_MODE[2])&&e&&b.addOnPropertyChange(d[0],this._getUpdTgtProxy(),this._objId),b&&g.check.isFunction(b.getIErrorNotification)&&b.addOnErrorsChanged(this._getSrcErrChangedProxy(),this._objId),this._sourceObj=
b)};l.prototype._parseTgtPath=function(a,d,c){this._targetObj=null;0===d.length?this._targetObj=a:this._parseTgtPath2(a,d,c);this._targetObj&&this._updateTarget()};l.prototype._parseTgtPath2=function(b,d,c){var e=!!b&&g.check.isBaseObj(b);e&&(b.addOnDestroyed(this._getOnTgtDestroyedProxy(),this._objId),this._checkBounded(b,"target",c,d));1<d.length?(e&&b.addOnPropertyChange(d[0],this._getTgtChangedFn(this,b,d[0],d.slice(1),c+1),this._objId),b&&(b=a.global.parser._resolveProp(b,d[0]))&&this._parseTgtPath2(b,
d.slice(1),c+1)):b&&1===d.length&&(this._mode===k.BINDING_MODE[2]&&e&&b.addOnPropertyChange(d[0],this._getUpdSrcProxy(),this._objId),this._targetObj=b)};l.prototype._checkBounded=function(b,d,c,e){var f,l;if("source"===d)l="s"+c;else if("target"===d)l="t"+c;else throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,"to",d));if(f=this._bounds[l])f.removeNSHandlers(this._objId),delete this._bounds[l];0<e.length&&this._checkBounded(null,d,c+1,e.slice(1));b&&(this._bounds[l]=b)};l.prototype._onTgtDestroyed=function(a,
d){this._isDestroyCalled||(this.target=null)};l.prototype._onSrcDestroyed=function(a,d){var c=this;c._isDestroyCalled||(a===c.source?c.source=null:(c._checkBounded(null,"source",0,c._srcPath),setTimeout(function(){c._isDestroyCalled||c._bindToSource()},0)))};l.prototype._bindToSource=function(){this._parseSrcPath(this.source,this._srcPath,0)};l.prototype._bindToTarget=function(){this._parseTgtPath(this.target,this._tgtPath,0)};l.prototype._updateTarget=function(){if(!this._ignoreSrcChange){this._ignoreTgtChange=
!0;try{var b=this._converter.convertToTarget(this.sourceValue,this._converterParam,this._sourceObj);void 0!==b&&(this.targetValue=b)}catch(d){a.global.reThrow(d,this._onError(d,this))}finally{this._ignoreTgtChange=!1}}};l.prototype._updateSource=function(){if(!this._ignoreTgtChange){this._ignoreSrcChange=!0;try{var a=this._converter.convertToSource(this.targetValue,this._converterParam,this._sourceObj);void 0!==a&&(this.sourceValue=a)}catch(d){if(!(d instanceof q)||!g.check.isElView(this._targetObj))if(this._updateTarget(),
!this._onError(d,this))throw d;}finally{this._ignoreSrcChange=!1}}};l.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this;g.forEachProp(this._bounds,function(d){a._bounds[d].removeNSHandlers(a._objId)});this._bounds={};this._target=this._source=this._targetObj=this._sourceObj=this._tgtPath=this._srcPath=this._converterParam=this._converter=this._state=this.target=this.source=null;e.prototype.destroy.call(this)}};l.prototype.toString=function(){return"Binding"};
Object.defineProperty(l.prototype,"bindingID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"target",{get:function(){return this._target},set:function(b){if(this._state)this._state.target=b;else if(this._target!==b){var d=this._targetObj;if(d&&!d._isDestroyCalled){this._ignoreTgtChange=!0;try{this.targetValue=null}finally{this._ignoreTgtChange=!1}}this._checkBounded(null,"target",0,this._tgtPath);if(b&&!g.check.isBaseObj(b))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);
this._target=b;this._bindToTarget();if(this._target&&!this._targetObj)throw Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,this._tgtPath.join(".")));}},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"source",{get:function(){return this._source},set:function(a){this._state?this._state.source=a:this._source!==a&&(this._checkBounded(null,"source",0,this._srcPath),this._source=a,this._bindToSource())},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"targetPath",{get:function(){return this._tgtPath},
enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"sourcePath",{get:function(){return this._srcPath},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"sourceValue",{get:function(){return 0===this._srcPath.length?this._sourceObj:null===this._sourceObj?null:a.global.parser._resolveProp(this._sourceObj,this._srcPath[this._srcPath.length-1])},set:function(b){0===this._srcPath.length||null===this._sourceObj||a.global.parser._setPropertyValue(this._sourceObj,this._srcPath[this._srcPath.length-
1],b)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"targetValue",{get:function(){return null===this._targetObj?null:a.global.parser._resolveProp(this._targetObj,this._tgtPath[this._tgtPath.length-1])},set:function(b){null!==this._targetObj&&a.global.parser._setPropertyValue(this._targetObj,this._tgtPath[this._tgtPath.length-1],b)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,
"converter",{get:function(){return this._converter},set:function(a){this._converter=a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"converterParam",{get:function(){return this._converterParam},set:function(a){this._converterParam=a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"isSourceFixed",{get:function(){return this._isSourceFixed},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"isDisabled",{get:function(){return!!this._state},set:function(a){a=
!!a;if(this.isDisabled!=a)if(a){a={source:this._source,target:this._target};try{this.source=this.target=null}finally{this._state=a}}else a=this._state,this._state=null,this.target=a.target,this.source=a.source},enumerable:!0,configurable:!0});return l}(a.BaseObject);k.Binding=e;a.global.registerType("ValidationError",q);a.global.registerType("Binding",e);a.global.onModuleLoaded("binding",k)})(r.binding||(r.binding={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=r.binding.ValidationError;k.consts={DATA_TYPE:a.MOD.consts.DATA_TYPE,DATE_CONVERSION:a.MOD.consts.DATE_CONVERSION,SORT_ORDER:{ASC:0,DESC:1},COLL_CHANGE_TYPE:{REMOVE:"0",ADDED:"1",RESET:"2",REMAP_KEY:"3"}};var e=k.consts.DATA_TYPE,f=k.consts.COLL_CHANGE_TYPE,l=a.MOD.utils.valueUtils,b=function(b){function c(){b.call(this);this._fkey=null;this._isEditing=!1;this._saveVals=null;this._vals={};this._notEdited=!0}__extends(c,b);c.prototype._getEventNames=
function(){var a=b.prototype._getEventNames.call(this);return["errors_changed"].concat(a)};c.prototype.addOnErrorsChanged=function(a,b){this.addHandler("errors_changed",a,b)};c.prototype.removeOnErrorsChanged=function(a){this.removeHandler("errors_changed",a)};c.prototype._onErrorsChanged=function(a){this.raiseEvent("errors_changed",a)};c.prototype._onError=function(a,c){var d=b.prototype._onError.call(this,a,c);return!d?this._collection._onError(a,c):d};c.prototype._beginEdit=function(){var b=this._collection;
if(b.isEditing){var c=b._EditingItem;if(c===this)return!1;try{c.endEdit(),c.getIsHasErrors()&&(this._onError(new q(c.getAllErrors(),c),c),c.cancelEdit())}catch(d){b=this._onError(d,c),c.cancelEdit(),a.global.reThrow(d,b)}}this._isEditing=!0;this._saveVals=g.shallowCopy(this._vals);this._collection.currentItem=this;return!0};c.prototype._endEdit=function(){if(!this._isEditing)return!1;var a,b=this._collection;if(this.getIsHasErrors())return!1;b._removeAllErrors(this);a=this._validateAll();0<a.length&&
b._addErrors(this,a);if(this.getIsHasErrors())return!1;this._isEditing=!1;this._saveVals=null;return!0};c.prototype._validate=function(){return this._collection._validateItem(this)};c.prototype._skipValidate=function(a,b){return!1};c.prototype._validateField=function(b){var c,d=this.getFieldInfo(b),e=null;try{c=this._vals[b];if(this._skipValidate(d,c))return e;if(this._isNew){if(null===c&&!d.isNullable&&!d.isReadOnly&&!d.isAutoGenerated)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}else if(null===
c&&!d.isNullable&&!d.isReadOnly)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}catch(h){e={fieldName:b,errors:[h.message]}}b=this._collection._validateItemField(this,b);e&&b?e.errors=e.errors.concat(b.errors):b&&(e=b);return e};c.prototype._validateAll=function(){var a=this,b=[];this.getFieldNames().forEach(function(c){(c=a._validateField(c))&&b.push(c)});var c=a._validate();c&&b.push(c);return b};c.prototype._checkVal=function(b,c){var d=c,h=a.ERRS;if(this._skipValidate(b,c))return d;if(b.isReadOnly&&
(!b.allowClientDefault||!this._isNew))throw Error(h.ERR_FIELD_READONLY);if((null===c||g.check.isString(c)&&!c)&&!b.isNullable)throw Error(h.ERR_FIELD_ISNOT_NULLABLE);if(null===c)return c;switch(b.dataType){case e.None:break;case e.Guid:case e.Binary:case e.String:if(!g.check.isString(c))throw Error(g.format(h.ERR_FIELD_WRONG_TYPE,c,"String"));if(0<b.maxLength&&c.length>b.maxLength)throw Error(g.format(h.ERR_FIELD_MAXLEN,b.maxLength));b.isNullable&&""===c&&(d=null);if(b.regex&&!RegExp(b.regex,"i").test(c))throw Error(g.format(h.ERR_FIELD_REGEX,
c));break;case e.Bool:if(!g.check.isBoolean(c))throw Error(g.format(h.ERR_FIELD_WRONG_TYPE,c,"Boolean"));break;case e.Integer:case e.Decimal:case e.Float:if(!g.check.isNumber(c))throw Error(g.format(h.ERR_FIELD_WRONG_TYPE,c,"Number"));b.range&&g.validation.checkNumRange(Number(c),b.range);break;case e.DateTime:case e.Date:if(!g.check.isDate(c))throw Error(g.format(h.ERR_FIELD_WRONG_TYPE,c,"Date"));b.range&&g.validation.checkDateRange(c,b.range);break;case e.Time:if(!g.check.isDate(c))throw Error(g.format(h.ERR_FIELD_WRONG_TYPE,
c,"Time"));break;default:throw Error(g.format(h.ERR_PARAM_INVALID,"dataType",b.dataType));}return d};c.prototype._resetIsNew=function(){};c.prototype._onAttaching=function(){};c.prototype._onAttach=function(){};c.prototype.getFieldInfo=function(a){return this._collection.getFieldInfo(a)};c.prototype.getFieldNames=function(){return this._collection.getFieldNames()};c.prototype.getFieldErrors=function(a){var b=this._collection._getErrors(this);if(!b)return[];var c=a;a||(a="*");if(!b[a])return[];"*"==
a&&(c=null);return[{fieldName:c,errors:b[a]}]};c.prototype.getAllErrors=function(){var a=this._collection._getErrors(this);if(!a)return[];var b=[];g.forEachProp(a,function(c){var d=null;"*"!==c&&(d=c);b.push({fieldName:d,errors:a[c]})});return b};c.prototype.getErrorString=function(){var a=this._collection._getErrors(this);if(!a)return"";var b=[];g.forEachProp(a,function(c){b.push(g.format("{0}: {1}",c,a[c]))});return b.join("|")};c.prototype.submitChanges=function(){var a=g.createDeferred();a.reject();
return a.promise()};c.prototype.beginEdit=function(){var a=this._collection;if(!this._beginEdit())return!1;a._onEditing(this,!0,!1);this.raisePropertyChanged("isEditing");return!0};c.prototype.endEdit=function(){var a=this._collection;if(!this._endEdit())return!1;a._onEditing(this,!1,!1);this._notEdited=!1;this.raisePropertyChanged("isEditing");return!0};c.prototype.cancelEdit=function(){if(!this._isEditing)return!1;var a=this._collection,b=this._isNew,c=this._saveVals;this._vals=this._saveVals;this._saveVals=
null;a._removeAllErrors(this);a.getFieldNames().forEach(function(a){c[a]!==this._vals[a]&&this.raisePropertyChanged(a)},this);b&&this._notEdited&&a.removeItem(this);this._isEditing=!1;a._onEditing(this,!1,!0);this.raisePropertyChanged("isEditing");return!0};c.prototype.deleteItem=function(){var a=this._collection;if(null===this._key||!a._onItemDeleting(this))return!1;a.removeItem(this);return!0};c.prototype.getIsNew=function(){return this._isNew};c.prototype.getIsDeleted=function(){return this._isDeleted};
c.prototype.getKey=function(){return this._key};c.prototype.getCollection=function(){return this._collection};c.prototype.getIsEditing=function(){return this._isEditing};c.prototype.getIsHasErrors=function(){return!!this._collection._getErrors(this)};c.prototype.getIErrorNotification=function(){return this};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._saveVals=this._fkey=null,this._vals={},this._isEditing=!1,b.prototype.destroy.call(this))};c.prototype.toString=
function(){return"CollectionItem"};Object.defineProperty(c.prototype,"_isCanSubmit",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_changeType",{get:function(){return 0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isNew",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isDeleted",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_key",{get:function(){return this._fkey},
set:function(a){null!==a&&(a=""+a);this._fkey=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_collection",{get:function(){return null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isUpdating",{get:function(){var a=this._collection;return!a?!1:a.isUpdating},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return this._isEditing},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.CollectionItem=b;var d=
function(c){function d(){c.call(this);this._options={enablePaging:!1,pageSize:50};this._isLoading=!1;this._EditingItem=null;this._perms={canAddRow:!0,canEditRow:!0,canDeleteRow:!0,canRefreshRow:!1};this._pageIndex=this._totalCount=0;this._items=[];this._itemsByKey={};this._currentPos=-1;this._newKey=0;this._fieldMap={};this._errors={};this._ignoreChangeErrors=!1;this._pkInfo=null;this._isUpdating=!1;this._waitQueue=new a.MOD.utils.WaitQueue(this)}__extends(d,c);d.getEmptyFieldInfo=function(a){return{isPrimaryKey:0,
isRowTimeStamp:!1,dataType:e.None,isNullable:!0,maxLength:-1,isReadOnly:!1,isAutoGenerated:!1,allowClientDefault:!1,dateConversion:k.consts.DATE_CONVERSION.None,isClientOnly:!0,isCalculated:!1,isNeedOriginal:!1,dependentOn:null,range:null,regex:null,isNavigation:!1,fieldName:a}};d.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return"begin_edit end_edit fill coll_changed item_deleting item_adding item_added validate current_changing page_changing errors_changed status_changed clearing cleared commit_changes".split(" ").concat(a)};
d.prototype.addOnClearing=function(a,b){this.addHandler("clearing",a,b)};d.prototype.removeOnClearing=function(a){this.removeHandler("clearing",a)};d.prototype.addOnCleared=function(a,b){this.addHandler("cleared",a,b)};d.prototype.removeOnCleared=function(a){this.removeHandler("cleared",a)};d.prototype.addOnFill=function(a,b){this.addHandler("fill",a,b)};d.prototype.removeOnFill=function(a){this.removeHandler("fill",a)};d.prototype.addOnCollChanged=function(a,b){this.addHandler("coll_changed",a,b)};
d.prototype.removeOnCollChanged=function(a){this.removeHandler("coll_changed",a)};d.prototype.addOnValidate=function(a,b){this.addHandler("validate",a,b)};d.prototype.removeOnValidate=function(a){this.removeHandler("validate",a)};d.prototype.addOnItemDeleting=function(a,b){this.addHandler("item_deleting",a,b)};d.prototype.removeOnItemDeleting=function(a){this.removeHandler("item_deleting",a)};d.prototype.addOnItemAdding=function(a,b){this.addHandler("item_adding",a,b)};d.prototype.removeOnItemAdding=
function(a){this.removeHandler("item_adding",a)};d.prototype.addOnItemAdded=function(a,b){this.addHandler("item_added",a,b)};d.prototype.removeOnItemAdded=function(a){this.removeHandler("item_added",a)};d.prototype.addOnCurrentChanging=function(a,b){this.addHandler("current_changing",a,b)};d.prototype.removeOnCurrentChanging=function(a){this.removeHandler("current_changing",a)};d.prototype.addOnPageChanging=function(a,b){this.addHandler("page_changing",a,b)};d.prototype.removeOnPageChanging=function(a){this.removeHandler("page_changing",
a)};d.prototype.addOnErrorsChanged=function(a,b){this.addHandler("errors_changed",a,b)};d.prototype.removeOnErrorsChanged=function(a){this.removeHandler("errors_changed",a)};d.prototype.addOnBeginEdit=function(a,b){this.addHandler("begin_edit",a,b)};d.prototype.removeOnBeginEdit=function(a){this.removeHandler("begin_edit",a)};d.prototype.addOnEndEdit=function(a,b){this.addHandler("end_edit",a,b)};d.prototype.removeOnEndEdit=function(a){this.removeHandler("end_edit",a)};d.prototype.addOnCommitChanges=
function(a,b){this.addHandler("commit_changes",a,b)};d.prototype.removeOnCommitChanges=function(a){this.removeHandler("commit_changes",a)};d.prototype.addOnStatusChanged=function(a,b){this.addHandler("status_changed",a,b)};d.prototype.removeOnStatusChanged=function(a){this.removeHandler("status_changed",a)};d.prototype._getStrValue=function(a,b){var c=b.dateConversion,d=g.get_timeZoneOffset();return l.stringifyValue(a,c,d)};d.prototype._getPKFieldInfos=function(){if(this._pkInfo)return this._pkInfo;
var a=this._fieldMap,b=[];g.forEachProp(a,function(c){0<a[c].isPrimaryKey&&b.push(a[c])});b.sort(function(a,b){return a.isPrimaryKey-b.isPrimaryKey});return this._pkInfo=b};d.prototype._onError=function(b,d){var e=c.prototype._onError.call(this,b,d);return!e?a.global._onError(b,d):e};d.prototype._onCurrentChanging=function(b){try{this.endEdit()}catch(c){a.global.reThrow(c,this._onError(c,this))}this.raiseEvent("current_changing",{newCurrent:b})};d.prototype._onCurrentChanged=function(){this.raisePropertyChanged("currentItem")};
d.prototype._onEditing=function(a,b,c){this._isUpdating||(b?(this._EditingItem=a,this.raiseEvent("begin_edit",{item:a})):(this._EditingItem=null,this.raiseEvent("end_edit",{item:a,isCanceled:c})))};d.prototype._onCommitChanges=function(a,b,c,d){this.raiseEvent("commit_changes",{item:a,isBegin:b,isRejected:c,changeType:d})};d.prototype._onItemStatusChanged=function(a,b){this.raiseEvent("status_changed",{item:a,oldChangeType:b,key:a._key})};d.prototype._validateItem=function(a){a={item:a,fieldName:null,
errors:[]};this.raiseEvent("validate",a);return a.errors&&0<a.errors.length?{fieldName:null,errors:a.errors}:null};d.prototype._validateItemField=function(a,b){var c={item:a,fieldName:b,errors:[]};this.raiseEvent("validate",c);return c.errors&&0<c.errors.length?{fieldName:b,errors:c.errors}:null};d.prototype._addErrors=function(a,b){var c=this;this._ignoreChangeErrors=!0;try{b.forEach(function(b){c._addError(a,b.fieldName,b.errors)})}finally{this._ignoreChangeErrors=!1}this._onErrorsChanged(a)};d.prototype._addError=
function(a,b,c){b||(b="*");g.check.isArray(c)&&0<c.length?(this._errors[a._key]||(this._errors[a._key]={}),this._errors[a._key][b]=c,this._ignoreChangeErrors||this._onErrorsChanged(a)):this._removeError(a,b)};d.prototype._removeError=function(a,b){var c=this._errors[a._key];c&&(b||(b="*"),c[b]&&(delete c[b],0===g.getProps(c).length&&delete this._errors[a._key],this._onErrorsChanged(a)))};d.prototype._removeAllErrors=function(a){this._errors[a._key]&&(delete this._errors[a._key],this._onErrorsChanged(a))};
d.prototype._getErrors=function(a){return this._errors[a._key]};d.prototype._onErrorsChanged=function(a){var b={item:a};this.raiseEvent("errors_changed",b);a._onErrorsChanged(b)};d.prototype._onItemDeleting=function(a){a={item:a,isCancel:!1};this.raiseEvent("item_deleting",a);return!a.isCancel};d.prototype._onFillStart=function(a){this.raiseEvent("fill",a)};d.prototype._onFillEnd=function(a){this.raiseEvent("fill",a)};d.prototype._onItemsChanged=function(a){this.raiseEvent("coll_changed",a)};d.prototype._onItemAdding=
function(b){b={item:b,isCancel:!1};this.raiseEvent("item_adding",b);b.isCancel&&a.global._throwDummy(Error("operation canceled"))};d.prototype._onItemAdded=function(a){this.raiseEvent("item_added",{item:a,isAddNewHandled:!1})};d.prototype._createNew=function(){return new b};d.prototype._attach=function(b,c){if(this._itemsByKey[b._key])throw Error(a.ERRS.ERR_ITEM_IS_ATTACHED);try{this.endEdit()}catch(d){a.global.reThrow(d,this._onError(d,this))}var e;b._onAttaching();g.check.isNt(c)?(e=this._items.length,
this._items.push(b)):(e=c,g.insertIntoArray(this._items,b,e));this._itemsByKey[b._key]=b;this._onItemsChanged({change_type:f.ADDED,items:[b],pos:[e]});b._onAttach();this.raisePropertyChanged("count");this._onCurrentChanging(b);this._currentPos=e;this._onCurrentChanged();return e};d.prototype._onRemoved=function(a,b){try{this._onItemsChanged({change_type:f.REMOVE,items:[a],pos:[b]})}finally{this.raisePropertyChanged("count")}};d.prototype._onPageSizeChanged=function(){};d.prototype._onPageChanging=
function(){var b={page:this.pageIndex,isCancel:!1};this._raiseEvent("page_changing",b);if(!b.isCancel)try{this.endEdit()}catch(c){a.global.reThrow(c,this._onError(c,this))}return!b.isCancel};d.prototype._onPageChanged=function(){};d.prototype._setCurrentItem=function(b){var c=this._currentPos;if(b){if(null===b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);var d,e;if(!this.getItemByKey(b._key))throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);d=this.getItemByPos(c);e=this._items.indexOf(b);if(0>e)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);
if(c!==e||d!==b)this._onCurrentChanging(b),this._currentPos=e,this._onCurrentChanged()}else-1!==c&&(this._onCurrentChanging(null),this._currentPos=-1,this._onCurrentChanged())};d.prototype._destroyItems=function(){this._items.forEach(function(a){a.destroy()})};d.prototype.getFieldInfo=function(a){return this._fieldMap[a]};d.prototype.getFieldNames=function(){return g.getProps(this._fieldMap)};d.prototype.cancelEdit=function(){this.isEditing&&this._EditingItem.cancelEdit()};d.prototype.endEdit=function(){var a;
this.isEditing&&(a=this._EditingItem,!a.endEdit()&&a.getIsHasErrors()&&(this._onError(new q(a.getAllErrors(),a),a),this.cancelEdit()))};d.prototype.getItemsWithErrors=function(){var a=this,b=[];g.forEachProp(this._errors,function(c){c=a.getItemByKey(c);b.push(c)});return b};d.prototype.addNew=function(){var b,c;b=this._createNew();this._onItemAdding(b);this._attach(b,null);try{this.currentItem=b,b.beginEdit(),this._onItemAdded(b)}catch(d){c=this._onError(d,this),b.cancelEdit(),a.global.reThrow(d,
c)}return b};d.prototype.getItemByPos=function(a){return 0>a||a>=this._items.length?null:this._items[a]};d.prototype.getItemByKey=function(b){if(!b)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);return this._itemsByKey[""+b]};d.prototype.findByPK=function(){for(var a=[],b=0;b<arguments.length-0;b++)a[b]=arguments[b+0];if(0===arguments.length)return null;var b=this._getPKFieldInfos(),c=[],d=[],d=1===a.length&&g.check.isArray(a[0])?a[0]:a;if(d.length!==b.length)return null;for(var a=0,e=b.length;a<e;a+=1)c.push(this._getStrValue(d[a],
b[a]));b=c.join(";");return this.getItemByKey(b)};d.prototype.moveFirst=function(a){if(0===this._currentPos)return!1;var b=this.getItemByPos(0);if(!b)return!1;if(a&&b._isDeleted)return this.moveNext(!0);this._onCurrentChanging(b);this._currentPos=0;this._onCurrentChanged();return!0};d.prototype.movePrev=function(a){var b=-1,c=this._currentPos,d=this.getItemByPos(c);d&&(b=c-1);d=this.getItemByPos(b);if(!d)return!1;if(a&&d._isDeleted)return this._currentPos=b,this.movePrev(!0);this._onCurrentChanging(d);
this._currentPos=b;this._onCurrentChanged();return!0};d.prototype.moveNext=function(a){var b=-1,c=this._currentPos,d=this.getItemByPos(c);d&&(b=c+1);d=this.getItemByPos(b);if(!d)return!1;if(a&&d._isDeleted)return this._currentPos=b,this.moveNext(!0);this._onCurrentChanging(d);this._currentPos=b;this._onCurrentChanged();return!0};d.prototype.moveLast=function(a){var b=this._items.length-1;if(this._currentPos===b)return!1;var c=this.getItemByPos(b);if(!c)return!1;if(a&&c._isDeleted)return this.movePrev(!0);
this._onCurrentChanging(c);this._currentPos=b;this._onCurrentChanged();return!0};d.prototype.goTo=function(a){if(this._currentPos===a)return!1;var b=this.getItemByPos(a);if(!b)return!1;this._onCurrentChanging(b);this._currentPos=a;this._onCurrentChanged();return!0};d.prototype.forEach=function(a,b){this._items.forEach(a,b)};d.prototype.removeItem=function(b){if(null===b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[b._key]){var c=g.removeFromArray(this._items,b);if(0>c)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);
delete this._itemsByKey[b._key];delete this._errors[b._key];this._onRemoved(b,c);b._key=null;b.removeHandler(null,null);b=this.getItemByPos(c);var d=this._currentPos;d===c&&(b||(this._currentPos=d-1),this._onCurrentChanged());d>c&&(this._currentPos=d-1,this._onCurrentChanged())}};d.prototype.getIsHasErrors=function(){return!this._errors?!1:0<g.getProps(this._errors).length};d.prototype.sort=function(a,b){var c=this,d=g.createDeferred();setTimeout(function(){try{c.sortLocal(a,b)}finally{d.resolve()}},
0);return d.promise()};d.prototype.sortLocal=function(a,b){var c=1;b&&"DESC"===b.toUpperCase()&&(c=-1);this.sortLocalByFunc(function(b,d){var e=0,m,h,s;m=0;for(h=a.length;m<h&&!(s=a[m],e=b[s],s=d[s],e=e<s?-1*c:e>s?c:0,0!==e);m+=1);return e})};d.prototype.sortLocalByFunc=function(a){var b=this;this.waitForNotLoading(function(){var c=b.currentItem;b.isLoading=!0;try{b._items.sort(a),b._onItemsChanged({change_type:f.RESET,items:[],pos:[]})}finally{b.isLoading=!1}b.currentItem=null;b.currentItem=c},[],
!1,null)};d.prototype.clear=function(){this.raiseEvent("clearing",{});this.cancelEdit();this._EditingItem=null;this._newKey=0;this.currentItem=null;this._destroyItems();this._items=[];this._itemsByKey={};this._errors={};this._onItemsChanged({change_type:f.RESET,items:[],pos:[]});this.raiseEvent("cleared",{});this.raisePropertyChanged("count")};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),this._waitQueue=null,this.clear(),this._fieldMap={},c.prototype.destroy.call(this))};
d.prototype.waitForNotLoading=function(a,b,c,d){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(a){return!a},action:a,actionArgs:b,lastWins:!!d,syncCheck:!!c})};d.prototype.toString=function(){return"Collection"};Object.defineProperty(d.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentItem",{get:function(){return this.getItemByPos(this._currentPos)},set:function(a){this._setCurrentItem(a)},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"count",{get:function(){return this._items.length},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){a!=this._totalCount&&(this._totalCount=a,this.raisePropertyChanged("totalCount"),this.raisePropertyChanged("pageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pageSize",{get:function(){return this._options.pageSize},set:function(a){this._options.pageSize!==
a&&(this._options.pageSize=a,this.raisePropertyChanged("pageSize"),this._onPageSizeChanged())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(a){a!==this._pageIndex&&this.isPagingEnabled&&!(0>a)&&this._onPageChanging()&&(this._pageIndex=a,this._onPageChanged(),this.raisePropertyChanged("pageIndex"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"items",{get:function(){return this._items},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"permissions",{get:function(){return this._perms},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return!!this._EditingItem},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isLoading",{get:function(){return this._isLoading},set:function(a){this._isLoading!==
a&&(this._isLoading=a,this.raisePropertyChanged("isLoading"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isUpdating",{get:function(){return this._isUpdating},set:function(a){this._isUpdating!==a&&(this._isUpdating=a,this.raisePropertyChanged("isUpdating"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});
return d}(a.BaseObject);k.Collection=d;var c=function(a){function b(c){a.call(this);var d=this;this.__isNew=!c;c&&(this._vals=c);c||this._collection.getFieldNames().forEach(function(a){d._vals[a]=null})}__extends(b,a);b.prototype._setProp=function(a,b){var c,d=this._collection;if(this._vals[a]!==b)try{if(this._vals[a]=b,this.raisePropertyChanged(a),d._removeError(this,a),c=this._validateField(a))throw new q([c],this);}catch(e){throw c=g.check.isProtoOf(q,e)?e:new q([{fieldName:a,errors:[e.message]}],
this),d._addError(this,a,c.errors[0].errors),c;}};b.prototype._getProp=function(a){return this._vals[a]};b.prototype._resetIsNew=function(){this.__isNew=!1};b.prototype.toString=function(){return"ListItem"};Object.defineProperty(b.prototype,"_isNew",{get:function(){return this.__isNew},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_collection",{get:function(){return this.__coll},enumerable:!0,configurable:!0});return b}(b);k.ListItem=c;var h=function(e){function h(c,d){e.call(this);
this._type_name=c;if(g.check.isArray(d)){this._props=d;if(0===this._props.length)throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,"properties",d));this._initFieldMap(!1,d)}else if(d instanceof b)this._props=d.getFieldNames(),this._initFieldMap(!0,d);else if(d)this._props=Object.keys(d),this._initFieldMap(!1,d);else throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,"properties",d));this._itemType=null;this._createItemType()}__extends(h,e);h.prototype._initFieldMap=function(a,b){var c=this;a?this._props.forEach(function(a){c._fieldMap[a]=
g.extend(!1,{},b.getFieldInfo(a))}):this._props.forEach(function(a){c._fieldMap[a]=d.getEmptyFieldInfo(a)})};h.prototype._attach=function(b){try{this.endEdit()}catch(c){a.global.reThrow(c,this._onError(c,this))}return e.prototype._attach.call(this,b)};h.prototype._createNew=function(){var a=new this._itemType(null);a._key=this._getNewKey(null);return a};h.prototype._createItemType=function(){var b={},d=this;this.getFieldNames().forEach(function(a){b[a]={set:function(b){this._setProp(a,b)},get:function(){return this._getProp(a)}}},
this);this._itemType=a.MOD.utils.__extendType(c,{__coll:this,toString:function(){return d._type_name+"Item"}},b)};h.prototype._getNewKey=function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};h.prototype.fillItems=function(a,b){var c=this,d=[],e=[],h=[];this._onFillStart({isBegin:!0,rowCount:a.length,time:new Date,isPageChanged:!1});try{b&&this.clear(),a.forEach(function(a){a=new c._itemType(a);a._key=c._getNewKey(a);var b=c._itemsByKey[a._key];b?h.push(b):(c._items.push(a),c._itemsByKey[a._key]=
a,d.push(a),e.push(c._items.length-1),h.push(a))}),0<d.length&&(this._onItemsChanged({change_type:f.ADDED,items:d,pos:e}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:h.length,time:new Date,resetUI:!!b,fetchedItems:h,newItems:d,isPageChanged:!1})}this.moveFirst()};h.prototype.getNewObjects=function(){return this._items.filter(function(a){return a._isNew})};h.prototype.resetNewObjects=function(){this._items.forEach(function(a){a._resetIsNew()})};h.prototype.toString=
function(){return this._type_name};return h}(d);k.List=h;var w=function(b){function c(d,e,h){if(!h)throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,"keyName",h));this._keyName=h;b.call(this,d,e);d=this.getFieldInfo(h);if(!d)throw Error(g.format(a.ERRS.ERR_DICTKEY_IS_NOTFOUND,h));d.isPrimaryKey=1}__extends(c,b);c.prototype._getNewKey=function(c){if(!c)return b.prototype._getNewKey.call(this,null);c=c[this._keyName];if(g.check.isNt(c))throw Error(g.format(a.ERRS.ERR_DICTKEY_IS_EMPTY,this._keyName));return""+
c};return c}(h);k.Dictionary=w;a.global.registerType("List",h);a.global.registerType("Dictionary",w);a.global.onModuleLoaded("collection",k)})(r.collection||(r.collection={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts;k.css={templateContainer:"ria-template-container"};var e=function(e){function l(a,d){e.call(this);this._app=a;this._el=this._dctxt=null;this._isDisabled=!1;this._lfTime=null;this._templateID=d;this._templElView=void 0;this._busyTimeOut=this._promise=null;this._templateID&&this._loadTemplate()}__extends(l,e);l.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),d=[],c=0,e=a.length;c<
e;c+=1)g.check.isBinding(a[c])&&d.push(a[c]);return d};l.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),d=[],c=0,e=a.length;c<e;c+=1)g.check.isElView(a[c])&&d.push(a[c]);return d};l.prototype._getTemplateElView=function(){if(!this._lfTime||null===this._templElView)return null;if(this._templElView)return this._templElView;for(var a=null,d=this._getElViews(),c=0,e=d.length;c<e;c+=1)if(g.check.isTemplateElView(d[c])){a=d[c];break}return this._templElView=
a};l.prototype._loadTemplateElAsync=function(b){if(b=this.app.getTemplateLoader(b))return b().then(function(b){var c=a.global.document.createElement("div");c.innerHTML=b;return c.firstElementChild});b=g.createDeferred();b.reject(Error(g.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,this._templateID)));return b.promise()};l.prototype._appendIsBusy=function(b){var d=this;this._busyTimeOut=setTimeout(function(){d._busyTimeOut&&!d._isDestroyCalled&&(d._busyTimeOut=null,(new a.MOD.baseElView.BusyElView(d.app,
b,{img:q.LOADER_GIF.SMALL,delay:0})).isBusy=!0)},400)};l.prototype._removeIsBusy=function(b){this._busyTimeOut&&(clearTimeout(this._busyTimeOut),this._busyTimeOut=null);(b=this.app._getElView(b))&&b instanceof a.MOD.baseElView.BusyElView&&b.destroy()};l.prototype._loadTemplate=function(){var b=this,d=b._templateID,c,e,f=!1;b._promise&&(b._promise.reject("cancel"),b._promise=null);b._unloadTemplate();d&&(d=b._loadTemplateElAsync(d),f="pending"==d.state(),b._promise=c=g.createDeferred(),d.done(function(a){"pending"==
c.state()&&c.resolve(a)}),d.fail(function(a){"pending"==c.state()&&c.reject(a)}),b._el=e=a.global.document.createElement("div"),e.className=k.css.templateContainer,f&&(b._appendIsBusy(e),c.done(function(){b._removeIsBusy(e)}),c.fail(function(a){"cancel"==a&&b._removeIsBusy(e)})),c.then(function(a){b._isDestroyCalled||(b._promise=null,a?(b._el.appendChild(a),b._lfTime=b.app._bindTemplateElements(a),(a=b._getTemplateElView())&&a.templateLoaded(b),b._updateBindingSource()):b._unloadTemplate())},function(c){if(!b._isDestroyCalled&&
(b._promise=null,"cancel"!=c)){var d;c&&(c.message?d=c:c.statusText?d=Error(c.statusText):g.check.isString(c)&&(d=Error(c)));d||(d=Error(g.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,b._templateID)));a.global._onError(d,b)}}))};l.prototype._updateBindingSource=function(){var a,d,c,e=this._getBindings();a=0;for(d=e.length;a<d;a+=1)c=e[a],c.isDisabled=this._isDisabled,c.isSourceFixed||(c.source=this._dctxt)};l.prototype._updateIsDisabled=function(){var a,d,c,e=this._getBindings(),f=this._getElViews(),g=this.app._getElViewType(q.ELVIEW_NM.DATAFORM);
a=0;for(d=e.length;a<d;a+=1)c=e[a],c.isDisabled=this._isDisabled;a=0;for(d=f.length;a<d;a+=1)c=f[a],c instanceof g&&c.form&&(c.form.isDisabled=this._isDisabled)};l.prototype._unloadTemplate=function(){try{if(this._el){var b=this._templElView;this._templElView=void 0;b&&b.templateUnloading(this)}}finally{this._lfTime&&(this._lfTime.destroy(),this._lfTime=null),this._el&&a.global.$(this._el).remove(),this._el=null}};l.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._busyTimeOut&&
(clearTimeout(this._busyTimeOut),this._busyTimeOut=null),this._promise&&(this._promise.reject("cancel"),this._promise=null),this._dctxt=null,this._unloadTemplate(),this._templateID=null,this._templElView=void 0,this._app=null,e.prototype.destroy.call(this))};l.prototype.findElByDataName=function(b){return a.global.$(this._el).find(["*[",q.DATA_ATTR.DATA_NAME,'="',b,'"]'].join("")).toArray()};l.prototype.findElViewsByDataName=function(a){var d=this,c=[];this.findElByDataName(a).forEach(function(a){(a=
d.app._getElView(a))&&c.push(a)});return c};l.prototype.toString=function(){return"Template"};Object.defineProperty(l.prototype,"dataContext",{get:function(){return this._dctxt},set:function(a){this._dctxt!==a&&(this._dctxt=a,this.raisePropertyChanged("dataContext"),this._updateBindingSource())},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"templateID",{get:function(){return this._templateID},set:function(a){this._templateID!==a&&(this._templateID=a,this._loadTemplate(),this.raisePropertyChanged("templateID"))},
enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"isDisabled",{get:function(){return this._isDisabled},set:function(a){this._isDisabled!==a&&(this._isDisabled=!!a,this._updateIsDisabled(),this.raisePropertyChanged("isDisabled"))},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return l}(a.BaseObject);
k.Template=e;a.global.registerType("Template",e);a.global.onModuleLoaded("template",k)})(r.template||(r.template={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){function g(b,c,d,e){var h={mode:r.binding.BINDING_MODE[1],converterParam:null,converter:null,targetPath:null,sourcePath:null,target:null,source:null,isSourceFixed:!1},f=c.source,m=c.target;!c.sourcePath&&c.to?h.sourcePath=c.to:c.sourcePath&&(h.sourcePath=c.sourcePath);c.targetPath&&(h.targetPath=c.targetPath);c.converterParam&&(h.converterParam=c.converterParam);c.mode&&(h.mode=c.mode);c.converter&&(q.check.isString(c.converter)?h.converter=b.getConverter(c.converter):
h.converter=c.converter);m?q.check.isString(m)?h.target="this"==m?d:a.global.parser.resolveBindingSource(b,a.global.parser._getPathParts(m)):h.target=m:h.target=d;f?(h.isSourceFixed=!0,q.check.isString(f)?h.source="this"==f?d:a.global.parser.resolveBindingSource(b,a.global.parser._getPathParts(f)):h.source=f):h.source=e;return h}var q=a.global.utils,e=a.global.consts;k.css={content:"ria-content-field",required:"ria-required-field"};k.parseContentAttr=function(b){var c={name:null,templateInfo:null,
bindingInfo:null,displayInfo:null,fieldName:null,options:null};b=a.global.parser.parseOptions(b);if(0===b.length)return c;b=b[0];!b.template&&b.fieldName?(c.bindingInfo={target:null,source:null,targetPath:null,sourcePath:b.fieldName,mode:"OneWay",converter:null,converterParam:null},c.displayInfo=b.css,c.fieldName=b.fieldName,b.name&&(c.name=b.name),b.options&&(c.options=b.options),void 0!==b.readOnly&&(c.readOnly=q.parseBool(b.readOnly))):b.template&&(c.templateInfo=b.template,delete b.template);
return c};k.getBindingOptions=g;var f=function(b){function c(d,e,h,f,m){b.call(this);this._app=d;this._parentEl=e;this._el=null;this._options=h;this._isReadOnly=!!this._options.readOnly;this._isEditing=!!m;this._dctx=f;this._tgt=this._lfScope=null;a.global.$(this._parentEl).addClass(k.css.content);this._init();this.update()}__extends(c,b);c.prototype._init=function(){};c.prototype._updateCss=function(){var b=this._getDisplayInfo(),c=a.global.$(this._parentEl),d=this.getFieldInfo();this._isEditing&&
this._canBeEdited()?(b&&(b.editCss&&c.addClass(b.editCss),b.displayCss&&c.removeClass(b.displayCss)),d&&!d.isNullable&&c.addClass(k.css.required)):b&&(b.displayCss&&c.addClass(b.displayCss),b.editCss&&c.removeClass(b.editCss),d&&!d.isNullable&&c.removeClass(k.css.required))};c.prototype._canBeEdited=function(){if(this._isReadOnly)return!1;var a=this.getFieldInfo();return!a?!1:!!this._dctx&&!!this._dctx.beginEdit&&!a.isReadOnly&&!a.isCalculated};c.prototype._createTargetElement=function(){var b;b=
a.global.document;this._isEditing&&this._canBeEdited()?(b=b.createElement("input"),b.setAttribute("type","text")):b=b.createElement("span");this._updateCss();return b};c.prototype._getBindingOption=function(a,b,c,d){a=g(this.app,a,b,c);this.isEditing&&this._canBeEdited()?a.mode="TwoWay":a.mode="OneWay";d&&(a.targetPath=d);return a};c.prototype._getBindings=function(){if(!this._lfScope)return[];for(var a=this._lfScope.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)q.check.isBinding(a[c])&&b.push(a[c]);return b};
c.prototype._updateBindingSource=function(){var a,b,c,d=this._getBindings();a=0;for(b=d.length;a<b;a+=1)c=d[a],c.isSourceFixed||(c.source=this._dctx)};c.prototype._cleanUp=function(){this._lfScope&&(this._lfScope.destroy(),this._lfScope=null);this._el&&(a.global.$(this._el).remove(),this._el=null);this._tgt=null};c.prototype.getFieldInfo=function(){return this._options.fieldInfo};c.prototype._getBindingInfo=function(){return this._options.bindingInfo};c.prototype._getDisplayInfo=function(){return this._options.displayInfo};
c.prototype._getElementView=function(a){return this.app.getElementView(a)};c.prototype.update=function(){this._cleanUp();var b=this._getBindingInfo();b&&(this._el=this._createTargetElement(),this._tgt=this._getElementView(this._el),this._lfScope=new a.MOD.utils.LifeTimeScope,this._lfScope.addObj(this._tgt),b=this._getBindingOption(b,this._tgt,this._dctx,"value"),this._parentEl.appendChild(this._el),this._lfScope.addObj(this.app.bind(b)))};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=
!0;var c=this._getDisplayInfo(),d=a.global.$(this._parentEl);d.removeClass(k.css.content);d.removeClass(k.css.required);c&&c.displayCss&&d.removeClass(c.displayCss);c&&c.editCss&&d.removeClass(c.editCss);this._cleanUp();this._app=this._options=this._dctx=this._parentEl=null;b.prototype.destroy.call(this)}};c.prototype.toString=function(){return"BindingContent"};Object.defineProperty(c.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"target",{get:function(){return this._tgt},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return this._isEditing},set:function(a){this._isEditing!==a&&(this._isEditing=a,this.update())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataContext",{get:function(){return this._dctx},set:function(a){this._dctx!==a&&(this._dctx=a,this._updateBindingSource())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"app",{get:function(){return this._app},
enumerable:!0,configurable:!0});return c}(a.BaseObject);k.BindingContent=f;var l=function(b){function c(d,e,h,f,m){b.call(this);h=h.templateInfo;this._app=d;this._parentEl=e;this._isEditing=!!m;this._dctx=f;this._templateInfo=h;this._template=null;a.global.$(this._parentEl).addClass(k.css.content);this.update()}__extends(c,b);c.prototype._createTemplate=function(){var b=this._templateInfo,c=b.displayID;this._isEditing?b.editID&&(c=b.editID):c||(c=b.editID);if(!c)throw Error(a.ERRS.ERR_TEMPLATE_ID_INVALID);
return new a.MOD.template.Template(this.app,c)};c.prototype.update=function(){this._cleanUp();var a;this._templateInfo&&(this._template=a=this._createTemplate(),this._parentEl.appendChild(a.el),a.dataContext=this._dctx)};c.prototype._cleanUp=function(){this._template&&(this._template.destroy(),this._template=null)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.$(this._parentEl).removeClass(k.css.content),this._cleanUp(),this._app=this._templateInfo=this._dctx=
this._parentEl=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return"TemplateContent"};Object.defineProperty(c.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return this._isEditing},
set:function(a){this._isEditing!==a&&(this._isEditing=a,this.update())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataContext",{get:function(){return this._dctx},set:function(a){this._dctx!==a&&(this._dctx=a,this._template&&(this._template.dataContext=this._dctx))},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.TemplateContent=l;var b=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){this._createTargetElement();var b=this._getBindingInfo();
b&&(this._updateCss(),this._lfScope=new a.MOD.utils.LifeTimeScope,b=this._getBindingOption(b,this._tgt,this._dctx,"checked"),b.mode="TwoWay",this._lfScope.addObj(this.app.bind(b)))};c.prototype._createCheckBoxView=function(){var b=a.global.document.createElement("input");b.setAttribute("type","checkbox");return new r.baseElView.CheckBoxElView(this.app,b,{})};c.prototype._createTargetElement=function(){this._tgt||(this._tgt=this._createCheckBoxView(),this._el=this._tgt.el);this._parentEl.appendChild(this._el);
return this._el};c.prototype._updateCss=function(){b.prototype._updateCss.call(this);var a=this._el;this._isEditing&&this._canBeEdited()?a.disabled&&(a.disabled=!1):a.disabled||(a.disabled=!0)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._lfScope&&(this._lfScope.destroy(),this._lfScope=null),this._tgt&&(this._tgt.destroy(),this._tgt=null),b.prototype.destroy.call(this))};c.prototype._cleanUp=function(){};c.prototype.update=function(){this._cleanUp();this._updateCss()};
c.prototype.toString=function(){return"BoolContent"};return c}(f);k.BoolContent=b;var d=function(b){function c(a,d,e,h,m){b.call(this,a,d,e,h,m);this._fn_cleanup=null}__extends(c,b);c.prototype._getBindingOption=function(c,d,e,h){c=b.prototype._getBindingOption.call(this,c,d,e,h);c.converter=this.app.getConverter("dateConverter");c.converterParam=a.global.defaults.dateFormat;return c};c.prototype._createTargetElement=function(){var c=b.prototype._createTargetElement.call(this);if(this.isEditing){var d=
a.global.$(c);d.datepicker();this._fn_cleanup=function(){q.destroyJQueryPlugin(d,"datepicker")}}return c};c.prototype._cleanUp=function(){this._fn_cleanup&&(this._fn_cleanup(),this._fn_cleanup=null);b.prototype._cleanUp.call(this)};c.prototype.toString=function(){return"DateContent"};return c}(f);k.DateContent=d;var c=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._getBindingOption=function(c,d,h,f){c=b.prototype._getBindingOption.call(this,c,d,h,f);c.converter=this.app.getConverter("dateTimeConverter");
d=this.getFieldInfo();h=a.global.defaults;switch(d.dataType){case e.DATA_TYPE.DateTime:c.converterParam=h.dateTimeFormat;break;case e.DATA_TYPE.Time:c.converterParam=h.timeFormat;break;default:c.converterParam=h.dateTimeFormat}return c};c.prototype.toString=function(){return"DateTimeContent"};return c}(f);k.DateTimeContent=c;var h=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.__allowedKeys=null;Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){if(!c.__allowedKeys){var b=
a.global.consts.KEYS;c.__allowedKeys=[0,b.backspace,b.del,b.left,b.right,b.end,b.home,b.tab,b.esc,b.enter]}return c.__allowedKeys},enumerable:!0,configurable:!0});c.prototype._getBindingOption=function(a,c,d,h){a=b.prototype._getBindingOption.call(this,a,c,d,h);switch(this.getFieldInfo().dataType){case e.DATA_TYPE.Integer:a.converter=this.app.getConverter("integerConverter");break;case e.DATA_TYPE.Decimal:a.converter=this.app.getConverter("decimalConverter");break;default:a.converter=this.app.getConverter("floatConverter")}return a};
c.prototype.update=function(){b.prototype.update.call(this);var a=this;a._tgt instanceof r.baseElView.TextBoxElView&&a._tgt.addOnKeyPress(function(b,c){c.isCancel=!a._previewKeyPress(c.keyCode,c.value)})};c.prototype._previewKeyPress=function(b,c){if(-1<this._allowedKeys.indexOf(b))return!0;if(47===b)return!1;var d={32:" ",44:",",46:"."}[b],e=a.global.defaults;return d===e.decimalPoint?0===c.length?!1:0>c.indexOf(d):d&&d!==e.thousandSep?!1:!(!d&&(45>b||57<b))};c.prototype.toString=function(){return"NumberContent"};
return c}(f);k.NumberContent=h;var w=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.__allowedKeys=null;Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){if(!c.__allowedKeys){var b=a.global.consts.KEYS;c.__allowedKeys=[0,b.backspace,b.del,b.left,b.right,b.end,b.home,b.tab,b.esc,b.enter]}return c.__allowedKeys},enumerable:!0,configurable:!0});c.prototype.update=function(){b.prototype.update.call(this);var a=this,c=a.getFieldInfo();a._tgt instanceof r.baseElView.TextBoxElView&&
a._tgt.addOnKeyPress(function(b,d){d.isCancel=!a._previewKeyPress(c,d.keyCode,d.value)})};c.prototype._previewKeyPress=function(a,b,c){return!(0<a.maxLength&&c.length>=a.maxLength&&-1===this._allowedKeys.indexOf(b))};c.prototype.toString=function(){return"StringContent"};return c}(f);k.StringContent=w;var v=function(b){function c(d,e,h,f,m){if("multyline"!=h.name)throw Error(q.format(a.ERRS.ERR_ASSERTION_FAILED,"options.name == 'multyline'"));b.call(this,d,e,h,f,m)}__extends(c,b);c.__allowedKeys=
null;Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){if(!c.__allowedKeys){var b=a.global.consts.KEYS;c.__allowedKeys=[0,b.backspace,b.del,b.left,b.right,b.end,b.home,b.tab,b.esc,b.enter]}return c.__allowedKeys},enumerable:!0,configurable:!0});c.prototype._createTargetElement=function(){var b;b=this._isEditing&&this._canBeEdited()?a.global.document.createElement("textarea"):a.global.document.createElement("div");this._updateCss();return b};c.prototype.update=function(){b.prototype.update.call(this);
var a=this,c=a.getFieldInfo();if(a._tgt instanceof r.baseElView.TextAreaElView){a._tgt.addOnKeyPress(function(b,d){d.isCancel=!a._previewKeyPress(c,d.keyCode,d.value)});var d=this._options.options,e=a._tgt;d&&(d.rows&&(e.rows=d.rows),d.cols&&(e.cols=d.cols),d.wrap&&(e.wrap=d.wrap))}};c.prototype._previewKeyPress=function(a,b,c){return!(0<a.maxLength&&c.length>=a.maxLength&&-1===this._allowedKeys.indexOf(b))};c.prototype.toString=function(){return"MultyLineContent"};return c}(f);k.MultyLineContent=
v;var z=function(){function g(a,b){this._app=a;this._nextFactory=b}g.prototype.getContentType=function(g){if(g.templateInfo)return l;if(!g.bindingInfo)throw Error(q.format(a.ERRS.ERR_PARAM_INVALID,"options","bindingInfo"));var k=e.DATA_TYPE,p=g.fieldInfo;switch(p.dataType){case k.None:k=f;break;case k.String:k="multyline"==g.name?v:w;break;case k.Bool:k=b;break;case k.Integer:k=h;break;case k.Decimal:case k.Float:k=h;break;case k.DateTime:case k.Time:k=c;break;case k.Date:k=d;break;case k.Guid:case k.Binary:k=
f;break;default:throw Error(q.format(a.ERRS.ERR_FIELD_DATATYPE,p.dataType));}!k&&this._nextFactory&&(k=this._nextFactory.getContentType(g));if(!k)throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);return k};g.prototype.createContent=function(a,b,c,d){return new (this.getContentType(b))(this._app,a,b,c,d)};g.prototype.isExternallyCachable=function(a){return!!a&&!!a.addOnObjectCreated&&!!a.addOnObjectNeeded};Object.defineProperty(g.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});
return g}();k.ContentFactory=z;k.initModule=function(a){a.registerContentFactory(function(b){return new z(a,b)});return k};a.global.onModuleLoaded("baseContent",k)})(r.baseContent||(r.baseContent={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g;function q(b,c){if(b)switch(b.name){case "AccessDeniedException":throw new z(a.ERRS.ERR_ACCESS_DENIED,c);case "ConcurrencyException":throw new p(a.ERRS.ERR_CONCURRENCY,c);case "ValidationException":throw new t(e.format(a.ERRS.ERR_VALIDATION,b.message),c);case "DomainServiceException":throw new v(e.format(a.ERRS.ERR_SVC_ERROR,b.message),c);default:throw new v(e.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,b.message),c);}}var e=a.global.utils,f=a.global.consts,
l=r.binding.ValidationError,b=a.MOD.utils.valueUtils,d=a.MOD.collection.consts.COLL_CHANGE_TYPE,c=a.MOD.consts.CHANGE_TYPE,h=r.collection.consts.SORT_ORDER;g="submit";var w={NoAction:0,Cascade:1,SetNulls:2},v=function(a){function b(c,d){var e;c&&(e=c.message);e||(e=""+c);a.call(this,e);this._origError=c;this._operationName=d}__extends(b,a);Object.defineProperty(b.prototype,"operationName",{get:function(){return this._operationName},enumerable:!0,configurable:!0});return b}(a.MOD.errors.BaseError);
k.DataOperationError=v;var z=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(v);k.AccessDeniedError=z;var p=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(v);k.ConcurrencyError=p;var t=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(v);k.SvcValidationError=t;var B=function(a){function b(c,d,h){var s=c.message||""+c;a.call(this,s,g);this._origError=c;this._allSubmitted=d||[];this._notValidated=h||[];if(0<this._notValidated.length){var m=
[s+":"];this._notValidated.forEach(function(a){m.push(e.format("item key:{0} errors:{1}",a._key,a.getErrorString()))});this._message=m.join("\r\n")}}__extends(b,a);Object.defineProperty(b.prototype,"allSubmitted",{get:function(){return this._allSubmitted},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"notValidated",{get:function(){return this._notValidated},enumerable:!0,configurable:!0});return b}(v);k.SubmitError=B;var C=function(b){function c(a){b.call(this);this._query=a;this._cache=
[];this._totalCount=0;this._itemsByKey={}}__extends(c,b);c.prototype.getCachedPage=function(b){var c=this._cache.filter(function(a){return a.pageIndex===b});if(0==c.length)return null;if(1!=c.length)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,"res.length == 1"));return c[0]};c.prototype.reindexCache=function(){var a=this,b;this._itemsByKey={};for(var c=0;c<this._cache.length;c+=1)b=this._cache[c],b.items.forEach(function(b){a._itemsByKey[b._key]=b})};c.prototype.getPrevCachedPageIndex=function(a){for(var b=
-1,c,d=0;d<this._cache.length;d+=1)c=this._cache[d].pageIndex,c>b&&c<a&&(b=c);return b};c.prototype.getNextRange=function(a){var b=Math.floor((this.loadPageCount-1)/2),c=a+b+(this.loadPageCount-1)%2,b=a-b;a=this.getPrevCachedPageIndex(a);0>b&&(c+=0-b,b=0);b<=a&&(c+=a-b+1,b+=a-b+1);this._pageCount>this.loadPageCount&&c>this._pageCount-1&&(b-=c-(this._pageCount-1),0>b&&(b=0),c=this._pageCount-1);b<=a&&(c+=a-b+1,b+=a-b+1);a=c-b+1;a<this.loadPageCount&&(c+=this.loadPageCount-a,a=c-b+1);return{start:b,
end:c,cnt:a}};c.prototype.fillCache=function(a,b){var c,d=this._itemsByKey,e,h,m=b.length,s,f=this.pageSize;for(e=0;e<this.loadPageCount;e+=1){h=a+e;s=this.getCachedPage(h);s||(s={items:[],pageIndex:h},this._cache.push(s));for(h=0;h<f;h+=1)if(c=e*f+h,c<m)c=b[c],d[c._key]||(s.items.push(c),d[c._key]=c,c._isCached=!0);else return}};c.prototype.clear=function(){var a,b,c,d,e=this._query.dbSet;for(a=0;a<this._cache.length;a+=1){c=this._cache[a].items;for(b=0;b<c.length;b+=1)if((d=c[b])&&null!==d._key)d._isCached=
!1,e.getItemByKey(d._key)||d.destroy()}this._cache=[];this._itemsByKey={}};c.prototype.clearCacheForPage=function(a){var b=this.getCachedPage(a);a=this._query.dbSet;if(b){var c,d,e=this._cache.indexOf(b);c=b.items;for(b=0;b<c.length;b+=1)if((d=c[b])&&null!==d._key)delete this._itemsByKey[d._key],d._isCached=!1,a.getItemByKey(d._key)||d.destroy();this._cache.splice(e,1)}};c.prototype.hasPage=function(a){for(var b=0;b<this._cache.length;b+=1)if(this._cache[b].pageIndex===a)return!0;return!1};c.prototype.getItemByKey=
function(a){return this._itemsByKey[a]};c.prototype.getPageByItem=function(a){a=this._itemsByKey[a._key];if(!a)return-1;for(var b=0;b<this._cache.length;b+=1)if(-1<this._cache[b].items.indexOf(a))return this._cache[b].pageIndex;return-1};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.clear(),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataCache"};Object.defineProperty(c.prototype,"_pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;
return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageSize",{get:function(){return this._query.pageSize},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"loadPageCount",{get:function(){return this._query.loadPageCount},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){e.check.isNt(a)&&(a=0);a!==this._totalCount&&(this._totalCount=
a,this.raisePropertyChanged("totalCount"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"cacheSize",{get:function(){return this._cache.length},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.DataCache=C;var D=function(c){function d(a,b){c.call(this);this._dbSet=a;this.__queryInfo=b;this._filterInfo={filterItems:[]};this._sortInfo={sortItems:[]};this._isClearPrevData=this._isIncludeTotalCount=!0;this._pageSize=a.pageSize;this._pageIndex=a.pageIndex;this._params={};this._loadPageCount=
1;this._isClearCacheOnEveryLoad=!0;this._dataCache=null;this._cacheInvalidated=!1}__extends(d,c);d.prototype.getFieldInfo=function(a){return this._dbSet.getFieldInfo(a)};d.prototype.getFieldNames=function(){return e.getProps(this._dbSet._fieldMap)};d.prototype._addSort=function(a,b){var c=h.ASC,d=this._sortInfo;b&&"d"===b.toLowerCase().substr(0,1)&&(c=h.DESC);d.sortItems.push({fieldName:a,sortOrder:c});this._cacheInvalidated=!0};d.prototype._addFilterItem=function(c,d,h){var m=0,m=this.getFieldInfo(c);
if(!m)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,c));var f=this._serverTimezone,s=m.dateConversion,g=h;e.check.isArray(g)||(g=[h]);g=a.ArrayHelper.clone(g).map(function(a){return b.stringifyValue(a,s,f)});switch(d.toLowerCase()){case "equals":case "=":m=0;break;case "noteq":case "!=":case "<>":m=9;break;case "between":m=1;if(2!=h.length)throw Error(a.ERRS.ERR_QUERY_BETWEEN);break;case "startswith":m=2;break;case "endswith":m=3;break;case "contains":m=4;break;case "gt":case ">":m=
5;break;case "gteq":case ">=":m=7;break;case "lt":case "<":m=6;break;case "lteq":case "<=":m=8;break;default:throw Error(e.format(a.ERRS.ERR_QUERY_OPERATOR_INVALID,d));}this._filterInfo.filterItems.push({fieldName:c,kind:m,values:g});this._cacheInvalidated=!0};d.prototype.where=function(a,b,c){this._addFilterItem(a,b,c);return this};d.prototype.and=function(a,b,c){this._addFilterItem(a,b,c);return this};d.prototype.orderBy=function(a,b){this._addSort(a,b);return this};d.prototype.thenBy=function(a,
b){this._addSort(a,b);return this};d.prototype.clearSort=function(){this._sortInfo.sortItems=[];this._cacheInvalidated=!0;return this};d.prototype.clearFilter=function(){this._filterInfo.filterItems=[];this._cacheInvalidated=!0;return this};d.prototype.clearParams=function(){this._params={};this._cacheInvalidated=!0;return this};d.prototype._clearCache=function(){this._dataCache&&(this._dataCache.destroy(),this._dataCache=null);this._resetCacheInvalidated()};d.prototype._getCache=function(){this._dataCache||
(this._dataCache=new C(this));return this._dataCache};d.prototype._reindexCache=function(){this._dataCache&&this._dataCache.reindexCache()};d.prototype._isPageCached=function(a){return!this._dataCache?!1:this._dataCache.hasPage(a)};d.prototype._resetCacheInvalidated=function(){this._cacheInvalidated=!1};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._clearCache(),c.prototype.destroy.call(this))};d.prototype.toString=function(){return"DataQuery"};Object.defineProperty(d.prototype,
"_queryInfo",{get:function(){return this.__queryInfo},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"_serverTimezone",{get:function(){return this._dbSet.dbContext.serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"entityType",{get:function(){return this._dbSet.entityType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dbSet",{get:function(){return this._dbSet},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"dbSetName",{get:function(){return this._dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"queryName",{get:function(){return this.__queryInfo.methodName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"filterInfo",{get:function(){return this._filterInfo},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sortInfo",{get:function(){return this._sortInfo},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isIncludeTotalCount",
{get:function(){return this._isIncludeTotalCount},set:function(a){this._isIncludeTotalCount=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isClearPrevData",{get:function(){return this._isClearPrevData},set:function(a){this._isClearPrevData=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pageSize",{get:function(){return this._pageSize},set:function(a){this._pageSize!=a&&(this._pageSize=a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"pageIndex",{get:function(){return this._pageIndex},set:function(a){this._pageIndex!=a&&(this._pageIndex=a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"params",{get:function(){return this._params},set:function(a){this._params!==a&&(this._params=a,this._cacheInvalidated=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isPagingEnabled",{get:function(){return this._dbSet.isPagingEnabled},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"loadPageCount",{get:function(){return this._loadPageCount},set:function(a){1>a&&(a=1);this._loadPageCount!=a&&(this._loadPageCount=a,1===a&&this._clearCache(),this.raisePropertyChanged("loadPageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isClearCacheOnEveryLoad",{get:function(){return this._isClearCacheOnEveryLoad},set:function(a){this._isClearCacheOnEveryLoad!=a&&(this._isClearCacheOnEveryLoad=a,this.raisePropertyChanged("isClearCacheOnEveryLoad"))},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"isCacheValid",{get:function(){return!!this._dataCache&&!this._cacheInvalidated},enumerable:!0,configurable:!0});return d}(a.BaseObject);k.DataQuery=D;var y=function(d){function h(a,b,e){this.__dbSet=a;d.call(this);this.__changeType=c.NONE;this.__isCached=this.__isRefreshing=!1;this._saveChangeType=this._origVals=this._srvRowKey=null;this.getFieldNames().forEach(function(a){this._vals[a]=null},this);this._initRowInfo(b,e)}__extends(h,d);h.prototype._updateKeys=
function(a){this._key=this._srvRowKey=a};h.prototype._initRowInfo=function(c,d){if(c){var h=this,m=h._serverTimezone;this._key=this._srvRowKey=c.key;c.values.forEach(function(c,n){var f=d[n],g=h.getFieldInfo(f);if(!g)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,h._dbSetName,f));f=b.parseValue(c,g.dataType,g.dateConversion,m);h._vals[g.fieldName]=f})}};h.prototype._checkCanRefresh=function(){if(null===this._key||this._changeType===c.ADDED)throw Error(a.ERRS.ERR_OPER_REFRESH_INVALID);};h.prototype._refreshValue=
function(c,d,h){var m=this.getFieldInfo(d);if(!m)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this._dbSetName,d));var f,g,s=m.dataType;c=b.parseValue(c,s,m.dateConversion,this._serverTimezone);f=this._vals[d];switch(h){case 3:b.compareVals(c,f,s)||(this._vals[d]=c,this._onFieldChanged(m));break;case 1:this._origVals&&(this._origVals[d]=c);this._saveVals&&(this._saveVals[d]=c);b.compareVals(c,f,s)||(this._vals[d]=c,this._onFieldChanged(m));break;case 2:this._origVals&&(g=this._origVals[d],
this._origVals[d]=c);if((void 0===g||b.compareVals(g,f,s))&&!b.compareVals(c,f,s))this._vals[d]=c,this._onFieldChanged(m);break;default:throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"refreshMode",h));}};h.prototype._refreshValues=function(a,b){var d=this,e=this._changeType;this._isDestroyed||(b||(b=1),a.values.forEach(function(a){4===(a.flags&4)&&d._refreshValue(a.val,a.fieldName,b)}),e===c.UPDATED&&0===this._getStrValues(!0).length&&(this._origVals=null,this._changeType=c.NONE))};h.prototype._onFieldChanged=
function(a){var b=this;this.raisePropertyChanged(a.fieldName);a.dependents&&0<a.dependents.length&&a.dependents.forEach(function(a){b.raisePropertyChanged(a)})};h.prototype._getStrValues=function(a){var b=this,c=this.getFieldNames(),d=this._dbSet;return c.map(function(a){var c=b.getFieldInfo(a);if(c.isClientOnly)return null;var n=d._getStrValue(b._vals[a],c),e=null===b._origVals?n:d._getStrValue(b._origVals[a],c);return e!==n?{val:n,orig:e,fieldName:a,flags:3}:0<c.isPrimaryKey||c.isRowTimeStamp||
c.isNeedOriginal?{val:n,orig:e,fieldName:a,flags:2}:{val:null,orig:null,fieldName:a,flags:0}}).filter(function(b){return!b?!1:a?1===(b.flags&1):!0})};h.prototype._getRowInfo=function(){return{values:this._getStrValues(!1),changeType:this._changeType,serverKey:this._srvKey,clientKey:this._key,error:null}};h.prototype._fldChanging=function(a,b,c){this._origVals||(this._origVals=e.shallowCopy(this._vals));return!0};h.prototype._fldChanged=function(a,b,d){if(!a.isClientOnly)switch(this._changeType){case c.NONE:this._changeType=
c.UPDATED}this._onFieldChanged(a);return!0};h.prototype._clearFieldVal=function(a){this._vals[a]=null};h.prototype._skipValidate=function(a,b){var c=this._dbSet._getChildToParentNames(a.fieldName),d=!1;if(c&&null===b)for(var e=0,h=c.length;e<h&&!(d=!!this._getFieldVal(c[e]));e+=1);return d};h.prototype._getFieldVal=function(a){return this._vals[a]};h.prototype._setFieldVal=function(b,c){var d,h=this._dbSetName,m=this._collection,f=a.ERRS,g=this._vals[b],s=c,k=this.getFieldInfo(b);if(!k)throw Error(e.format(f.ERR_DBSET_INVALID_FIELDNAME,
h,b));!this._isEditing&&!this._isUpdating&&this.beginEdit();try{if(s=this._checkVal(k,s),g!=s&&this._fldChanging(k,g,s)&&(this._vals[b]=s,this._fldChanged(k,g,s)),m._removeError(this,b),d=this._validateField(b))throw new l([d],this);}catch(x){throw d=x instanceof l?x:new l([{fieldName:b,errors:[x.message]}],this),m._addError(this,b,d.errors[0].errors),d;}return!0};h.prototype._onAttaching=function(){d.prototype._onAttaching.call(this);this.__changeType=c.ADDED};h.prototype._onAttach=function(){d.prototype._onAttach.call(this);
if(null===this._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);this._dbSet._addToChanged(this)};h.prototype._beginEdit=function(){if(!d.prototype._beginEdit.call(this))return!1;this._saveChangeType=this._changeType;return!0};h.prototype._endEdit=function(){if(!d.prototype._endEdit.call(this))return!1;this._saveChangeType=null;return!0};h.prototype.deleteItem=function(){return this.deleteOnSubmit()};h.prototype.deleteOnSubmit=function(){var a=this._changeType,b=this._dbSet;if(!b._onItemDeleting(this)||
null===this._key)return!1;if(a===c.ADDED)return b.removeItem(this),!0;this._changeType=c.DELETED;return!0};h.prototype.acceptChanges=function(a){var b=this._changeType,d=this._dbSet;null!==this._key&&b!==c.NONE&&(d._onCommitChanges(this,!0,!1,b),b===c.DELETED?d.removeItem(this):(this._origVals=null,this._saveVals&&(this._saveVals=e.shallowCopy(this._vals)),this._changeType=c.NONE,d._removeAllErrors(this),a&&this._refreshValues(a,3),d._onCommitChanges(this,!1,!1,b)))};h.prototype.rejectChanges=function(){var a=
this,b=this._changeType,d=this._dbSet;if(null!==this._key&&b!==c.NONE)if(d._onCommitChanges(this,!0,!0,b),b===c.ADDED)d.removeItem(this);else{var h=this._getStrValues(!0);this._origVals&&(this._vals=e.shallowCopy(this._origVals),this._origVals=null,this._saveVals&&(this._saveVals=e.shallowCopy(this._vals)));this._changeType=c.NONE;d._removeAllErrors(this);h.forEach(function(b){a._onFieldChanged(d.getFieldInfo(b.fieldName))});d._onCommitChanges(this,!1,!0,b)}};h.prototype.submitChanges=function(){var a=
this.getDbContext(),b=e.uuid();a.addOnSubmitError(function(a,b){b.error instanceof k.SubmitError&&0<b.error.notValidated.length&&(b.isHandled=!0)},b);var c=a.submitChanges();c.always(function(){a.removeOnSubmitError(b)});return c};h.prototype.refresh=function(){return this._dbSet.dbContext._refreshItem(this)};h.prototype.cancelEdit=function(){if(!this._isEditing)return!1;var a=this,b=this._getStrValues(!0),c=this._isNew,d=this._dbSet;this._isEditing=!1;this._vals=this._saveVals;this._saveVals=null;
this._changeType=this._saveChangeType;this._saveChangeType=null;d._removeAllErrors(this);b.forEach(function(b){a.raisePropertyChanged(b.fieldName)});c&&this._notEdited&&d.removeItem(this);d._onEditing(this,!1,!0);this.raisePropertyChanged("isEditing");return!0};h.prototype.getDbContext=function(){return this.__dbSet.dbContext};h.prototype.getDbSet=function(){return this.__dbSet};h.prototype.toString=function(){return"Entity"};h.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._saveChangeType=this._origVals=this._srvRowKey=this.__dbSet=null,this.__isCached=this.__isRefreshing=!1,d.prototype.destroy.call(this))};Object.defineProperty(h.prototype,"_isCanSubmit",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_changeType",{get:function(){return this.__changeType},set:function(a){if(this.__changeType!==a){var b=this.__changeType;this.__changeType=a;a!==c.NONE?this._dbSet._addToChanged(this):this._dbSet._removeFromChanged(this._key);
this._dbSet._onItemStatusChanged(this,b)}},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_isNew",{get:function(){return this.__changeType===c.ADDED},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_isDeleted",{get:function(){return this.__changeType===c.DELETED},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_entityType",{get:function(){return this.__dbSet.entityType},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_srvKey",
{get:function(){return this._srvRowKey},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_dbSetName",{get:function(){return this.__dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_serverTimezone",{get:function(){return this.getDbContext().serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_collection",{get:function(){return this.__dbSet},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_dbSet",
{get:function(){return this.__dbSet},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_isRefreshing",{get:function(){return this.__isRefreshing},set:function(a){this.__isRefreshing!==a&&(this.__isRefreshing=a,this.raisePropertyChanged("_isRefreshing"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_isCached",{get:function(){return this.__isCached},set:function(a){this.__isCached=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isHasChanges",
{get:function(){return this.__changeType!==c.NONE},enumerable:!0,configurable:!0});return h}(r.collection.CollectionItem);k.Entity=y;y=function(h){function m(a){h.call(this);var b=a.dbSetInfo;this._dbContext=a.dbContext;this._options.dbSetName=b.dbSetName;this._options.enablePaging=b.enablePaging;this._options.pageSize=b.pageSize;this._entityType=this._query=null;this._isSubmitOnDelete=!1;this._navfldMap={};this._calcfldMap={};this._trackAssoc={};this._trackAssocMap={};this._childAssocMap={};this._parentAssocMap=
{};this._changeCount=0;this._changeCache={};this._ignorePageChanged=!1;Object.freeze(this._perms)}__extends(m,h);m.prototype.getFieldInfo=function(b){var c,d=b.split(".");if(1==d.length)return this._fieldMap[b];if(1<d.length&&(c=this._childAssocMap[d[0]]))return c=this.dbContext.getDbSet(c.parentDbSetName),b=d.slice(1).join("."),c.getFieldInfo(b);throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,b));};m.prototype._onError=function(a,b){return this.dbContext._onError(a,b)};m.prototype._mapAssocFields=
function(){for(var a=this._trackAssoc,b,c=Object.keys(a),d,h=this._trackAssocMap,m=0,f=c.length;m<f;m+=1){b=a[c[m]];for(var g=0,s=b.fieldRels.length;g<s;g+=1)d=b.fieldRels[g],e.check.isArray(h[d.childField])?h[d.childField].push(b.childToParentName):h[d.childField]=[b.childToParentName]}};m.prototype._updatePermissions=function(a){this._perms=a};m.prototype._getChildToParentNames=function(a){return this._trackAssocMap[a]};m.prototype._getStrValue=function(a,c){return b.stringifyValue(a,c.dateConversion,
this.dbContext.serverTimezone)};m.prototype._doNavigationField=function(b,c){var d=this,h=!0,m={getFunc:function(){throw Error("Function is not implemented");},setFunc:function(a){throw Error("Function is not implemented");}},f=b.childAssoc.filter(function(a){return a.childToParentName==c.fieldName});0===f.length&&(f=b.parentAssoc.filter(function(a){return a.parentToChildrenName==c.fieldName}),h=!1);if(1!=f.length)throw Error(e.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"assocs","Array"));var g=f[0].name;
c.isClientOnly=!0;c.isReadOnly=!0;h?(c.isReadOnly=!1,d._childAssocMap[f[0].childToParentName]=f[0],f[0].fieldRels.forEach(function(a){a=d._fieldMap[a.childField];!c.isReadOnly&&a.isReadOnly&&(c.isReadOnly=!0)}),m.getFunc=function(){return d.dbContext.getAssociation(g).getParentItem(this)},c.isReadOnly||(d._trackAssoc[g]=f[0],m.setFunc=function(b){var n,h,m=d.dbContext.getAssociation(g);if(b&&!(b instanceof m.parentDS.entityType))throw Error(e.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"value",m.parentDS.dbSetName));
if(b&&b._isNew)this._setFieldVal(c.fieldName,b._key);else if(b){n=0;for(h=m.childFldInfos.length;n<h;n+=1)this[m.childFldInfos[n].fieldName]=b[m.parentFldInfos[n].fieldName]}else{this._getFieldVal(c.fieldName)&&this._setFieldVal(c.fieldName,null);n=0;for(h=m.childFldInfos.length;n<h;n+=1)this[m.childFldInfos[n].fieldName]=null}})):(d._parentAssocMap[f[0].parentToChildrenName]=f[0],m.getFunc=function(){return d.dbContext.getAssociation(g).getChildItems(this)});return m};m.prototype._doCalculatedField=
function(b,c){function d(b){b.dependentOn.split(",").forEach(function(c){var d=h._fieldMap[c];if(!d)throw Error(e.format(a.ERRS.ERR_CALC_FIELD_DEFINE,c));if(b.fieldName===c)throw Error(e.format(a.ERRS.ERR_CALC_FIELD_SELF_DEPEND,c));0>d.dependents.indexOf(b.fieldName)&&d.dependents.push(b.fieldName)})}var h=this;c.isClientOnly=!0;c.isReadOnly=!0;c.dependentOn&&d(c);return{getFunc:function(){throw Error(e.format("Calculated field:'{0}' is not initialized",c.fieldName));}}};m.prototype._fillFromService=
function(b){b=e.extend(!1,{res:{names:[],rows:[],pageIndex:null,pageCount:null,dbSetName:this.dbSetName,totalCount:null},isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,h=b.res,m=h.names,f=h.rows||[],g=this._entityType,s=[],l=[],k=[],x=[],y=this.isPagingEnabled,q=this.query,p=!0,w;this._onFillStart({isBegin:!0,rowCount:f.length,time:new Date,isPageChanged:b.isPageChanged});try{q&&(p=q.isClearPrevData,q.isClearCacheOnEveryLoad&&q._clearCache(),p&&this.clear(),q._reindexCache(),1<q.loadPageCount&&
y&&(w=q._getCache(),q.isIncludeTotalCount&&!e.check.isNt(h.totalCount)&&(w.totalCount=h.totalCount)));k=f.map(function(b){var d=b.key;if(!d)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);var n=c._itemsByKey[d];n?b.values.forEach(function(a,b){n._refreshValue(a,m[b],1)}):(w&&(n=w.getItemByKey(d)),n?b.values.forEach(function(a,b){n._refreshValue(a,m[b],1)}):n=new g(c,b,m));return n});if(q&&(q.isIncludeTotalCount&&!e.check.isNt(h.totalCount)&&(this.totalCount=h.totalCount),1<q.loadPageCount&&y)){w.fillCache(h.pageIndex,
k);var v=w.getCachedPage(q.pageIndex),k=v?v.items:[]}k.forEach(function(a){var b=this._itemsByKey[a._key];b?x.push(b):(this._items.push(a),this._itemsByKey[a._key]=a,s.push(a),l.push(this._items.length-1),x.push(a))},this);0<s.length&&(this._onItemsChanged({change_type:d.ADDED,items:s,pos:l}),this.raisePropertyChanged("count"));b.fn_beforeFillEnd&&b.fn_beforeFillEnd()}finally{this._onFillEnd({isBegin:!1,rowCount:x.length,time:new Date,resetUI:p,fetchedItems:x,newItems:s,isPageChanged:b.isPageChanged})}this.moveFirst();
return{fetchedItems:x,newItems:s,isPageChanged:b.isPageChanged,outOfBandData:b.res.extraInfo}};m.prototype._fillFromCache=function(b){b=e.extend(!1,{isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,h=[],m=[],f=this.query;if(!f)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,"query is not null"));f=f._getCache().getCachedPage(f.pageIndex);f=!f?[]:f.items;this._onFillStart({isBegin:!0,rowCount:f.length,time:new Date,isPageChanged:b.isPageChanged});try{this.clear(),this._items=f,f.forEach(function(a,
b){c._itemsByKey[a._key]=a;h.push(b);m.push(a)}),b.fn_beforeFillEnd&&b.fn_beforeFillEnd(),0<m.length&&(this._onItemsChanged({change_type:d.ADDED,items:m,pos:h}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:m.length,time:new Date,resetUI:!0,fetchedItems:m,newItems:m,isPageChanged:b.isPageChanged})}this.moveFirst();return{fetchedItems:m,newItems:m,isPageChanged:b.isPageChanged,outOfBandData:null}};m.prototype._commitChanges=function(b){var h=this;b.forEach(function(b){var n=
b.clientKey,m=h._itemsByKey[n];if(!m)throw Error(e.format(a.ERRS.ERR_KEY_IS_NOTFOUND,n));var f=m._changeType;m.acceptChanges(b);f===c.ADDED&&(delete h._itemsByKey[n],m._updateKeys(b.serverKey),h._itemsByKey[m._key]=m,h._onItemsChanged({change_type:d.REMAP_KEY,items:[m],old_key:n,new_key:m._key}))})};m.prototype._setItemInvalid=function(a){var b=this._itemsByKey[a.clientKey],c={};a.invalid.forEach(function(a){a.fieldName||(a.fieldName="*");c[a.fieldName]?c[a.fieldName].push(a.message):c[a.fieldName]=
[a.message]});var d=[];e.forEachProp(c,function(a){d.push({fieldName:a,errors:c[a]})});this._addErrors(b,d);return b};m.prototype._setCurrentItem=function(b){if(b&&!(b instanceof this._entityType))throw Error(a.global.utils.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"currentItem",this._options.dbSetName));h.prototype._setCurrentItem.call(this,b)};m.prototype._getChanges=function(){var a=[],b=this._changeCache;e.forEachProp(b,function(c){a.push(b[c]._getRowInfo())});return a};m.prototype._getTrackAssocInfo=
function(){var a=this,b=[],c=this._changeCache,d=Object.keys(a._trackAssoc);e.forEachProp(c,function(e){var h=c[e];d.forEach(function(c){var d=h._getFieldVal(a._trackAssoc[c].childToParentName),e=h._key;d&&e&&b.push({assocName:c,parentKey:d,childKey:e})})});return b};m.prototype._getNewKey=function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};m.prototype._createNew=function(){var a=new this._entityType(this,null,null);a._key=this._getNewKey(a);return a};m.prototype._addToChanged=function(a){null!==
a._key&&!this._changeCache[a._key]&&(this._changeCache[a._key]=a,this._changeCount+=1,1===this._changeCount&&this.raisePropertyChanged("hasChanges"))};m.prototype._removeFromChanged=function(a){null!==a&&this._changeCache[a]&&(delete this._changeCache[a],this._changeCount-=1,0===this._changeCount&&this.raisePropertyChanged("hasChanges"))};m.prototype._clearChangeCache=function(){var a=this._changeCount;this._changeCache={};this._changeCount=0;a!==this._changeCount&&this.raisePropertyChanged("hasChanges")};
m.prototype._onItemStatusChanged=function(a,b){h.prototype._onItemStatusChanged.call(this,a,b);a._isDeleted&&this.isSubmitOnDelete&&this.dbContext.submitChanges()};m.prototype._onRemoved=function(a,b){this._removeFromChanged(a._key);h.prototype._onRemoved.call(this,a,b)};m.prototype._onPageChanging=function(){var a=h.prototype._onPageChanging.call(this);if(!a)return a;this.hasChanges&&this.rejectChanges();return a};m.prototype._onPageChanged=function(){this.cancelEdit();h.prototype._onPageChanged.call(this);
this._ignorePageChanged||(this.query.pageIndex=this.pageIndex,this.dbContext._load(this.query,!0))};m.prototype._onPageSizeChanged=function(){h.prototype._onPageSizeChanged.call(this);this._query&&(this._query.pageSize=this.pageSize)};m.prototype._destroyItems=function(){this._items.forEach(function(a){a._isCached?a.removeHandler(null,null):a.destroy()})};m.prototype.sort=function(a,b){var c=this.query;if(c){c.clearSort();for(var d=0;d<a.length;d+=1)0==d?c.orderBy(a[d],b):c.thenBy(a[d],b);c.isClearPrevData=
!0;c.pageIndex=0;return this.dbContext.load(c)}return h.prototype.sort.call(this,a,b)};m.prototype.fillItems=function(a){a={res:e.extend(!1,{names:[],rows:[],pageIndex:this.query?this.query.pageIndex:null,pageCount:null,dbSetName:this.dbSetName,totalCount:null,rowCount:a.rows.length,extraInfo:null,error:null,included:[]},a),isPageChanged:!1,fn_beforeFillEnd:null};this._fillFromService(a)};m.prototype.defineCalculatedField=function(b,c){var d=this._calcfldMap[b];if(!d)throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,
"fieldName",b));d.getFunc=c};m.prototype.acceptChanges=function(){var a=this._changeCache;e.forEachProp(a,function(b){a[b].acceptChanges(null)});this._changeCount=0};m.prototype.rejectChanges=function(){var a=this._changeCache;e.forEachProp(a,function(b){a[b].rejectChanges()})};m.prototype.deleteOnSubmit=function(a){a.deleteOnSubmit()};m.prototype.clear=function(){this._clearChangeCache();h.prototype.clear.call(this)};m.prototype.createQuery=function(b){var c=this.dbContext._getQueryInfo(b);if(!c)throw Error(e.format(a.ERRS.ERR_QUERY_NAME_NOTFOUND,
b));return new D(this,c)};m.prototype.clearCache=function(){var a=this._query;a&&a._clearCache()};m.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._query;this._query=null;a&&a.destroy();this._navfldMap={};this._calcfldMap={};h.prototype.destroy.call(this)}};m.prototype.toString=function(){return this._options.dbSetName};Object.defineProperty(m.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,
"dbContext",{get:function(){return this._dbContext},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"dbSetName",{get:function(){return this._options.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"entityType",{get:function(){return this._entityType},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"hasChanges",{get:function(){return 0<
this._changeCount},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"cacheSize",{get:function(){var a=this._query;return a&&a.isCacheValid?(a=a._getCache(),a.cacheSize):0},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"isSubmitOnDelete",{get:function(){return this._isSubmitOnDelete},set:function(a){this._isSubmitOnDelete!==a&&(this._isSubmitOnDelete=!!a,this.raisePropertyChanged("isSubmitOnDelete"))},enumerable:!0,configurable:!0});return m}(r.collection.Collection);
k.DbSet=y;y=function(c){function d(){c.call(this);this._isInitialized=!1;this._dbSets={};this._dbSetNames=[];this._arrDbSets=[];this._svcMethods={};this._assoc={};this._arrAssoc=[];this._queryInf={};this._serviceUrl=null;this._isBusy=0;this._hasChanges=this._isSubmiting=!1;this._pendingSubmit=null;this._serverTimezone=e.get_timeZoneOffset();this._waitQueue=new a.MOD.utils.WaitQueue(this)}__extends(d,c);d.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["submit_error"].concat(a)};
d.prototype.addOnSubmitError=function(a,b){this.addHandler("submit_error",a,b)};d.prototype.removeOnSubmitError=function(a){this.removeHandler("submit_error",a)};d.prototype._onGetCalcField=function(a){this.raiseEvent("define_calc",a)};d.prototype._getQueryInfo=function(a){return this._queryInf[a]};d.prototype._createDbSets=function(){var a=this;this._dbSetNames.forEach(function(b){b=a._dbSets[b];a._arrDbSets.push(b);b.addOnPropertyChange("hasChanges",function(b,c){a._onDbSetHasChangesChanged(b)},
null)});Object.freeze(this._dbSets)};d.prototype._initDbSets=function(){if(this._isInitialized)throw Error(a.ERRS.ERR_DOMAIN_CONTEXT_INITIALIZED);this._createDbSets()};d.prototype._initAssociations=function(a){var b=this;a.forEach(function(a){b._initAssociation(a)})};d.prototype._initMethods=function(a){var b=this;a.forEach(function(a){a.isQuery?b._queryInf[a.methodName]=a:b._initMethod(a)})};d.prototype._updatePermissions=function(a){var b=this;this._serverTimezone=a.serverTimezone;a.permissions.forEach(function(a){b.getDbSet(a.dbSetName)._updatePermissions(a)})};
d.prototype._onDbSetHasChangesChanged=function(a){var b=this._hasChanges;this._hasChanges=!1;if(a.hasChanges)this._hasChanges=!0;else for(var c=0,d=this._arrDbSets.length;c<d;c+=1)if(a=this._arrDbSets[c],a.hasChanges){this._hasChanges=!0;break}this._hasChanges!==b&&this.raisePropertyChanged("hasChanges")};d.prototype._initAssociation=function(a){var b=this,c={dbContext:b,parentName:a.parentDbSetName,childName:a.childDbSetName,onDeleteAction:a.onDeleteAction,parentKeyFields:a.fieldRels.map(function(a){return a.parentField}),
childKeyFields:a.fieldRels.map(function(a){return a.childField}),parentToChildrenName:a.parentToChildrenName,childToParentName:a.childToParentName,name:a.name},d="get"+a.name;this._assoc[d]=function(){var a=new m(c);b._arrAssoc.push(a);b._assoc[d]=function(){return a};return a}};d.prototype._initMethod=function(b){var c=this;this._svcMethods[b.methodName]=function(d){var h=e.createDeferred(),m=function(a){a.error?h.reject():h.resolve(a.result)};try{var f=c._getMethodParams(b,d);c._invokeMethod(b,
f,m)}catch(g){a.global._checkIsDummy(g)||(c._onError(g,c),m({result:null,error:g}))}return h.promise()}};d.prototype._getMethodParams=function(c,d){var h=this,m={methodName:c.methodName,paramInfo:{parameters:[]}},g,l=c.parameters,s=l.length,k,x,q;d||(d={});for(g=0;g<s;g+=1){k=l[g];x=d[k.name];if(!k.isNullable&&!k.isArray&&k.dataType!==f.DATA_TYPE.String&&e.check.isNt(x))throw Error(e.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,k.name,x,c.methodName));if(e.check.isFunction(x))throw Error(e.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,
k.name,x,c.methodName));k.isArray&&(!e.check.isNt(x)&&!e.check.isArray(x))&&(x=[x]);q=null;e.check.isArray(x)?(q=[],x.forEach(function(a){q.push(b.stringifyValue(a,k.dateConversion,h._serverTimezone))}),q=JSON.stringify(q)):q=b.stringifyValue(x,k.dateConversion,h._serverTimezone);m.paramInfo.parameters.push({name:k.name,value:q})}return m};d.prototype._invokeMethod=function(b,c,d){var h=this,m,f;this.isBusy=!0;var g=function(b){try{if(!b)throw Error(e.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,"operation result is undefined"));
q(b.error,"invoke");d({result:b.result,error:null})}catch(c){a.global._checkIsDummy(c)||(h._onDataOperError(c,"invoke"),d({result:null,error:c}))}};try{m=JSON.stringify(c),f=this._getUrl("InvokeMethod"),e.performAjaxCall(f,m,!0,function(a){g(JSON.parse(a));h.isBusy=!1},function(a){g({result:null,error:a});h.isBusy=!1},null)}catch(l){a.global._checkIsDummy(l)&&a.global._throwDummy(l),this.isBusy=!1,this._onDataOperError(l,"invoke"),d({result:null,error:l}),a.global._throwDummy(l)}};d.prototype._loadFromCache=
function(b,c){var d=b._dbSet,e;try{e=d._fillFromCache({isPageChanged:c,fn_beforeFillEnd:null})}catch(h){a.global._checkIsDummy(h)&&a.global._throwDummy(h),this._onDataOperError(h,"load"),a.global._throwDummy(h)}return e};d.prototype._loadIncluded=function(a){var b=this;a.included&&0<a.included.length&&a.included.forEach(function(a){b.getDbSet(a.dbSetName).fillItems(a)})};d.prototype._onLoaded=function(b,c){var d=this,h,m,f;try{if(!b)throw Error(e.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,"null result"));
h=b.dbSetName;m=d.getDbSet(h);if(!m)throw Error(e.format(a.ERRS.ERR_DBSET_NAME_INVALID,h));q(b.error,"load");f=m._fillFromService({res:b,isPageChanged:c,fn_beforeFillEnd:function(){d._loadIncluded(b)}})}catch(g){a.global._checkIsDummy(g)&&a.global._throwDummy(g),this._onDataOperError(g,"load"),a.global._throwDummy(g)}return f};d.prototype._dataSaved=function(b){var c=this,d=[],h=[];try{try{q(b.error,g)}catch(m){throw b.dbSets.forEach(function(b){var n=c._dbSets[b.dbSetName];b.rows.forEach(function(b){var c=
n.getItemByKey(b.clientKey);if(!c)throw Error(e.format(a.ERRS.ERR_KEY_IS_NOTFOUND,b.clientKey));d.push(c);b.invalid&&(n._setItemInvalid(b),h.push(c))})}),new B(m,d,h);}b.dbSets.forEach(function(a){c._dbSets[a.dbSetName]._commitChanges(a.rows)})}catch(f){a.global._checkIsDummy(f)&&a.global._throwDummy(f),this._onSubmitError(f),a.global._throwDummy(f)}};d.prototype._getChanges=function(){var a={dbSets:[],error:null,trackAssocs:[]};this._arrDbSets.forEach(function(b){b.endEdit();var c=b._getChanges();
if(0!==c.length){var d=b._getTrackAssocInfo();a.dbSets.push({dbSetName:b.dbSetName,rows:c});a.trackAssocs=a.trackAssocs.concat(d)}});return a};d.prototype._getUrl=function(a){var b=this.service_url;e.str.endsWith(b,"/")||(b+="/");return b+=[a,""].join("/")};d.prototype._onItemRefreshed=function(b,c){try{if(q(b.error,"refresh"),b.rowInfo)c._refreshValues(b.rowInfo,2);else throw c._dbSet.removeItem(c),c.destroy(),Error(a.ERRS.ERR_ITEM_DELETED_BY_ANOTHER_USER);}catch(d){a.global._checkIsDummy(d)&&a.global._throwDummy(d),
this._onDataOperError(d,"refresh"),a.global._throwDummy(d)}};d.prototype._refreshItem=function(a){var b=e.createDeferred(),c=function(c){c?b.resolve(a):b.reject()},d=this._getUrl("RefreshItem"),h=a._dbSet,m=this;this.waitForNotSubmiting(function(){h.waitForNotLoading(function(){var b,f=function(){m.isBusy=!1;h.isLoading=!1;a._isRefreshing=!1},g=function(a){f();m._onDataOperError(a,"refresh")};a._isRefreshing=!0;m.isBusy=!0;h.isLoading=!0;try{var l={dbSetName:a._dbSetName,rowInfo:a._getRowInfo(),error:null};
a._checkCanRefresh();b=JSON.stringify(l);e.performAjaxCall(d,b,!0,function(b){try{var d=JSON.parse(b);m._onItemRefreshed(d,a);f();c(!0)}catch(h){g(h),c(!1)}},function(a){f();m._onDataOperError(a,"refresh");c(!1)},null)}catch(s){g(s),c(!1)}},[],!0,null)},[],null);return b.promise()};d.prototype._onError=function(b,d){var h=c.prototype._onError.call(this,b,d);return!h?a.global._onError(b,d):h};d.prototype._onDataOperError=function(b,c){if(a.global._checkIsDummy(b))return!0;var d;d=b instanceof v?b:
new v(b,c);return this._onError(d,this)};d.prototype._onSubmitError=function(a){var b={error:a,isHandled:!1};this.raiseEvent("submit_error",b);b.isHandled||(this.rejectChanges(),this._onDataOperError(a,g))};d.prototype._beforeLoad=function(a,b,c){a&&b!==a&&(c._query=a,c.pageIndex=0);b&&b!==a&&b.destroy();if(a.pageSize!==c.pageSize){c._ignorePageChanged=!0;try{c.pageIndex=0,c.pageSize=a.pageSize}finally{c._ignorePageChanged=!1}}if(a.pageIndex!==c.pageIndex){c._ignorePageChanged=!0;try{c.pageIndex=
a.pageIndex}finally{c._ignorePageChanged=!1}}a.isCacheValid||a._clearCache()};d.prototype._load=function(b,c){if(!b)throw Error(a.ERRS.ERR_DB_LOAD_NO_QUERY);var d=this,h=e.createDeferred(),m=b.loadPageCount,f=b.pageIndex,g=b.isPagingEnabled,l=b.dbSetName,s=this.getDbSet(l);this.waitForNotSubmiting(function(){s.waitForNotLoading(function(){var k=s.query,x=d._getUrl("GetItems"),q,y,p=function(){s.isLoading=!1;d.isBusy=!1},w=function(a){p();h.resolve(a)},v=function(a){p();d._onDataOperError(a,"load");
h.reject()},r,z,D=1;s.isLoading=!0;d.isBusy=!0;try{b.pageIndex=f;d._beforeLoad(b,k,s);if(1<m&&g){if(b._isPageCached(f)){r=d._loadFromCache(b,c);w(r);return}z=b._getCache().getNextRange(f);f=z.start;D=z.cnt}q={dbSetName:l,pageIndex:f,pageSize:b.pageSize,pageCount:D,isIncludeTotalCount:b.isIncludeTotalCount,filterInfo:b.filterInfo,sortInfo:b.sortInfo,paramInfo:d._getMethodParams(b._queryInfo,b.params).paramInfo,queryName:b.queryName};y=JSON.stringify(q);e.performAjaxCall(x,y,!0,function(b){var n=[],
h;try{h=b.indexOf(a.MOD.consts.CHUNK_SEP),-1<h?(n.push(b.substr(0,h)),n.push(b.substr(h+a.MOD.consts.CHUNK_SEP.length))):n.push(b),n=n.map(function(a){return JSON.parse(a)}),setTimeout(function(){var b,h=n[0],m=!!h.included&&0<h.included.length;try{if(1<n.length&&(b=n[1])&&0<b.length)if(m&&h.included.forEach(function(c){c.rows=b.splice(0,c.rowCount);if(c.rowCount!=c.rows.length)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,"subset.rowCount == subset.rows.length"));}),h.rows=b,h.rowCount!=h.rows.length)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,
"getDataResult.rowCount == getDataResult.rows.length"));r=d._onLoaded(h,c);w(r)}catch(f){v(f)}},0)}catch(m){v(m)}},function(a){p();d._onDataOperError(a,"load");h.reject()},null)}catch(t){v(t)}},[],!0,c?"paging":null)},[],c?"paging":null);return h.promise()};d.prototype.getDbSet=function(b){var c=this._dbSets[b];if(!c)throw Error(e.format(a.ERRS.ERR_DBSET_NAME_INVALID,b));return c};d.prototype.getAssociation=function(b){var c=this._assoc["get"+b];if(!c)throw Error(e.format(a.ERRS.ERR_ASSOC_NAME_INVALID,
b));return c()};d.prototype.submitChanges=function(){if(this._pendingSubmit)return this._pendingSubmit.deferred.promise();var a=this,b={deferred:e.createDeferred()},c=function(a){a?b.deferred.resolve():b.deferred.reject()};this._pendingSubmit=b;this.waitForNotBusy(function(){var b,d,h=g,m,f=function(){a.isBusy=!1;a.isSubmiting=!1},l=function(b){f();a._onDataOperError(b,h);c(!1)};try{if(a.isBusy=!0,a.isSubmiting=!0,a._pendingSubmit=null,b=a._getUrl("SaveChanges"),m=a._getChanges(),0===m.dbSets.length){f();
c(!0);return}}catch(s){l(s);return}try{d=JSON.stringify(m),e.performAjaxCall(b,d,!0,function(b){try{a._dataSaved(JSON.parse(b)),f(),c(!0)}catch(d){l(d)}},function(b){f();a._onSubmitError(b);c(!1)},null)}catch(k){l(k)}},[]);return b.deferred.promise()};d.prototype.load=function(a){return this._load(a,!1)};d.prototype.acceptChanges=function(){this._arrDbSets.forEach(function(a){a.acceptChanges()})};d.prototype.rejectChanges=function(){this._arrDbSets.forEach(function(a){a.rejectChanges()})};d.prototype.initialize=
function(b){if(!this._isInitialized){var c=this;b=e.extend(!1,{serviceUrl:null,permissions:null},b);this._serviceUrl=b.serviceUrl;this._initDbSets();if(b.permissions)c._updatePermissions(b.permissions),c._isInitialized=!0,c.raisePropertyChanged("isInitialized");else{b=this._getUrl("GetPermissions");try{this.isBusy=!0,e.performAjaxCall(b,void 0,!0,function(b){try{c._updatePermissions(JSON.parse(b)),c.isBusy=!1,c._isInitialized=!0,c.raisePropertyChanged("isInitialized")}catch(d){c.isBusy=!1,c._onDataOperError(d,
"initDbContext"),a.global._throwDummy(d)}},function(a){c.isBusy=!1;c._onDataOperError(a,"initDbContext")},null)}catch(d){this.isBusy=!1,this._onDataOperError(d,"initDbContext"),a.global._throwDummy(d)}}}};d.prototype.waitForNotBusy=function(a,b){this._waitQueue.enQueue({prop:"isBusy",groupName:null,predicate:function(a){return!a},action:a,actionArgs:b})};d.prototype.waitForNotSubmiting=function(a,b,c){this._waitQueue.enQueue({prop:"isSubmiting",predicate:function(a){return!a},action:a,actionArgs:b,
groupName:c,lastWins:!!c})};d.prototype.waitForInitialized=function(a,b){this._waitQueue.enQueue({prop:"isInitialized",groupName:"dbContext",predicate:function(a){return!!a},action:a,actionArgs:b})};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),this._waitQueue=null,this._arrAssoc.forEach(function(a){a.destroy()}),this._arrAssoc=[],this._assoc={},this._arrDbSets.forEach(function(a){a.destroy()}),this._arrDbSets=[],this._dbSets={},this._svcMethods=
{},this._queryInf={},this._serviceUrl=null,this._isInitialized=!1,this._isBusy=0,this._hasChanges=this._isSubmiting=!1,c.prototype.destroy.call(this))};Object.defineProperty(d.prototype,"service_url",{get:function(){return this._serviceUrl},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isBusy",{get:function(){return 0<this._isBusy},set:function(a){var b=
0<this._isBusy;a?this._isBusy+=1:(this._isBusy-=1,0>this._isBusy&&(this._isBusy=0));0<this._isBusy!=b&&this.raisePropertyChanged("isBusy")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSubmiting",{get:function(){return this._isSubmiting},set:function(a){this._isSubmiting!==a&&(this._isSubmiting=a,this.raisePropertyChanged("isSubmiting"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"serverTimezone",{get:function(){return this._serverTimezone},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"dbSets",{get:function(){return this._dbSets},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"arrDbSets",{get:function(){return this._arrDbSets},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"serviceMethods",{get:function(){return this._svcMethods},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasChanges",{get:function(){return this._hasChanges},enumerable:!0,configurable:!0});return d}(a.BaseObject);
k.DbContext=y;var m=function(b){function h(a){b.call(this);var c=this;this._objId="ass"+e.getNewID();a=e.extend(!1,{dbContext:null,parentName:"",childName:"",parentKeyFields:[],childKeyFields:[],parentToChildrenName:null,childToParentName:null,name:this._objId,onDeleteAction:w.NoAction},a);this._name=a.name;this._dbContext=a.dbContext;this._onDeleteAction=a.onDeleteAction;this._parentDS=a.dbContext.dbSets[a.parentName];this._childDS=a.dbContext.dbSets[a.childName];this._parentFldInfos=a.parentKeyFields.map(function(a){return c._parentDS.getFieldInfo(a)});
this._childFldInfos=a.childKeyFields.map(function(a){return c._childDS.getFieldInfo(a)});this._parentToChildrenName=a.parentToChildrenName;this._childToParentName=a.childToParentName;this._parentMap={};this._childMap={};this._isChildFilling=this._isParentFilling=!1;this._bindParentDS();a=this._mapParentItems(this._parentDS.items);this._bindChildDS();var d=this._mapChildren(this._childDS.items);this._changedTimeout=this._saveChildFKey=this._saveParentFKey=null;this._changed={};c._notifyParentChanged(a);
c._notifyChildrenChanged(d)}__extends(h,b);h.prototype._onError=function(c,d){var h=b.prototype._onError.call(this,c,d);return!h?a.global._onError(c,d):h};h.prototype._bindParentDS=function(){var a=this,b=this._parentDS;b&&(b._addHandler("coll_changed",function(c,d){b===c&&a._onParentCollChanged(d)},a._objId,!0),b._addHandler("fill",function(c,d){b===c&&a._onParentFill(d)},a._objId,!0),b._addHandler("begin_edit",function(c,d){b===c&&a._onParentEdit(d.item,!0,void 0)},a._objId,!0),b._addHandler("end_edit",
function(c,d){b===c&&a._onParentEdit(d.item,!1,d.isCanceled)},a._objId,!0),b._addHandler("item_deleting",function(a,b){},a._objId,!0),b._addHandler("status_changed",function(c,d){b===c&&a._onParentStatusChanged(d.item,d.oldChangeType)},a._objId,!0),b._addHandler("commit_changes",function(c,d){b===c&&a._onParentCommitChanges(d.item,d.isBegin,d.isRejected,d.changeType)},a._objId,!0))};h.prototype._bindChildDS=function(){var a=this,b=this._childDS;b&&(b._addHandler("coll_changed",function(c,d){b===c&&
a._onChildCollChanged(d)},a._objId,!0),b._addHandler("fill",function(c,d){b===c&&a._onChildFill(d)},a._objId,!0),b._addHandler("begin_edit",function(c,d){b===c&&a._onChildEdit(d.item,!0,void 0)},a._objId,!0),b._addHandler("end_edit",function(c,d){b===c&&a._onChildEdit(d.item,!1,d.isCanceled)},a._objId,!0),b._addHandler("status_changed",function(c,d){b===c&&a._onChildStatusChanged(d.item,d.oldChangeType)},a._objId,!0),b._addHandler("commit_changes",function(c,d){b===c&&a._onChildCommitChanges(d.item,
d.isBegin,d.isRejected,d.changeType)},a._objId,!0))};h.prototype._onParentCollChanged=function(b){var c=this,h;h=b.items;var m=[],f={};switch(b.change_type){case d.RESET:c._isParentFilling||(m=c.refreshParentMap());break;case d.ADDED:this._isParentFilling||(m=c._mapParentItems(h));break;case d.REMOVE:h.forEach(function(a){(a=c._unMapParentItem(a))&&(f[a]=null)});m=Object.keys(f);break;case d.REMAP_KEY:if(b.old_key&&(h=this._parentMap[b.old_key]))delete this._parentMap[b.old_key],m=this._mapParentItems([h]);
break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}c._notifyParentChanged(m)};h.prototype._onParentFill=function(a){a.isBegin?this._isParentFilling=!0:(this._isParentFilling=!1,a=a.resetUI?this.refreshParentMap():this._mapParentItems(a.newItems),this._notifyParentChanged(a))};h.prototype._onParentEdit=function(a,b,c){b?this._storeParentFKey(a):c?this._saveParentFKey=null:this._checkParentFKey(a)};h.prototype._onParentCommitChanges=function(a,b,d,h){b?d&&h===
c.ADDED?(a=this._unMapParentItem(a))&&this._notifyParentChanged([a]):!d&&h===c.DELETED?(a=this._unMapParentItem(a))&&this._notifyParentChanged([a]):this._storeParentFKey(a):this._checkParentFKey(a)};h.prototype._storeParentFKey=function(a){a=this.getParentFKey(a);null!==a&&this._parentMap[a]&&(this._saveParentFKey=a)};h.prototype._checkParentFKey=function(a){var b,c=this._saveParentFKey;this._saveParentFKey=null;b=this.getParentFKey(a);b!==c&&(c&&(delete this._parentMap[c],this._notifyChildrenChanged([c]),
this._notifyParentChanged([c])),b&&(this._mapParentItems([a]),this._notifyChildrenChanged([b]),this._notifyParentChanged([b])))};h.prototype._onParentStatusChanged=function(a,b){var d=this,h,e,m=w;if(a._changeType===c.DELETED){e=d.getChildItems(a);h=this._unMapParentItem(a);switch(d.onDeleteAction){case m.Cascade:e.forEach(function(a){a.deleteItem()});break;case m.SetNulls:e.forEach(function(a){var b=a.isEditing;b||a.beginEdit();try{d._childFldInfos.forEach(function(b){a[b.fieldName]=null}),b||a.endEdit()}finally{b||
a.cancelEdit()}})}h&&d._notifyParentChanged([h])}};h.prototype._onChildCollChanged=function(b){var c=this,h=b.items,m=[],f={};switch(b.change_type){case d.RESET:c._isChildFilling||(m=c.refreshChildMap());break;case d.ADDED:this._isChildFilling||(m=c._mapChildren(h));break;case d.REMOVE:h.forEach(function(a){(a=c._unMapChildItem(a))&&(f[a]=null)});m=Object.keys(f);break;case d.REMAP_KEY:if(b.old_key&&(b=h[0])){if(m=b._getFieldVal(this._childToParentName))delete this._childMap[m],b._clearFieldVal(this._childToParentName);
m=this._mapChildren([b])}break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}c._notifyChildrenChanged(m)};h.prototype._notifyChildrenChanged=function(a){this._notifyChanged([],a)};h.prototype._notifyParentChanged=function(a){this._notifyChanged(a,[])};h.prototype._notifyChanged=function(a,b){var c=this;if(0<a.length||0<b.length)a.forEach(function(a){var b=c._changed[a];c._changed[a]=b?b|1:1}),b.forEach(function(a){var b=c._changed[a];c._changed[a]=b?b|2:2}),
this._changedTimeout||(this._changedTimeout=setTimeout(function(){if(!c._isDestroyCalled){c._changedTimeout=null;var a=c._changed;c._changed={};Object.keys(a).forEach(function(b){var d=a[b];1==(d&1)&&c._onParentChanged(b);2==(d&2)&&c._onChildrenChanged(b)})}},50))};h.prototype._onChildFill=function(a){a.isBegin?this._isChildFilling=!0:(this._isChildFilling=!1,a=a.resetUI?this.refreshChildMap():this._mapChildren(a.newItems),this._notifyChildrenChanged(a))};h.prototype._onChildEdit=function(a,b,c){b?
this._storeChildFKey(a):c?this._saveChildFKey=null:this._checkChildFKey(a)};h.prototype._onChildCommitChanges=function(a,b,d,h){b?d&&h===c.ADDED?(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):!d&&h===c.DELETED?(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):this._storeChildFKey(a):this._checkChildFKey(a)};h.prototype._storeChildFKey=function(a){var b=this.getChildFKey(a),c;if(b&&(c=this._childMap[b])&&-1<c.indexOf(a))this._saveChildFKey=b};h.prototype._checkChildFKey=
function(a){var b=this._saveChildFKey,c,d;this._saveChildFKey=null;c=this.getChildFKey(a);c!==b&&(b&&(d=this._childMap[b],e.removeFromArray(d,a),0==d.length&&delete this._childMap[b],this._notifyParentChanged([b]),this._notifyChildrenChanged([b])),c&&(this._mapChildren([a]),this._notifyParentChanged([c]),this._notifyChildrenChanged([c])))};h.prototype._onChildStatusChanged=function(a,b){var d=c.DELETED,h=a._changeType,e=this.getChildFKey(a);e&&h===d&&(e=this._unMapChildItem(a))&&this._notifyChildrenChanged([e])};
h.prototype._getItemKey=function(a,b,c){for(var d=[],h,e=0,m=a.length;e<m;e+=1){h=c[a[e].fieldName];h=b._getStrValue(h,a[e]);if(null===h)return null;d.push(h)}return d.join(";")};h.prototype._resetChildMap=function(){var a=Object.keys(this._childMap);this._childMap={};this._notifyChildrenChanged(a)};h.prototype._resetParentMap=function(){var a=Object.keys(this._parentMap);this._parentMap={};this._notifyParentChanged(a)};h.prototype._unMapChildItem=function(a){var b,c,d=null;if(b=this.getChildFKey(a))if(c=
this._childMap[b])a=e.removeFromArray(c,a),-1<a&&(0==c.length&&delete this._childMap[b],d=b);return d};h.prototype._unMapParentItem=function(a){var b=null;if((a=this.getParentFKey(a))&&this._parentMap[a])delete this._parentMap[a],b=a;return b};h.prototype._mapParentItems=function(a){for(var b,d,h=c.DELETED,e,m={},f=0,g=a.length;f<g;f+=1)if(b=a[f],d=b._changeType,d!==h&&(d=this.getParentFKey(b)))e=this._parentMap[d],e!==b&&(this._parentMap[d]=b,m[d]=null);return Object.keys(m)};h.prototype._onChildrenChanged=
function(a){a&&this._parentToChildrenName&&(a=this._parentMap[a])&&a.raisePropertyChanged(this._parentToChildrenName)};h.prototype._onParentChanged=function(a){var b=this;a&&this._childToParentName&&(a=this._childMap[a])&&a.forEach(function(a){a.raisePropertyChanged(b._childToParentName)})};h.prototype._mapChildren=function(a){for(var b,d,h,e=c.DELETED,m={},f=0,g=a.length;f<g;f+=1)if(b=a[f],d=b._changeType,d!==e&&(d=this.getChildFKey(b)))h=this._childMap[d],h||(h=[],this._childMap[d]=h),0>h.indexOf(b)&&
(h.push(b),m[d]||(m[d]=null));return Object.keys(m)};h.prototype._unbindParentDS=function(){var a=this.parentDS;a&&a.removeNSHandlers(this._objId)};h.prototype._unbindChildDS=function(){var a=this.childDS;a&&a.removeNSHandlers(this._objId)};h.prototype.getParentFKey=function(a){return a&&a._isNew?a._key:this._getItemKey(this._parentFldInfos,this._parentDS,a)};h.prototype.getChildFKey=function(a){if(a&&this._childToParentName){var b=a._getFieldVal(this._childToParentName);if(b)return b}return this._getItemKey(this._childFldInfos,
this._childDS,a)};h.prototype.getChildItems=function(a){if(!a)return[];a=this.getParentFKey(a);a=this._childMap[a];return!a?[]:a};h.prototype.getParentItem=function(a){if(!a)return null;a=this.getChildFKey(a);return(a=this._parentMap[a])?a:null};h.prototype.refreshParentMap=function(){this._resetParentMap();return this._mapParentItems(this._parentDS.items)};h.prototype.refreshChildMap=function(){this._resetChildMap();return this._mapChildren(this._childDS.items)};h.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,clearTimeout(this._changedTimeout),this._changedTimeout=null,this._changed={},this._unbindParentDS(),this._unbindChildDS(),this._childFldInfos=this._parentFldInfos=this._childMap=this._parentMap=null,b.prototype.destroy.call(this))};h.prototype.toString=function(){return this._name};Object.defineProperty(h.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parentToChildrenName",{get:function(){return this._parentToChildrenName},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"childToParentName",{get:function(){return this._childToParentName},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parentDS",{get:function(){return this._parentDS},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"childDS",{get:function(){return this._childDS},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parentFldInfos",{get:function(){return this._parentFldInfos},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"childFldInfos",{get:function(){return this._childFldInfos},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"onDeleteAction",{get:function(){return this._onDeleteAction},enumerable:!0,configurable:!0});return h}(a.BaseObject);k.Association=m;y=function(b){function c(d){b.call(this);d=e.extend(!1,{dataSource:null,fn_filter:null,fn_sort:null,fn_itemsProvider:null},d);if(!d.dataSource||!e.check.isProtoOf(r.collection.Collection,d.dataSource))throw Error(a.ERRS.ERR_DATAVIEW_DATASRC_INVALID);
if(!d.fn_filter||!e.check.isFunction(d.fn_filter))throw Error(a.ERRS.ERR_DATAVIEW_FILTER_INVALID);this._objId="dvw"+e.getNewID();this._dataSource=d.dataSource;this._fn_filter=d.fn_filter;this._fn_sort=d.fn_sort;this._fn_itemsProvider=d.fn_itemsProvider;this._isAddingNew=this._isDSFilling=!1;var h=this,m=this._dataSource;m.getFieldNames().forEach(function(a){h._fieldMap[a]=e.extend(!1,{},m.getFieldInfo(a))});this._bindDS()}__extends(c,b);c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);
return["view_refreshed"].concat(a)};c.prototype.addOnViewRefreshed=function(a,b){this.addHandler("view_refreshed",a,b)};c.prototype.removeOnViewRefreshed=function(a){this.removeHandler("view_refreshed",a)};c.prototype._filterForPaging=function(a){var b=0,c=0,d=-1,h=-1,e=[],b=this.pageSize*this.pageIndex,c=this.pageSize;a.forEach(function(a){h+=1;h<b||(d+=1,d<c&&e.push(a))});return e};c.prototype._onViewRefreshed=function(a){this.raiseEvent("view_refreshed",a)};c.prototype._refresh=function(a){var b;
if(b=this._dataSource)b=this._fn_itemsProvider?this._fn_itemsProvider(b):b.items,this._fn_filter&&(b=b.filter(this._fn_filter)),this._fn_sort&&(b=b.sort(this._fn_sort)),this._fillItems({items:b,isPageChanged:!!a,clear:!0,isAppend:!1}),this._onViewRefreshed({})};c.prototype._fillItems=function(a){a=e.extend(!1,{items:[],isPageChanged:!1,clear:!0,isAppend:!1},a);var b=this,c,h=[],m=[],f=[];this._onFillStart({isBegin:!0,rowCount:a.items.length,time:new Date,isPageChanged:a.isPageChanged});try{a.clear&&
this.clear(),c=this.isPagingEnabled&&!a.isAppend?this._filterForPaging(a.items):a.items,c.forEach(function(a){var c=b._itemsByKey[a._key];c?f.push(c):(b._itemsByKey[a._key]=a,h.push(a),m.push(b._items.length-1),b._items.push(a),f.push(a))}),0<h.length&&(this._onItemsChanged({change_type:d.ADDED,items:h,pos:m}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:f.length,time:new Date,resetUI:!!a.clear,fetchedItems:f,newItems:h,isPageChanged:a.isPageChanged})}this.totalCount=
a.clear?a.items.length:this.totalCount+h.length;this.moveFirst();return h};c.prototype._onDSCollectionChanged=function(b){var c=this,h;h=b.items;switch(b.change_type){case d.RESET:this._isDSFilling||this._refresh(!1);break;case d.ADDED:!this._isAddingNew&&!this._isDSFilling&&(c._fn_filter&&(h=h.filter(c._fn_filter)),c.appendItems(h));break;case d.REMOVE:h.forEach(function(a){(a=c._itemsByKey[a._key])&&c.removeItem(a)});break;case d.REMAP_KEY:if(h=c._itemsByKey[b.old_key])delete c._itemsByKey[b.old_key],
c._itemsByKey[b.new_key]=h,this._onItemsChanged(b);break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}};c.prototype._onDSFill=function(a){var b=a.fetchedItems;a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,a.resetUI?this._refresh(!1):(this._fn_filter&&(b=b.filter(this._fn_filter)),this.appendItems(b)))};c.prototype._onDSStatusChanged=function(a){var b=a.item,c=a.oldChangeType,d=!!this._fn_filter;this._itemsByKey[a.key]?(this._onItemStatusChanged(b,c),
d&&((a=this._fn_filter(b))||this.removeItem(b))):d&&(a=this._fn_filter(b))&&this.appendItems([b])};c.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addHandler("coll_changed",function(c,d){b===c&&a._onDSCollectionChanged(d)},a._objId),b.addHandler("fill",function(c,d){b===c&&a._onDSFill(d)},a._objId),b.addHandler("begin_edit",function(c,d){b===c&&a._itemsByKey[d.item._key]&&a._onEditing(d.item,!0,!1)},a._objId),b.addHandler("end_edit",function(c,d){if(b===c){var h,e=d.item;h=!!a._fn_filter;
a._itemsByKey[e._key]?(a._onEditing(e,!1,d.isCanceled),!d.isCanceled&&h&&((h=a._fn_filter(e))||a.removeItem(e))):!d.isCanceled&&h&&(h=a._fn_filter(e))&&a.appendItems([e])}},a._objId),b.addHandler("errors_changed",function(c,d){b===c&&a._itemsByKey[d.item._key]&&a._onErrorsChanged(d.item)},a._objId),b.addHandler("status_changed",function(c,d){b===c&&a._onDSStatusChanged(d)},a._objId),b.addHandler("item_deleting",function(c,d){b===c&&a._itemsByKey[d.item._key]&&a._onItemDeleting(d)},a._objId),b.addHandler("item_added",
function(c,d){b===c&&a._isAddingNew&&(a._itemsByKey[d.item._key]||a._attach(d.item),a.currentItem=d.item,a._onEditing(d.item,!0,!1),a._onItemAdded(d.item))},a._objId),b.addHandler("item_adding",function(c,d){b===c&&a._isAddingNew&&a._onItemAdding(d.item)},a._objId))};c.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};c.prototype.appendItems=function(a){return this._isDestroyCalled?[]:this._fillItems({items:a,isPageChanged:!1,clear:!1,isAppend:!0})};c.prototype._getStrValue=
function(a,b){return this._dataSource._getStrValue(a,b)};c.prototype._onCurrentChanging=function(b){var c=this._dataSource;try{c._EditingItem&&b!==c._EditingItem&&c.endEdit()}catch(d){c.cancelEdit(),a.global.reThrow(d,this._onError(d,this))}};c.prototype._getErrors=function(a){return this._dataSource._getErrors(a)};c.prototype._onPageChanged=function(){this._refresh(!0)};c.prototype.getItemsWithErrors=function(){return this._dataSource.getItemsWithErrors()};c.prototype.addNew=function(){var a=this._dataSource,
b;this._isAddingNew=!0;try{b=a.addNew()}finally{this._isAddingNew=!1}return b};c.prototype.removeItem=function(b){if(null===b._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[b._key]){var c=e.removeFromArray(this._items,b);if(0>c)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);delete this._itemsByKey[b._key];delete this._errors[b._key];this.totalCount-=1;this._onRemoved(b,c);b=this.getItemByPos(c);var d=this._currentPos;d===c&&(b||(this._currentPos=d-1),this._onCurrentChanged());d>c&&(this._currentPos=
d-1,this._onCurrentChanged())}};c.prototype.sortLocal=function(b,c){var d=1,h=a.global.parser;c&&"DESC"===c.toUpperCase()&&(d=-1);this.fn_sort=function(a,c){var e=0,m,f,g;m=0;for(f=b.length;m<f&&!(g=b[m],e=h.resolvePath(a,g),g=h.resolvePath(c,g),e=e<g?-1*d:e>g?d:0,0!==e);m+=1);return e}};c.prototype.getIsHasErrors=function(){return this._dataSource.getIsHasErrors()};c.prototype.clear=function(){this.cancelEdit();this._EditingItem=null;this._newKey=0;this.currentItem=null;this._items=[];this._itemsByKey=
{};this._errors={};this._onItemsChanged({change_type:d.RESET,items:[]});this.pageIndex=0;this.raisePropertyChanged("count")};c.prototype.refresh=function(){this._refresh(!1)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._fn_sort=this._fn_filter=this._dataSource=null,b.prototype.destroy.call(this))};Object.defineProperty(c.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},set:function(a){this._options.enablePaging!==
a&&(this._options.enablePaging=a,this.raisePropertyChanged("isPagingEnabled"),this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"permissions",{get:function(){return this._dataSource.permissions},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_filter",{get:function(){return this._fn_filter},set:function(a){this._fn_filter!==a&&(this._fn_filter=a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_sort",
{get:function(){return this._fn_sort},set:function(a){this._fn_sort!==a&&(this._fn_sort=a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_itemsProvider",{get:function(){return this._fn_itemsProvider},set:function(a){this._fn_itemsProvider!==a&&(this._fn_itemsProvider=a,this._refresh(!1))},enumerable:!0,configurable:!0});return c}(r.collection.Collection);k.DataView=y;y=function(a){function b(c){this._refreshTimeout=this._parentItem=null;this._association=
c.association;var d=e.extend(!1,{dataSource:this._association.childDS,fn_filter:null,fn_sort:null,fn_itemsProvider:null},c),h=this,m=this._association,f=c.fn_filter;d.fn_filter=function(a){if(!h._parentItem)return!1;var b=m.getParentFKey(h._parentItem);if(!b)return!1;var c=m.getChildFKey(a);return!c||b!==c?!1:f?f(a):!0};a.call(this,d)}__extends(b,a);b.prototype._refresh=function(){var a=this;this._dataSource&&(clearTimeout(a._refreshTimeout),a._refreshTimeout=setTimeout(function(){if(!a._isDestroyCalled){var b=
a._association.getChildItems(a._parentItem);a._fn_filter&&(b=b.filter(a._fn_filter));a._fn_sort&&(b=b.sort(a._fn_sort));a._fillItems({items:b,isPageChanged:!1,clear:!0,isAppend:!1});a._onViewRefreshed({})}},250))};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,clearTimeout(this._refreshTimeout),this._association=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return this._association?"ChildDataView for "+this._association.toString():"ChildDataView"};
Object.defineProperty(b.prototype,"parentItem",{get:function(){return this._parentItem},set:function(a){this._parentItem!==a&&(this._parentItem=a,this.raisePropertyChanged("parentItem"),0<this.items.length&&(this.clear(),this._onViewRefreshed({})),this._refresh())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"association",{get:function(){return this._association},enumerable:!0,configurable:!0});return b}(y);k.ChildDataView=y;a.global.onModuleLoaded("db",k)})(r.db||(r.db={}))})(a.MOD||
(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts,e=function(b){function c(c,e,f){b.call(this);var l=this;this._el=c;this._$el=a.global.$(this._el);this._objId="lst"+g.getNewID();if(e&&!(e instanceof r.collection.Collection))throw Error(a.ERRS.ERR_LISTBOX_DATASRC_INVALID);this._$el.on("change."+this._objId,function(a){a.stopPropagation();l._isRefreshing||l._onChanged()});this._dataSource=null;this._isRefreshing=this._isDSFilling=!1;this._valuePath=f.valuePath;this._textPath=
f.textPath;this._saveSelected=this._selectedItem=null;this._keyMap={};this._valMap={};this._saveVal=void 0;this.dataSource=e}__extends(c,b);c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._$el.off("."+this._objId),this._clear(!0),this._$el=this._el=null,b.prototype.destroy.call(this))};c.prototype._onChanged=function(){var a=null,b;0<=this._el.selectedIndex&&(a=this._el.options[this._el.selectedIndex],a=a.value,b=this._keyMap[a]);!b&&this._selectedItem?
this.selectedItem=null:b.item!==this._selectedItem&&(this.selectedItem=b.item)};c.prototype._getValue=function(a){a=this._getRealValue(a);return g.check.isNt(a)?"":a};c.prototype._getRealValue=function(b){if(!b)return null;if(this._valuePath)return a.global.parser.resolvePath(b,this._valuePath)};c.prototype._getText=function(b){return!b?"":this._textPath?(b=a.global.parser.resolvePath(b,this._textPath),g.check.isNt(b)?"":""+b):""+this._getValue(b)};c.prototype._onDSCollectionChanged=function(a){var b=
this,c=r.collection.consts.COLL_CHANGE_TYPE;switch(a.change_type){case c.RESET:this._isDSFilling||this._refresh();break;case c.ADDED:this._isDSFilling||a.items.forEach(function(a){b._addOption(a,a._isNew)});break;case c.REMOVE:a.items.forEach(function(a){b._removeOption(a)});break;case c.REMAP_KEY:if(c=b._keyMap[a.old_key])delete b._keyMap[a.old_key],b._keyMap[a.new_key]=c,c.op.value=a.new_key}};c.prototype._onDSFill=function(a){a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,this._refresh())};
c.prototype._onEdit=function(a,b,c){b?this._saveVal=this._getValue(a):(b=this._saveVal,this._saveVal=void 0,c||(c=a._key,(c=this._keyMap[c])?(c.op.text=this._getText(a),a=this._getValue(a),b!==a&&(""!==b&&delete this._valMap[b],""!==a&&(this._valMap[a]=c))):""!==b&&delete this._valMap[b]))};c.prototype._onStatusChanged=function(a,b){a._changeType===q.CHANGE_TYPE.DELETED&&this._removeOption(a)};c.prototype._onCommitChanges=function(a,b,c,d){var e=q.CHANGE_TYPE;if(b){if(!(c&&d===e.ADDED)&&(c||d!==e.DELETED))this._saveVal=
this._getValue(a)}else b=this._saveVal,this._saveVal=void 0,c&&d===e.DELETED?this._addOption(a,!0):(c=this._getValue(a),d=this._keyMap[a._key],b!==c&&(""!==b&&delete this._valMap[b],d&&""!==c&&(this._valMap[c]=d)),d&&(d.op.text=this._getText(a)))};c.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addOnCollChanged(function(c,d){b===c&&a._onDSCollectionChanged(d)},a._objId),b.addOnFill(function(c,d){b===c&&a._onDSFill(d)},a._objId),b.addOnBeginEdit(function(c,d){b===c&&a._onEdit(d.item,
!0,void 0)},a._objId),b.addOnEndEdit(function(c,d){b===c&&a._onEdit(d.item,!1,d.isCanceled)},a._objId),b.addOnStatusChanged(function(c,d){b===c&&a._onStatusChanged(d.item,d.oldChangeType)},a._objId),b.addOnCommitChanges(function(c,d){b===c&&a._onCommitChanges(d.item,d.isBegin,d.isRejected,d.changeType)},a._objId))};c.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};c.prototype._addOption=function(b,c){if(this._isDestroyCalled)return null;var d,e="",f,g;b&&
(e=b._key);if(this._keyMap[e])return null;g=this._getText(b);f=this._getValue(b);d=a.global.document.createElement("option");d.text=g;d.value=e;g={item:b,op:d};this._keyMap[e]=g;""!==f&&(this._valMap[f]=g);c?2>this._el.options.length?this._el.add(d,null):this._el.add(d,this._el.options[1]):this._el.add(d,null);return d};c.prototype._removeOption=function(a){if(!this._isDestroyCalled){var b="",c;if(a&&(b=a._key,c=this._keyMap[b]))this._el.remove(c.op.index),c=this._getValue(a),delete this._keyMap[b],
""!==c&&delete this._valMap[c],this._saveSelected===a&&(this._saveSelected=null),this.selectedItem===a&&(this.selectedItem=this._saveSelected)}};c.prototype._clear=function(a){this._el.options.length=0;this._keyMap={};this._valMap={};this._saveSelected=null;a?this._selectedItem=null:(this._addOption(null,!1),this.selectedItem=null)};c.prototype.clear=function(){this._clear(!1)};c.prototype._refresh=function(){var a=this,b=this._dataSource,c=this._selectedItem;this._isRefreshing=!0;try{this.clear(),
b&&b.forEach(function(b){a._addOption(b,!1)}),this._el.selectedIndex=this._findItemIndex(c)}finally{this._isRefreshing=!1}this._onChanged()};c.prototype._findItemIndex=function(a){if(!a)return 0;a=this._keyMap[a._key];return!a?0:a.op.index};c.prototype.findItemByValue=function(a){a=this._valMap[a];return!a?null:a.item};c.prototype.getTextByValue=function(a){return(a=this._valMap[a])?a.op.text:""};c.prototype._setIsEnabled=function(a,b){a.disabled=!b};c.prototype._getIsEnabled=function(a){return!a.disabled};
c.prototype.toString=function(){return"ListBox"};Object.defineProperty(c.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){this._dataSource!==a&&(this._dataSource&&this._unbindDS(),this.clear(),(this._dataSource=a)&&this._bindDS(),this._refresh(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedValue",{get:function(){return this._getRealValue(this.selectedItem)},set:function(a){this.selectedValue!==a&&
(this.selectedItem=this.findItemByValue(a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedItem",{get:function(){return this._selectedItem},set:function(a){this._selectedItem!==a&&(this._selectedItem&&(this._saveSelected=this._selectedItem),this._selectedItem=a,this._el.selectedIndex=this._findItemIndex(this._selectedItem),this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"valuePath",{get:function(){return this._valuePath},set:function(a){a!==this._valuePath&&(this._valuePath=a,this.raisePropertyChanged("valuePath"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"textPath",{get:function(){return this._textPath},set:function(a){a!==this._textPath&&(this._textPath=a,this._refresh(),this.raisePropertyChanged("textPath"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEnabled",{get:function(){return this._getIsEnabled(this._el)},
set:function(a){a!==this.isEnabled&&(this._setIsEnabled(this._el,a),this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.ListBox=e;var f=function(a){function b(c,e,f){this._listBox=this._dataSource=null;this._options=f;a.call(this,c,e,f)}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._listBox&&!this._listBox._isDestroyCalled&&
this._listBox.destroy(),this._dataSource=this._listBox=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"SelectElView"};Object.defineProperty(b.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"dataSource",{get:function(){return this._dataSource},set:function(a){var b=this;this._dataSource!==a&&(this._dataSource=a,this._listBox&&this._listBox.destroy(),this._listBox=null,this._dataSource&&(this._listBox=new e(this._el,this._dataSource,this._options),this._listBox.addOnDestroyed(function(){b._listBox=null},this.uniqueID),this._listBox.addOnPropertyChange("*",function(a,c){b.raisePropertyChanged(c.property)},this.uniqueID)),b.invokePropChanged("listBox"))},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"selectedValue",{get:function(){return!this._listBox?null:this._listBox.selectedValue},set:function(a){this._listBox&&this._listBox.selectedValue!==a&&(this._listBox.selectedValue=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedItem",{get:function(){return!this._listBox?null:this._listBox.selectedItem},set:function(a){this._listBox&&(this._listBox.selectedItem=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"listBox",
{get:function(){return this._listBox},enumerable:!0,configurable:!0});return b}(r.baseElView.BaseElView);k.SelectElView=f;var l=function(b){function c(c,e,f,l,k){if("lookup"!=f.name)throw Error(g.format(a.ERRS.ERR_ASSERTION_FAILED,"options.name == 'lookup'"));this._selectView=this._spanView=null;this._isListBoxCachedExternally=!1;this._value=this._listBinding=this._valBinding=null;b.call(this,c,e,f,l,k)}__extends(c,b);c.prototype._init=function(){this._options.initContentFn&&this._options.initContentFn(this)};
c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);return["object_created","object_needed"].concat(a)};c.prototype.addOnObjectCreated=function(a,b){this.addHandler("object_created",a,b)};c.prototype.removeOnObjectCreated=function(a){this.removeHandler("object_created",a)};c.prototype.addOnObjectNeeded=function(a,b){this.addHandler("object_needed",a,b)};c.prototype.removeOnObjectNeeded=function(a){this.removeHandler("object_needed",a)};c.prototype._getSelectView=function(){if(this._selectView)return this._selectView;
var b=this._options.options,c={objectKey:"selectElView",object:null};this.raiseEvent("object_needed",c);if(c.object)return this._isListBoxCachedExternally=!0,c.object;var c=a.global.parser.resolvePath(this.app,b.dataSource),b={valuePath:b.valuePath,textPath:b.textPath},d=a.global.document.createElement("select");d.setAttribute("size","1");b=this._getSelectElView(d,b);b.dataSource=c;c={objectKey:"selectElView",object:b,isCachedExternally:!1};this.raiseEvent("object_created",c);this._isListBoxCachedExternally=
c.isCachedExternally;return b};c.prototype._getSelectElView=function(a,b){var c;return(c=this.app._getElView(a))?c:c=new f(this.app,a,b)};c.prototype._updateTextValue=function(){this._spanView&&(this._spanView.value=this._getLookupText())};c.prototype._getLookupText=function(){return this._getSelectView().listBox.getTextByValue(this.value)};c.prototype._createSpanView=function(){var b=a.global.document.createElement("span"),c=this._getDisplayInfo(),b=new r.baseElView.SpanElView(this.app,b,{});c&&
c.displayCss&&b.$el.addClass(c.displayCss);return b};c.prototype.update=function(){this._cleanUp();this._el=this._createTargetElement();this._parentEl.appendChild(this._el)};c.prototype._createTargetElement=function(){var a;this._isEditing&&this._canBeEdited()?(this._selectView||(this._selectView=this._getSelectView()),this._listBinding=this._bindToList(),a=this._selectView.el):(this._spanView||(this._spanView=this._createSpanView()),this._valBinding=this._bindToValue(),a=this._spanView.el);this._updateCss();
return a};c.prototype._cleanUp=function(){this._el&&(a.global.$(this._el).remove(),this._el=null);this._listBinding&&(this._listBinding.destroy(),this._listBinding=null);this._valBinding&&(this._valBinding.destroy(),this._valBinding=null);this._selectView&&this._isListBoxCachedExternally&&(this._selectView=null)};c.prototype._updateBindingSource=function(){this._valBinding&&(this._valBinding.source=this._dctx);this._listBinding&&(this._listBinding.source=this._dctx)};c.prototype._bindToValue=function(){return!this._options.fieldName?
null:new r.binding.Binding({target:this,source:this._dctx,targetPath:"value",sourcePath:this._options.fieldName,mode:"OneWay",converter:null,converterParam:null,isSourceFixed:!1})};c.prototype._bindToList=function(){if(!this._options.fieldName)return null;var a={target:this._getSelectView(),source:this._dctx,targetPath:"selectedValue",sourcePath:this._options.fieldName,mode:"TwoWay",converter:null,converterParam:null,isSourceFixed:!1};return new r.binding.Binding(a)};c.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this._cleanUp(),this._selectView&&!this._isListBoxCachedExternally&&this._selectView.destroy(),this._selectView=null,this._spanView&&this._spanView.destroy(),this._spanView=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return"LookupContent"};Object.defineProperty(c.prototype,"value",{get:function(){return this._value},set:function(a){this._value!==a&&(this._value=a,this._updateTextValue(),this.raisePropertyChanged("value"))},enumerable:!0,configurable:!0});
return c}(r.baseContent.BindingContent);k.LookupContent=l;var b=function(){function b(a,d){this._app=a;this._nextFactory=d}b.prototype.getContentType=function(b){if("lookup"==b.name)return l;if(this._nextFactory)return this._nextFactory.getContentType(b);throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);};b.prototype.createContent=function(a,b,d,e){return new (this.getContentType(b))(this._app,a,b,d,e)};b.prototype.isExternallyCachable=function(a){return this._nextFactory.isExternallyCachable(a)};
Object.defineProperty(b.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return b}();k.ContentFactory=b;k.initModule=function(a){a.registerContentFactory(function(c){return new b(a,c)});return k};a.global.registerElView("select",f);a.global.onModuleLoaded("listbox",k)})(r.listbox||(r.listbox={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils;k.DIALOG_ACTION={Default:0,StayOpen:1};var q=function(e){function f(a,b){e.call(this);var d=this;this._app=a;this._objId="dlg"+g.getNewID();var c=g.extend(!1,{dataContext:null,templateID:null,width:500,height:350,title:"data edit dialog",submitOnOK:!1,canRefresh:!1,canCancel:!0,fn_OnClose:null,fn_OnOK:null,fn_OnShow:null,fn_OnCancel:null,fn_OnTemplateCreated:null,fn_OnTemplateDestroy:null},b);this._dataContext=c.dataContext;this._templateID=
c.templateID;this._submitOnOK=c.submitOnOK;this._canRefresh=c.canRefresh;this._canCancel=c.canCancel;this._fn_OnClose=c.fn_OnClose;this._fn_OnOK=c.fn_OnOK;this._fn_OnShow=c.fn_OnShow;this._fn_OnCancel=c.fn_OnCancel;this._fn_OnTemplateCreated=c.fn_OnTemplateCreated;this._fn_OnTemplateDestroy=c.fn_OnTemplateDestroy;this._isEditable=!1;this._currentSelectable=this._result=this._$template=this._template=null;this._fn_submitOnOK=function(){return!d._dataContext._isCanSubmit?g.createDeferred().resolve().promise():
d._dataContext.submitChanges()};this._updateIsEditable();this._options={width:c.width,height:c.height,title:c.title,autoOpen:!1,modal:!0,close:function(a,b){d._onClose()},buttons:d._getButtons()};this._dialogCreated=!1;this._createDialog()}__extends(f,e);f.prototype.addOnClose=function(a,b){this.addHandler("close",a,b)};f.prototype.removeOnClose=function(a){this.removeHandler("close",a)};f.prototype.addOnRefresh=function(a,b){this.addHandler("refresh",a,b)};f.prototype.removeOnRefresh=function(a){this.removeHandler("refresh",
a)};f.prototype._updateIsEditable=function(){this._isEditable=g.check.isEditable(this._dataContext)};f.prototype._createDialog=function(){this._dialogCreated||(this._template=this._createTemplate(this._dataContext),this._$template=a.global.$(this._template.el),a.global.document.body.appendChild(this._template.el),this._$template.dialog(this._options),this._dialogCreated=!0,this._fn_OnTemplateCreated&&this._fn_OnTemplateCreated(this._template))};f.prototype._getEventNames=function(){var a=e.prototype._getEventNames.call(this);
return["close","refresh"].concat(a)};f.prototype._createTemplate=function(a){var b=new r.template.Template(this._app,this._templateID);b.isDisabled=!0;b.dataContext=a;return b};f.prototype._destroyTemplate=function(){this._fn_OnTemplateDestroy&&this._fn_OnTemplateDestroy(this._template);this._$template.remove();this._template.destroy();this._template=this._$template=null};f.prototype._getButtons=function(){var e=this,b=[{id:e._objId+"Refresh",text:a.localizable.TEXT.txtRefresh,"class":"btn btn-info",
click:function(){e._onRefresh()}},{id:e._objId+"Ok",text:a.localizable.TEXT.txtOk,"class":"btn btn-info",click:function(){e._onOk()}},{id:e._objId+"Cancel",text:a.localizable.TEXT.txtCancel,"class":"btn btn-info",click:function(){e._onCancel()}}];this.canRefresh||b.shift();this.canCancel||b.pop();return b};f.prototype._getOkButton=function(){return $("#"+this._objId+"Ok")};f.prototype._getCancelButton=function(){return $("#"+this._objId+"Cancel")};f.prototype._getRefreshButton=function(){return $("#"+
this._objId+"Refresh")};f.prototype._getAllButtons=function(){return[this._getOkButton(),this._getCancelButton(),this._getRefreshButton()]};f.prototype._disableButtons=function(a){this._getAllButtons().forEach(function(b){b.prop("disabled",!!a)})};f.prototype._onOk=function(){var e=this,b;b=k.DIALOG_ACTION.Default;this._fn_OnOK&&(b=this._fn_OnOK(this));if(b!=k.DIALOG_ACTION.StayOpen)if(this._dataContext){if(b=this._isEditable?this._dataContext.endEdit():!0)if(this._submitOnOK){this._disableButtons(!0);
var d=this.title;this.title=a.localizable.TEXT.txtSubmitting;b=this._fn_submitOnOK();b.always(function(){e._disableButtons(!1);e.title=d});b.done(function(){e._result="ok";e.hide()});b.fail(function(){e._isEditable&&e._dataContext.beginEdit()})}else e._result="ok",e.hide()}else e.hide()};f.prototype._onCancel=function(){var a=k.DIALOG_ACTION.Default;this._fn_OnCancel&&(a=this._fn_OnCancel(this));a!=k.DIALOG_ACTION.StayOpen&&(this._result="cancel",this.hide())};f.prototype._onRefresh=function(){var a=
{isHandled:!1};this.raiseEvent("refresh",a);a.isHandled||this._dataContext&&g.check.isFunction(this._dataContext.refresh)&&this._dataContext.refresh()};f.prototype._onClose=function(){try{"ok"!=this._result&&this._dataContext&&(this._isEditable&&this._dataContext.cancelEdit(),this._submitOnOK&&g.check.isFunction(this._dataContext.rejectChanges)&&this._dataContext.rejectChanges()),this._fn_OnClose&&this._fn_OnClose(this),this.raiseEvent("close",{})}finally{this._template.isDisabled=!0}var e=this._currentSelectable;
this._currentSelectable=null;setTimeout(function(){a.global.currentSelectable=e;e=null},50)};f.prototype._onShow=function(){this._currentSelectable=a.global.currentSelectable;this._fn_OnShow&&this._fn_OnShow(this)};f.prototype.show=function(){this._result=null;this._$template.dialog("option","buttons",this._getButtons());this._template.isDisabled=!1;this._onShow();this._$template.dialog("open")};f.prototype.hide=function(){this._$template.dialog("close")};f.prototype.getOption=function(a){return this._$template.dialog("option",
a)};f.prototype.setOption=function(a,b){this._$template.dialog("option",a,b)};f.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._dialogCreated&&(this.hide(),this._destroyTemplate(),this._dialogCreated=!1),this._app=this._fn_submitOnOK=this._dataContext=null,e.prototype.destroy.call(this))};Object.defineProperty(f.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){a!==this._dataContext&&(this._dataContext=a,this._template&&(this._template.dataContext=
this._dataContext),this._updateIsEditable(),this.raisePropertyChanged("dataContext"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"result",{get:function(){return this._result},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSubmitOnOK",{get:function(){return this._submitOnOK},set:function(a){this._submitOnOK!==a&&(this._submitOnOK=a,this.raisePropertyChanged("isSubmitOnOK"))},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"width",{get:function(){return this.getOption("width")},set:function(a){var b=this.getOption("width");a!==b&&(this.setOption("width",a),this.raisePropertyChanged("width"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return this.getOption("height")},set:function(a){var b=this.getOption("height");a!==b&&(this.setOption("height",a),this.raisePropertyChanged("height"))},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"title",{get:function(){return this.getOption("title")},set:function(a){var b=this.getOption("title");a!==b&&(this.setOption("title",a),this.raisePropertyChanged("title"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"canRefresh",{get:function(){return this._canRefresh},set:function(a){a!==this._canRefresh&&(this._canRefresh=a,this.raisePropertyChanged("canRefresh"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"canCancel",
{get:function(){return this._canCancel},set:function(a){a!==this._canCancel&&(this._canCancel=a,this.raisePropertyChanged("canCancel"))},enumerable:!0,configurable:!0});return f}(a.BaseObject);k.DataEditDialog=q;a.global.onModuleLoaded("datadialog",k)})(r.datadialog||(r.datadialog={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts;k.css={container:"ria-table-container",dataTable:"ria-data-table",columnInfo:"ria-col-info",column:"ria-ex-column",cellDiv:"cell-div",headerDiv:"ria-table-header",wrapDiv:"ria-table-wrap",dataColumn:"data-column",rowCollapsed:"row-collapsed",rowExpanded:"row-expanded",rowExpander:"row-expander",columnSelected:"selected",rowSelected:"selected",rowActions:"row-actions",rowDetails:"row-details",rowSelector:"row-selector",rowHighlight:"row-highlight",
rowDeleted:"row-deleted",rowError:"row-error",nobr:"ria-nobr",colSortable:"sortable",colSortAsc:"sort-asc",colSortDesc:"sort-desc"};var e=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._canBeEdited=function(){return!0};b.prototype.toString=function(){return"RowSelectContent"};return b}(r.baseContent.BoolContent);k.RowSelectContent=e;var f=function(b){function c(d,e){b.call(this);this._row=d;this._el=e.td;this._column=e.column;this._div=a.global.document.createElement("div");
var h=a.global.$(this._div);this._clickTimeOut=null;h.addClass(k.css.cellDiv).attr(q.DATA_ATTR.DATA_EVENT_SCOPE,this._column.uniqueID);h.data("cell",this);this._column.options.width&&(this._el.style.width=this._column.options.width);this._init();this.column.options.rowCellCss&&h.addClass(this.column.options.rowCellCss);this._el.appendChild(this._div);this._row.el.appendChild(this._el)}__extends(c,b);c.prototype._init=function(){};c.prototype._onCellClicked=function(){this.grid.currentRow=this._row};
c.prototype._onDblClicked=function(){this.grid.currentRow=this._row;this.grid._onCellDblClicked(this)};c.prototype._onError=function(a,c){var d=b.prototype._onError.call(this,a,c);return!d?this.row._onError(a,c):d};c.prototype.scrollIntoView=function(a){this._div.scrollIntoView(!!a)};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clickTimeOut&&(clearTimeout(this._clickTimeOut),this._clickTimeOut=null);var c=a.global.$(this._div);c.removeData();c.remove();this._column=
this._el=this._row=this._div=null;b.prototype.destroy.call(this)}};c.prototype.toString=function(){return"BaseCell"};Object.defineProperty(c.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"grid",{get:function(){return this._row.grid},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"item",{get:function(){return this._row.item},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.BaseCell=f;var l=function(b){function c(a,d){this._stateCss=this._content=null;b.call(this,a,d)}__extends(c,b);c.prototype._init=function(){var b=this.column.options.content;if(!b.fieldInfo&&b.fieldName&&(b.fieldInfo=this.item.getFieldInfo(b.fieldName),!b.fieldInfo))throw Error(g.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",b.fieldName));
var c=this.grid.app;b.initContentFn=null;try{var d=c._getContentType(b);c.contentFactory.isExternallyCachable(d)&&(b.initContentFn=this._getInitContentFn());this._content=c._getContent(d,b,this._div,this.item,this.item.isEditing)}finally{delete b.initContentFn}};c.prototype._getInitContentFn=function(){var a=this;return function(b){b.addOnObjectCreated(function(b,c){a.column._cacheObject(c.objectKey,c.object);c.isCachedExternally=!!a.column._getCachedObject(c.objectKey)});b.addOnObjectNeeded(function(b,
c){c.object=a.column._getCachedObject(c.objectKey)})}};c.prototype._beginEdit=function(){this._content.isEditing||(this._content.isEditing=!0)};c.prototype._endEdit=function(a){this._content.isEditing&&(this._content.isEditing=!1)};c.prototype._setState=function(b){var c;this._stateCss!==b&&(c=a.global.$(this._div),this._stateCss&&c.removeClass(this._stateCss),(this._stateCss=b)&&c.addClass(this._stateCss))};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._content&&
(this._content.destroy(),this._content=null),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataCell"};Object.defineProperty(c.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});return c}(f);k.DataCell=l;var b=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){var b=a.global.$(this.el);b.addClass(k.css.rowCollapsed);b.addClass(k.css.rowExpander)};c.prototype._onCellClicked=function(){this._row&&
(b.prototype._onCellClicked.call(this),this._row.isExpanded=!this._row.isExpanded)};c.prototype._toggleImage=function(){var b=a.global.$(this.el);this._row.isExpanded?(b.removeClass(k.css.rowCollapsed),b.addClass(k.css.rowExpanded)):(b.removeClass(k.css.rowExpanded),b.addClass(k.css.rowCollapsed))};c.prototype.toString=function(){return"ExpanderCell"};return c}(f);k.ExpanderCell=b;var d=function(b){function c(a,d){this._isEditing=!1;b.call(this,a,d)}__extends(c,b);c.prototype._init=function(){var b=
a.global.$(this.el),c=a.global.$(this._div);b.addClass([k.css.rowActions,k.css.cellDiv,k.css.nobr].join(" "));c.on("mouseenter","img",function(a){a.stopPropagation();$(this).css("opacity",0.5)});c.on("mouseout","img",function(a){a.stopPropagation();$(this).css("opacity",1)});this._createButtons(!1)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.$(this._div).find("img").each(function(b,c){a.global.$(c).removeData()}),b.prototype.destroy.call(this))};c.prototype._createButtons=
function(b){if(this._el){var c=this,d=a.global.$,e=a.global.$(this._div),h={img_ok:"txtOk",img_cancel:"txtCancel",img_edit:"txtEdit",img_delete:"txtDelete"};e.empty();var f=c._column.options;b?(this._isEditing=!0,b=a.global.$('<img name="img_ok" alt="ok"/>&nbsp;<img name="img_cancel" alt="cancel"/>')):(this._isEditing=!1,b=d('<img name="img_edit" alt="edit"/>&nbsp;<img name="img_delete" alt="delete"/>'),c.isCanEdit||(b=b.not('img[name="img_edit"]')),c.isCanDelete||(b=b.not('img[name="img_delete"]')));
(function(b){b.each(function(b,d){var e=a.global.$(d);d.style.cursor="pointer";d.src=f[d.name];e.data("cell",c);g.addToolTip(e,a.localizable.TEXT[h[d.name]]);e.attr(q.DATA_ATTR.DATA_EVENT_SCOPE,c._column.uniqueID)})})(b.filter("img"));e.append(b)}};c.prototype.update=function(){this._row&&this._isEditing!=this._row.isEditing&&this._createButtons(this._row.isEditing)};c.prototype.toString=function(){return"ActionsCell"};Object.defineProperty(c.prototype,"isCanEdit",{get:function(){return this.grid.isCanEdit},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCanDelete",{get:function(){return this.grid.isCanDelete},enumerable:!0,configurable:!0});return c}(f);k.ActionsCell=d;var c=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){a.global.$(this.el).addClass(k.css.rowSelector);this._content=new e(this.grid.app,this._div,{fieldName:"isSelected",bindingInfo:{target:null,source:null,targetPath:null,sourcePath:"isSelected",mode:"TwoWay",converter:null,
converterParam:null},displayInfo:null},this.row,!0)};c.prototype.destroy=function(){this._isDestroyed||(this._content&&(this._content.destroy(),this._content=null),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"RowSelectorCell"};return c}(f);k.RowSelectorCell=c;var h=function(a){function b(c,d){a.call(this);this._row=c;this._el=d.td;this._init(d)}__extends(b,a);b.prototype._init=function(a){if(a=a.details_id)this._template=new r.template.Template(this.grid.app,a),this._el.colSpan=
this.grid.columns.length,this._el.appendChild(this._template.el),this._row.el.appendChild(this._el)};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._template&&(this._template.destroy(),this._template=null),this._el=this._row=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"DetailsCell"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._row},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._row.grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"item",{get:function(){return this._template.dataContext},set:function(a){this._template.dataContext=a},enumerable:!0,configurable:!0});return b}(a.BaseObject);k.DetailsCell=h;var w=function(e){function h(a,b){var c=this;e.call(this);this._grid=a;this._el=b.tr;this._item=b.item;this._cells=null;this._objId=this._grid.uniqueID+
"_"+this._item._key;this._rowSelectorCell=this._actionsCell=this._expanderCell=null;this._isSelected=this._isDeleted=this._isCurrent=!1;this._createCells();this._item.addOnDestroyed(function(a,b){c._onItemDestroyed()},c._objId);this.isDeleted=this._item._isDeleted;var d=function(){var a=c._grid._onRowStateChanged(c,c._item[c._grid._options.rowStateField]);c._setState(a)};this._grid._options.rowStateField&&(this._item.addOnPropertyChange(this._grid._options.rowStateField,function(a,b){d()},this._objId),
d())}__extends(h,e);h.prototype._onItemDestroyed=function(){this.destroy()};h.prototype._onError=function(a,b){var c=e.prototype._onError.call(this,a,b);return!c?this.grid._onError(a,b):c};h.prototype._createCells=function(){var a=this;a._cells=Array(this.columns.length);var b=0;this.columns.forEach(function(c){c=a._createCell(c);a._cells[b]=c;b+=1})};h.prototype._createCell=function(e){var h=a.global.document.createElement("td");e instanceof p?this._expanderCell=e=new b(this,{td:h,column:e}):e instanceof
B?this._actionsCell=e=new d(this,{td:h,column:e}):e instanceof t?this._rowSelectorCell=e=new c(this,{td:h,column:e}):e=new l(this,{td:h,column:e});return e};h.prototype._onBeginEdit=function(){this._cells.forEach(function(a){a instanceof l&&a._beginEdit()});this._actionsCell&&this._actionsCell.update()};h.prototype._onEndEdit=function(a){this._cells.forEach(function(b){b instanceof l&&b._endEdit(a)});this._actionsCell&&this._actionsCell.update()};h.prototype.beginEdit=function(){return this._item.beginEdit()};
h.prototype.endEdit=function(){return this._item.endEdit()};h.prototype.cancelEdit=function(){return this._item.cancelEdit()};h.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var b=this._grid;b&&(this.isExpanded&&b.collapseDetails(),this._cells.forEach(function(a){a.destroy()}),this._cells=null,b._isClearing||(b._removeRow(this),this._el&&a.global.$(this._el).remove()));this._item&&this._item.removeNSHandlers(this._objId);this._grid=this._el=this._expanderCell=this._item=
null;e.prototype.destroy.call(this)}};h.prototype.deleteRow=function(){this._item.deleteItem()};h.prototype.updateErrorState=function(){var b=this._item.getIsHasErrors(),c=a.global.$(this._el);b?c.addClass(k.css.rowError):c.removeClass(k.css.rowError)};h.prototype.scrollIntoView=function(a){this._cells&&0<this._cells.length&&this._cells[0].scrollIntoView(a)};h.prototype._setState=function(a){this.cells.forEach(function(b){b instanceof l&&b._setState(a)})};h.prototype.toString=function(){return"Row"};
Object.defineProperty(h.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"columns",{get:function(){return this._grid.columns},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"itemKey",{get:function(){return!this._item?null:this._item._key},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isCurrent",{get:function(){return this._isCurrent},set:function(b){if(b!==this._isCurrent){var c=a.global.$(this._el);(this._isCurrent=b)?c.addClass(k.css.rowHighlight):c.removeClass(k.css.rowHighlight);
this.raisePropertyChanged("isCurrent")}},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!=a&&(this._isSelected=a,this.raisePropertyChanged("isSelected"),this.grid._onRowSelectionChanged(this))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isExpanded",{get:function(){return this.grid._expandedRow===this},set:function(a){a!==this.isExpanded&&(!a&&this.isExpanded?this.grid._expandDetails(this,
!1):a&&this.grid._expandDetails(this,!0))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"expanderCell",{get:function(){return this._expanderCell},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"actionsCell",{get:function(){return this._actionsCell},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isDeleted",{get:function(){return!this._el?!0:this._isDeleted},set:function(b){this._el&&this._isDeleted!==b&&((this._isDeleted=b)?(this.isExpanded=
!1,a.global.$(this._el).addClass(k.css.rowDeleted)):a.global.$(this._el).removeClass(k.css.rowDeleted))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isEditing",{get:function(){return!!this._item&&this._item._isEditing},enumerable:!0,configurable:!0});return h}(a.BaseObject);k.Row=w;var v=function(b){function c(d,e){b.call(this);this._grid=d;this._el=e.tr;this._parentRow=this._cell=this._item=null;this._objId="drow"+g.getNewID();this._createCell(e.details_id);this._$el=a.global.$(this._el);
this._$el.addClass(k.css.rowDetails)}__extends(c,b);c.prototype._createCell=function(b){var c=a.global.document.createElement("td");this._cell=new h(this,{td:c,details_id:b})};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._cell&&(this._cell.destroy(),this._cell=null),this._$el.remove(),this._grid=this._el=this._item=this._$el=null,b.prototype.destroy.call(this))};c.prototype._setParentRow=function(b){var c=this;this._item=null;this._cell.item=null;g.removeNode(this._el);
!b||b._isDestroyCalled?this._parentRow=null:(this._parentRow=b,this._item=b.item,this._cell.item=this._item,g.insertAfter(b.el,this._el),a.global.$(this._cell._template.el).slideDown("fast",function(){var a=c._parentRow;a&&!a._isDestroyCalled&&c.grid._options.isUseScrollIntoDetails&&a.scrollIntoView(!0)}))};c.prototype.toString=function(){return"DetailsRow"};Object.defineProperty(c.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"$el",
{get:function(){return this._$el},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"item",{get:function(){return this._item},set:function(a){this._item!==a&&(this._item=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"uniqueID",{get:function(){return this._objId},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"itemKey",{get:function(){return!this._item?null:this._item._key},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentRow",{get:function(){return this._parentRow},set:function(b){var c=this;if(b!==this._parentRow){var d=a.global.$(this._cell._template.el);c._parentRow?d.slideUp("fast",function(){c._setParentRow(b)}):c._setParentRow(b)}},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.DetailsRow=v;f=function(b){function c(d,
e){b.call(this);var h=this;this._grid=d;this._el=e.th;this._options=e.colinfo;this._isSelected=!1;this._objId="col"+g.getNewID();var f=a.global.$("<div></div>");f.addClass(k.css.column);this._grid._$headerDiv.append(f);this._$extcol=f;var p=a.global.$("<div></div>");p.addClass(k.css.cellDiv).click(function(b){b.stopPropagation();a.global.currentSelectable=d;d._setCurrentColumn(h);h._onColumnClicked()});f.append(p);p.get(0).cell=this;this._$div=p;a.global.$(this.grid._tableEl).on("click",["div[",q.DATA_ATTR.DATA_EVENT_SCOPE,
'="',this.uniqueID,'"]'].join(""),function(b){b.stopPropagation();var c=a.global.$(this).data("cell");c&&(a.global.currentSelectable=d,d._setCurrentColumn(h),c instanceof l?c._clickTimeOut?(clearTimeout(c._clickTimeOut),c._clickTimeOut=null,c._onDblClicked()):(c._onCellClicked(),c._clickTimeOut=setTimeout(function(){c._clickTimeOut=null},350)):c._onCellClicked())});this._options.width&&(this._el.style.width=this._options.width);this._init();this._options.colCellCss&&p.addClass(this._options.colCellCss)}
__extends(c,b);c.prototype._init=function(){this.title&&this._$div.html(this.title)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._$extcol.remove(),this._$extcol=null,this._grid=this._el=this._$div=this._$div.get(0).cell=null,b.prototype.destroy.call(this))};c.prototype.scrollIntoView=function(a){this._$div&&this._$div.get(0).scrollIntoView(!!a)};c.prototype._onColumnClicked=function(){};c.prototype.toString=function(){return"BaseColumn"};Object.defineProperty(c.prototype,
"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"$div",{get:function(){return this._$div},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"$extcol",{get:function(){return this._$extcol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"title",{get:function(){return this._options.title},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!==a&&((this._isSelected=a)?this._$div.addClass(k.css.columnSelected):this._$div.removeClass(k.css.columnSelected))},enumerable:!0,configurable:!0});
return c}(a.BaseObject);k.BaseColumn=f;var z=function(a){function b(c,d){a.call(this,c,d);this._objCache={};this.$div.addClass(k.css.dataColumn)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);this._sortOrder=null;this.isSortable&&this.$div.addClass(k.css.colSortable)};b.prototype._onColumnClicked=function(){if(this.isSortable&&this.sortMemberName){var a=this._sortOrder;this.grid._resetColumnsSort();this.sortOrder="ASC"==a?"DESC":"ASC";this.grid.sortByColumn(this)}};b.prototype._cacheObject=
function(a,b){this._objCache[a]=b};b.prototype._getCachedObject=function(a){return this._objCache[a]};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var b=this;g.forEachProp(b._objCache,function(a){b._objCache[a].destroy()});b._objCache=null;a.prototype.destroy.call(this)}};b.prototype.toString=function(){return"DataColumn"};Object.defineProperty(b.prototype,"isSortable",{get:function(){return!!this._options.sortable},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"sortMemberName",{get:function(){return this._options.sortMemberName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sortOrder",{get:function(){return this._sortOrder},set:function(a){this.$div.removeClass([k.css.colSortable,k.css.colSortAsc,k.css.colSortDesc].join(" "));switch(a){case "ASC":this.$div.addClass(k.css.colSortAsc);break;case "DESC":this.$div.addClass(k.css.colSortDesc);break;default:this.isSortable&&this.$div.addClass(k.css.colSortable)}this._sortOrder=a},enumerable:!0,
configurable:!0});return b}(f);k.DataColumn=z;var p=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);this.$div.addClass(k.css.rowExpander)};b.prototype.toString=function(){return"ExpanderColumn"};return b}(f);k.ExpanderColumn=p;var t=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){b.prototype._init.call(this);var c=this;this._val=!1;this.$div.addClass(k.css.rowSelector);var d=a.global.$('<input type="checkbox"/>');
this.$div.append(d);this._$chk=d;d.click(function(a){a.stopPropagation();c._onCheckBoxClicked(this.checked)});d.on("change",function(a){a.stopPropagation();c.checked=this.checked})};c.prototype._onCheckBoxClicked=function(a){this.grid.selectRows(a)};c.prototype.toString=function(){return"RowSelectorColumn"};Object.defineProperty(c.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this._$chk;null!==a&&(a=!!a);a!==this._val&&(this._val=a,b&&b.prop("checked",!!this._val),this.raisePropertyChanged("checked"))},
enumerable:!0,configurable:!0});return c}(f);k.RowSelectorColumn=t;var B=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){b.prototype._init.call(this);var c=this,d=this.options;this.$div.addClass(k.css.rowActions);d.img_ok=a.global.getImagePath(d.img_ok||"ok.png");d.img_cancel=a.global.getImagePath(d.img_cancel||"cancel.png");d.img_edit=a.global.getImagePath(d.img_edit||"edit.png");d.img_delete=a.global.getImagePath(d.img_delete||"delete.png");a.global.$(this.grid._tableEl).on("click",
"img["+q.DATA_ATTR.DATA_EVENT_SCOPE+'="'+this.uniqueID+'"]',function(b){b.stopPropagation();b=this.name;var d=a.global.$(this).data("cell");switch(b){case "img_ok":c._onOk(d);break;case "img_cancel":c._onCancel(d);break;case "img_edit":c._onEdit(d);break;case "img_delete":c._onDelete(d)}})};c.prototype._onOk=function(a){a._row&&(a._row.endEdit(),a.update())};c.prototype._onCancel=function(a){a._row&&(a._row.cancelEdit(),a.update())};c.prototype._onDelete=function(a){a._row&&a._row.deleteRow()};c.prototype._onEdit=
function(a){a._row&&(a._row.beginEdit(),a.update(),this.grid.showEditDialog())};c.prototype.toString=function(){return"ActionsColumn"};return c}(f);k.ActionsColumn=B;var C=function(b){function c(d,e,h,f){b.call(this);if(h&&!(h instanceof r.collection.Collection))throw Error(a.ERRS.ERR_GRID_DATASRC_INVALID);this._options=g.extend(!1,{isUseScrollInto:!0,isUseScrollIntoDetails:!0,containerCss:null,wrapCss:null,headerCss:null,rowStateField:null,isCanEdit:null,isCanDelete:null,isHandleAddNew:!1},f);this._app=
d;d=a.global.$(e);this._tableEl=e;this._$tableEl=d;d.addClass(k.css.dataTable);this._name=d.attr(q.DATA_ATTR.DATA_NAME);this._objId="grd"+g.getNewID();this._dataSource=h;this._rowMap={};this._rows=[];this._columns=[];this._isDSFilling=this._isClearing=!1;this._editingRow=this._currentColumn=this._rowSelectorCol=this._actionsCol=this._expanderCol=this._details=this._expandedRow=this._currentRow=null;this._isSorting=!1;this._$contaner=this._$wrapDiv=this._$headerDiv=this._chkWidthInterval=this._dialog=
null;this._wrapTable();this._createColumns();this._bindDS();this._refreshGrid();this._updateColsDim();this._onDSCurrentChanged();a.global._trackSelectable(this)}__extends(c,b);c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);return["row_expanded","row_selected","page_changed","row_state_changed","cell_dblclicked"].concat(a)};c.prototype.addOnRowExpanded=function(a,b){this.addHandler("row_expanded",a,b)};c.prototype.removeOnRowExpanded=function(a){this.removeHandler("row_expanded",
a)};c.prototype.addOnRowSelected=function(a,b){this.addHandler("row_selected",a,b)};c.prototype.removeOnRowSelected=function(a){this.removeHandler("row_selected",a)};c.prototype.addOnPageChanged=function(a,b){this.addHandler("page_changed",a,b)};c.prototype.removeOnPageChanged=function(a){this.removeHandler("page_changed",a)};c.prototype.addOnRowStateChanged=function(a,b){this.addHandler("row_state_changed",a,b)};c.prototype.removeOnRowStateChanged=function(a){this.removeHandler("row_state_changed",
a)};c.prototype.addOnCellDblClicked=function(a,b){this.addHandler("cell_dblclicked",a,b)};c.prototype.removeOnCellDblClicked=function(a){this.removeHandler("cell_dblclicked",a)};c.prototype._setCurrentColumn=function(a){this._currentColumn&&(this._currentColumn.isSelected=!1);if(this._currentColumn=a)this._currentColumn.isSelected=!0};c.prototype._parseColumnAttr=function(b,c){var d={type:"data",title:null,sortable:!1,sortMemberName:null,content:null},e=a.global.parser.parseOptions(b),d=0<e.length?
g.extend(!1,d,e[0]):d;c&&(d.content=r.baseContent.parseContentAttr(c),!d.sortMemberName&&d.content.fieldName&&(d.sortMemberName=d.content.fieldName));return d};c.prototype._findUndeleted=function(a,b){if(!a)return null;if(!a.isDeleted)return a;var c=this.rows.indexOf(a),d=this.rows.length;if(b){c+=1;for(c<d&&(a=this.rows[c]);c<d&&a.isDeleted;)c+=1,c<d&&(a=this.rows[c])}else{c-=1;for(0<=c&&(a=this.rows[c]);0<=c&&a.isDeleted;)c-=1,0<=c&&(a=this.rows[c])}a.isDeleted&&(a=null);return a};c.prototype._updateCurrent=
function(a,b){this.currentRow=a;b&&(a&&!a.isDeleted)&&this._scrollToCurrent(!0)};c.prototype._scrollToCurrent=function(a){var b=this.currentRow;b&&b.scrollIntoView(a)};c.prototype._onRowStateChanged=function(a,b){var c={row:a,val:b,css:null};this.raiseEvent("row_state_changed",c);return c.css};c.prototype._onCellDblClicked=function(a){this.raiseEvent("cell_dblclicked",{cell:a})};c.prototype._onError=function(c,d){var e=b.prototype._onError.call(this,c,d);return!e?a.global._onError(c,d):e};c.prototype._onDSCurrentChanged=
function(){var a=this._dataSource,b;a&&(b=a.currentItem);b?this._updateCurrent(this._rowMap[b._key],!1):this._updateCurrent(null,!1)};c.prototype._onDSCollectionChanged=function(b){var c=this,d;d=r.collection.consts.COLL_CHANGE_TYPE;var e=b.items;switch(b.change_type){case d.RESET:this._isDSFilling||this._refreshGrid();break;case d.ADDED:this._isDSFilling||c._appendItems(b.items);break;case d.REMOVE:e.forEach(function(a){(a=c._rowMap[a._key])&&c._removeRow(a)});break;case d.REMAP_KEY:if(d=c._rowMap[b.old_key])delete c._rowMap[b.old_key],
c._rowMap[b.new_key]=d;break;default:throw Error(g.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}};c.prototype._onDSFill=function(a){var b=this;a.isBegin?(b._isDSFilling=!0,b._isSorting||a.isPageChanged||b._resetColumnsSort()):(b._isDSFilling=!1,a.resetUI?b._refreshGrid():b._appendItems(a.newItems),a.isPageChanged&&setTimeout(function(){b._isDestroyCalled||b._onPageChanged()},100),setTimeout(function(){b._isDestroyCalled||b._updateColsDim()},200))};c.prototype._onPageChanged=function(){this._rowSelectorCol&&
(this._rowSelectorCol.checked=!1);this._scrollToCurrent(!1);this.raiseEvent("page_changed",{})};c.prototype._onItemEdit=function(a,b,c){if(a=this._rowMap[a._key])b?(a._onBeginEdit(),this._editingRow=a):(a._onEndEdit(c),this._editingRow=null),this.raisePropertyChanged("editingRow")};c.prototype._onItemAdded=function(a){var b=this._rowMap[a.item._key];b&&(this._updateCurrent(b,!0),this._options.isHandleAddNew&&!a.isAddNewHandled&&(a.isAddNewHandled=this.showEditDialog()))};c.prototype._onItemStatusChanged=
function(a,b){var c=q.CHANGE_TYPE.DELETED,d=a._changeType,e=this._dataSource,h=this._rowMap[a._key];h&&(d===c?(h.isDeleted=!0,(c=this._findUndeleted(h,!0))||(c=this._findUndeleted(h,!1)),c&&(e.currentItem=c.item)):b===c&&d!==c&&(h.isDeleted=!1))};c.prototype._onRowSelectionChanged=function(a){this.raiseEvent("row_selected",{row:a})};c.prototype._onDSErrorsChanged=function(a){(a=this._rowMap[a._key])&&a.updateErrorState()};c.prototype._resetColumnsSort=function(){this.columns.forEach(function(a){a instanceof
z&&(a.sortOrder=null)})};c.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addHandler("coll_changed",function(b,c){a._onDSCollectionChanged(c)},a._objId),b.addHandler("fill",function(b,c){a._onDSFill(c)},a._objId),b.addOnPropertyChange("currentItem",function(b,c){a._onDSCurrentChanged()},a._objId),b.addHandler("begin_edit",function(b,c){a._onItemEdit(c.item,!0,void 0)},a._objId),b.addHandler("end_edit",function(b,c){a._onItemEdit(c.item,!1,c.isCanceled)},a._objId),b.addHandler("errors_changed",
function(b,c){a._onDSErrorsChanged(c.item)},a._objId),b.addHandler("status_changed",function(c,d){b===c&&a._onItemStatusChanged(d.item,d.oldChangeType)},a._objId),b.addHandler("item_added",function(c,d){b===c&&a._onItemAdded(d)},a._objId))};c.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};c.prototype._getLastRow=function(){if(0===this._rows.length)return null;for(var a=this._rows.length-1,b=this._rows[a];b.isDeleted&&0<a;)a-=1,b=this._rows[a];return b.isDeleted?
null:b};c.prototype._removeRow=function(a){this._expandedRow===a&&this.collapseDetails();if(0!==this._rows.length){var b=a.itemKey,c=g.removeFromArray(this._rows,a);try{-1<c&&(a._isDestroyCalled||a.destroy())}finally{this._rowMap[b]&&delete this._rowMap[b]}}};c.prototype._clearGrid=function(){if(0!==this._rows.length){this._isClearing=!0;try{this.collapseDetails();var b=this._tBodyEl,c=a.global.document.createElement("tbody");this._tableEl.replaceChild(c,b);var d=this._rows;this._rows=[];this._rowMap=
{};d.forEach(function(a){a.destroy()})}finally{this._isClearing=!1}this._currentRow=null}};c.prototype._updateColsDim=function(){var a=0,b=this._$headerDiv;this._columns.forEach(function(b){a+=b.el.offsetWidth});b.width(a);this._columns.forEach(function(a){a.$extcol.width(a.el.offsetWidth);a.$extcol.position({my:"left top",at:"left top",of:b,offset:""+a.el.offsetLeft+" 0"})})};c.prototype._wrapTable=function(){var b=this._$tableEl,c,d,e,h=this;b.wrap(a.global.$("<div></div>").addClass(k.css.wrapDiv));
d=b.parent();d.wrap(a.global.$("<div></div>").addClass(k.css.container));e=d.parent();c=a.global.$("<div></div>").addClass(k.css.headerDiv).insertBefore(d);a.global.$(this._tHeadRow).addClass(k.css.columnInfo);this._$wrapDiv=d;this._$headerDiv=c;this._$contaner=e;this._options.containerCss&&e.addClass(this._options.containerCss);this._options.wrapCss&&d.addClass(this._options.wrapCss);this._options.headerCss&&c.addClass(this._options.headerCss);var f=b.width();this._chkWidthInterval=setInterval(function(){var a=
b.width();f!==a&&(f=a,h._updateColsDim())},1E3)};c.prototype._unWrapTable=function(){var a=this._$tableEl;this._$headerDiv&&(clearInterval(this._chkWidthInterval),this._chkWidthInterval=null,this._$headerDiv.remove(),this._$headerDiv=null,a.unwrap(),this._$wrapDiv=null,a.unwrap(),this._$contaner=null)};c.prototype._createColumns=function(){for(var a=this,b=this._tHeadCells,c=b.length,d=[],e,h,f=0;f<c;f+=1)e=b[f],h=this._parseColumnAttr(e.getAttribute(q.DATA_ATTR.DATA_COLUMN),e.getAttribute(q.DATA_ATTR.DATA_CONTENT)),
d.push({th:e,colinfo:h});d.forEach(function(b){(b=a._createColumn(b))&&a._columns.push(b)})};c.prototype._createColumn=function(b){var c;switch(b.colinfo.type){case "row_expander":this._expanderCol||(this._expanderCol=c=new p(this,b));break;case "row_actions":this._actionsCol||(this._actionsCol=c=new B(this,b));break;case "row_selector":this._rowSelectorCol||(this._rowSelectorCol=c=new t(this,b));break;case "data":c=new z(this,b);break;default:throw Error(g.format(a.ERRS.ERR_GRID_COLTYPE_INVALID,
b.colinfo.type));}return c};c.prototype._appendItems=function(a){if(!this._isDestroyCalled)for(var b,c=this._tBodyEl,d=0,e=a.length;d<e;d+=1)b=a[d],this._rowMap[b._key]||this._createRowForItem(c,b)};c.prototype._onKeyDown=function(a,b){var c=this._dataSource,d=q.KEYS;if(c)switch(a){case d.up:b.preventDefault();c.movePrev(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case d.down:b.preventDefault();c.moveNext(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case d.pageDown:0<
c.pageIndex&&(c.pageIndex-=1);break;case d.pageUp:c.pageIndex+=1;break;case d.enter:this._currentRow&&this._actionsCol&&b.preventDefault();break;case d.esc:this._currentRow&&this._actionsCol&&this._currentRow.isEditing&&b.preventDefault();break;case d.space:this._rowSelectorCol&&(this._currentRow&&!this._currentRow.isEditing)&&b.preventDefault()}};c.prototype._onKeyUp=function(a,b){var c=q.KEYS;if(this._dataSource)switch(a){case c.enter:this._currentRow&&this._actionsCol&&(this._currentRow.isEditing?
this._actionsCol._onOk(this._currentRow.actionsCell):this._actionsCol._onEdit(this._currentRow.actionsCell),b.preventDefault());break;case c.esc:this._currentRow&&this._actionsCol&&this._currentRow.isEditing&&(this._actionsCol._onCancel(this._currentRow.actionsCell),b.preventDefault());break;case c.space:this._rowSelectorCol&&(this._currentRow&&!this._currentRow.isEditing)&&(b.preventDefault(),this._currentRow.isSelected=!this._currentRow.isSelected)}};c.prototype._refreshGrid=function(){var b=this,
c=this._dataSource;b._clearGrid();if(c){var d=a.global.document.createDocumentFragment(),e=this._tBodyEl,h=a.global.document.createElement("tbody");c.items.forEach(function(a,c){b._createRowForItem(d,a,c)});h.appendChild(d);b._tableEl.replaceChild(h,e)}};c.prototype._createRowForItem=function(b,c,d){d=a.global.document.createElement("tr");d=new w(this,{tr:d,item:c});this._rowMap[c._key]=d;this._rows.push(d);b.appendChild(d.el);return d};c.prototype._createDetails=function(){var b=this._options.details.templateID,
c=a.global.document.createElement("tr");return new v(this,{tr:c,details_id:b})};c.prototype._expandDetails=function(a,b){if(this._options.details){this._details||(this._details=this._createDetails());var c=this._expandedRow;c===a&&c&&b||(this._expandedRow=null,this._details.parentRow=null,b?(this._expandedRow=a,this._details.parentRow=a,this._expandedRow.expanderCell._toggleImage()):(this._expandedRow=null,this._details.parentRow=null,c&&c.expanderCell._toggleImage()),c!==a&&c&&c.expanderCell._toggleImage(),
this.raiseEvent("row_expanded",{old_expandedRow:c,expandedRow:a,isExpanded:b}))}};c.prototype.sortByColumn=function(a){var b=this,c=this._dataSource,d=a.sortMemberName.split(";");b._isSorting=!0;c.sort(d,a.sortOrder).always(function(){b._isSorting=!1})};c.prototype.selectRows=function(a){this._rows.forEach(function(b){b.isDeleted||(b.isSelected=a)})};c.prototype.findRowByItem=function(a){a=this._rowMap[a._key];return!a?null:a};c.prototype.collapseDetails=function(){if(this._details){var a=this._expandedRow;
a&&(this._expandedRow=null,this._details._setParentRow(null),this.raiseEvent("row_expanded",{old_expandedRow:a,expandedRow:null,isExpanded:!1}))}};c.prototype.getSelectedRows=function(){var a=[];this._rows.forEach(function(b){b.isDeleted||b.isSelected&&a.push(b)});return a};c.prototype.showEditDialog=function(){if(!this._options.editor||!this._options.editor.templateID||!this._editingRow)return!1;var a,b=this._editingRow.item;b.isEditing||b.beginEdit();this._dialog?this._dialog.dataContext=b:(a=g.extend(!1,
{dataContext:b},this._options.editor),this._dialog=new r.datadialog.DataEditDialog(this.app,a));this._dialog.canRefresh=!!this.dataSource.permissions.canRefreshRow&&!b._isNew;this._dialog.show();return!0};c.prototype.scrollToCurrent=function(a){this._scrollToCurrent(a)};c.prototype.addNew=function(){var b=this._dataSource;try{b.addNew(),this.showEditDialog()}catch(c){a.global.reThrow(c,this._onError(c,this))}};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global._untrackSelectable(this),
this._details&&(this._details.destroy(),this._details=null),this._dialog&&(this._dialog.destroy(),this._dialog=null),this._clearGrid(),this._unbindDS(),this._dataSource=null,this._unWrapTable(),this._$tableEl.removeClass(k.css.dataTable),a.global.$(this._tHeadRow).removeClass(k.css.columnInfo),this._app=this._$tableEl=this._tableEl=null,b.prototype.destroy.call(this))};Object.defineProperty(c.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"$container",{get:function(){return this._$contaner},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_tBodyEl",{get:function(){return this._tableEl.tBodies[0]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_tHeadEl",{get:function(){return this._tableEl.tHead},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_tFootEl",{get:function(){return this._tableEl.tFoot},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_tHeadRow",{get:function(){if(!this._tHeadEl)return null;
var a=this._tHeadEl.rows;return 0===a.length?null:a[0]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_tHeadCells",{get:function(){var b=this._tHeadRow;return!b?[]:a.ArrayHelper.fromCollection(b.cells)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"containerEl",{get:function(){return this._$contaner.get(0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){a!==this._dataSource&&(null!==this._dataSource&&this._unbindDS(),this._clearGrid(),this._dataSource=a,null!==this._dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"currentRow",{get:function(){return this._currentRow},set:function(a){var b=this._dataSource,c=this._currentRow,d=!1;b&&(c!==a&&(this._currentRow=a,c&&(c.isCurrent=!1),a&&(a.isCurrent=!0),d=!0),a?a.item!==b.currentItem&&(b.currentItem=a.item):b.currentItem=null,d&&this.raisePropertyChanged("currentRow"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"editingRow",{get:function(){return this._editingRow},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCanEdit",{get:function(){if(null!==this._options.isCanEdit)return this._options.isCanEdit;var a=this._dataSource;return!!a&&a.permissions.canEditRow},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCanDelete",{get:function(){if(null!==this._options.isCanDelete)return this._options.isCanDelete;var a=this._dataSource;return!!a&&a.permissions.canDeleteRow},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"isCanAddNew",{get:function(){var a=this._dataSource;return!!a&&a.permissions.canAddRow},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isUseScrollInto",{get:function(){return this._options.isUseScrollInto},set:function(a){this._options.isUseScrollInto=a},enumerable:!0,configurable:!0});return c}(a.BaseObject);k.DataGrid=C;f=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(b){a.prototype._init.call(this,
b);this._gridEventCommand=this._grid=this._dataSource=null;this._options=b};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._dataSource&&(this.dataSource=null),this._gridEventCommand=null,a.prototype.destroy.call(this))};b.prototype._createGrid=function(){this._grid=new C(this.app,this._el,this._dataSource,this._options);this._bindGridEvents()};b.prototype._bindGridEvents=function(){if(this._grid){var a=this;this._grid.addOnRowExpanded(function(b,c){a.invokeGridEvent("row_expanded",
c)},this.uniqueID);this._grid.addOnRowSelected(function(b,c){a.invokeGridEvent("row_selected",c)},this.uniqueID);this._grid.addOnPageChanged(function(b,c){a.invokeGridEvent("page_changed",c)},this.uniqueID);this._grid.addOnCellDblClicked(function(b,c){a.invokeGridEvent("cell_dblclicked",c)},this.uniqueID);this._grid.addOnRowStateChanged(function(b,c){a.invokeGridEvent("row_state_changed",c)},this.uniqueID);this._grid.addOnDestroyed(function(b,c){a._grid=null},this.uniqueID)}};b.prototype.invokeGridEvent=
function(a,b){var c={eventName:a,args:b};this._gridEventCommand&&this._gridEventCommand.execute(this,c)};b.prototype.toString=function(){return"GridElView"};Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){this._dataSource!==a&&(this._dataSource=a,this._grid&&!this._grid._isDestroyCalled&&(this._grid.destroy(),this._grid=null),this._dataSource&&this._createGrid(),this.invokePropChanged("grid"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"gridEventCommand",{get:function(){return this._gridEventCommand},set:function(a){a!==this._gridEventCommand&&(this._gridEventCommand&&this.invokeGridEvent("command_disconnected",{}),(this._gridEventCommand=a)&&this.invokeGridEvent("command_connected",{}))},enumerable:!0,configurable:!0});return b}(r.baseElView.BaseElView);k.GridElView=f;a.global.registerElView("table",f);a.global.registerElView("datagrid",
f);a.global.onModuleLoaded("datagrid",k)})(r.datagrid||(r.datagrid={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils;k.css={pager:"ria-data-pager",info:"pager-info",currentPage:"pager-current-page",otherPage:"pager-other-page"};var q=a.localizable.PAGER,e=function(e){function b(b,c,h){e.call(this);this._el=b;this._$el=a.global.$(this._el);this._objId="pgr"+g.getNewID();if(c&&!(c instanceof r.collection.Collection))throw Error(a.ERRS.ERR_PAGER_DATASRC_INVALID);this._dataSource=c;this._showTip=g.check.isNt(h.showTip)?!0:!!h.showTip;this._showInfo=g.check.isNt(h.showInfo)?
!1:!!h.showInfo;this._showFirstAndLast=g.check.isNt(h.showFirstAndLast)?!0:!!h.showFirstAndLast;this._showPreviousAndNext=g.check.isNt(h.showPreviousAndNext)?!1:!!h.showPreviousAndNext;this._showNumbers=g.check.isNt(h.showNumbers)?!0:!!h.showNumbers;this._rowCount=this._rowsPerPage=0;this._currentPage=1;this._useSlider=g.check.isNt(h.useSlider)?!0:!!h.useSlider;this._sliderSize=g.check.isNt(h.sliderSize)?25:h.sliderSize;this._hideOnSinglePage=g.check.isNt(h.hideOnSinglePage)?!0:!!h.hideOnSinglePage;
this._$el.addClass(k.css.pager);this._dataSource&&this._bindDS()}__extends(b,e);b.prototype._createElement=function(b){return a.global.$(a.global.document.createElement(b))};b.prototype._render=function(){var a=this._$el,b,e;this._clearContent();if(!(0>=this.rowsPerPage)&&(b=this.rowCount,0!=b&&(b=this.currentPage,0!=b)))if(e=this.pageCount,this.hideOnSinglePage&&1==e)a.hide();else{a.show();if(this.showInfo){var f=this._createElement("span"),l=g.format(q.pageInfo,b,e);f.addClass(k.css.info).text(l).appendTo(a)}this.showFirstAndLast&&
1!=b&&a.append(this._createFirst());this.showPreviousAndNext&&1!=b&&a.append(this._createPrevious());if(this.showNumbers){var f=1,l=e,r=this.sliderSize;this.useSlider&&0<r&&(f=Math.floor((r-1)/2),l=b+f+(r-1)%2,f=b-f,1>f&&(l+=1-f,f=1),l>e&&(f-=l-e,1>f&&(f=1),l=e));for(;f<=l;f++)f===b?a.append(this._createCurrent()):a.append(this._createOther(f))}this.showPreviousAndNext&&b!=e&&a.append(this._createNext());this.showFirstAndLast&&b!=e&&a.append(this._createLast())}};b.prototype._setDSPageIndex=function(a){this.dataSource.pageIndex=
a-1};b.prototype._onPageSizeChanged=function(a){this.rowsPerPage=a.pageSize};b.prototype._onPageIndexChanged=function(a){this.currentPage=a.pageIndex+1};b.prototype._onTotalCountChanged=function(a){this.rowCount=a.totalCount};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._clearContent(),this._$el.removeClass(k.css.pager),this._$el=this._el=null,e.prototype.destroy.call(this))};b.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addOnPropertyChange("pageIndex",
function(e,f){a._onPageIndexChanged(b)},a._objId),b.addOnPropertyChange("pageSize",function(e,f){a._onPageSizeChanged(b)},a._objId),b.addOnPropertyChange("totalCount",function(e,f){a._onTotalCountChanged(b)},a._objId),this._currentPage=b.pageIndex+1,this._rowsPerPage=b.pageSize,this._rowCount=b.totalCount,this._render())};b.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};b.prototype._clearContent=function(){this._$el.empty()};b.prototype._createLink=function(a,
b,e){var f=this._createElement("a"),k=this;f.text(""+b);f.attr("href","javascript:void(0)");e&&g.addToolTip(f,e);f.click(function(b){b.preventDefault();k._setDSPageIndex(a);k.currentPage=a});return f};b.prototype._createFirst=function(){var a=this._createElement("span"),b;this.showTip&&(b=q.firstPageTip);b=this._createLink(1,q.firstText,b);a.addClass(k.css.otherPage).append(b);return a};b.prototype._createPrevious=function(){var a=this._createElement("span"),b=this.currentPage-1,e;this.showTip&&(e=
g.format(q.prevPageTip,b));b=this._createLink(b,q.previousText,e);a.addClass(k.css.otherPage).append(b);return a};b.prototype._createCurrent=function(){var a=this._createElement("span"),b=this.currentPage;a.text(""+b);this.showTip&&g.addToolTip(a,this._buildTip(b));a.addClass(k.css.currentPage);return a};b.prototype._createOther=function(a){var b=this._createElement("span"),e;this.showTip&&(e=this._buildTip(a));a=this._createLink(a,""+a,e);b.addClass(k.css.otherPage);b.append(a);return b};b.prototype._createNext=
function(){var a=this._createElement("span"),b=this.currentPage+1,e;this.showTip&&(e=g.format(q.nextPageTip,b));b=this._createLink(b,q.nextText,e);a.addClass(k.css.otherPage).append(b);return a};b.prototype._createLast=function(){var a=this._createElement("span"),b;this.showTip&&(b=q.lastPageTip);b=this._createLink(this.pageCount,q.lastText,b);a.addClass(k.css.otherPage).append(b);return a};b.prototype._buildTip=function(a){var b=this.rowsPerPage,e=this.rowCount,f=(a-1)*b+1,b=a==this.pageCount?e:
a*b,k="";return k=a==this.currentPage?g.format(q.showingTip,f,b,e):g.format(q.showTip,f,b,e)};b.prototype.toString=function(){return"Pager"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){a!==this._dataSource&&(null!==this._dataSource&&this._unbindDS(),this._dataSource=a,null!==this._dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pageCount",{get:function(){var a=this.rowCount,b=this.rowsPerPage;return 0===a||0===b?0:0===a%b?a/b:a=Math.floor(a/b)+1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rowCount",{get:function(){return this._rowCount},set:function(a){this._rowCount!=a&&(this._rowCount=a,this._render(),this.raisePropertyChanged("rowCount"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rowsPerPage",{get:function(){return this._rowsPerPage},
set:function(a){this._rowsPerPage!=a&&(this._rowsPerPage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"currentPage",{get:function(){return this._currentPage},set:function(a){this._currentPage!=a&&(this._currentPage=a,this._render(),this.raisePropertyChanged("currentPage"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"useSlider",{get:function(){return this._useSlider},set:function(a){this._useSlider!=a&&(this._useSlider=a,this._render())},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sliderSize",{get:function(){return this._sliderSize},set:function(a){this._sliderSize!=a&&(this._sliderSize=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hideOnSinglePage",{get:function(){return this._hideOnSinglePage},set:function(a){this._hideOnSinglePage!=a&&(this._hideOnSinglePage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showTip",{get:function(){return this._showTip},
set:function(a){this._showTip!==a&&(this._showTip=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showInfo",{get:function(){return this._showInfo},set:function(a){this._showInfo!==a&&(this._showInfo=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showFirstAndLast",{get:function(){return this._showFirstAndLast},set:function(a){this._showFirstAndLast!==a&&(this._showFirstAndLast=a,this._render())},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"showPreviousAndNext",{get:function(){return this._showPreviousAndNext},set:function(a){this._showPreviousAndNext!==a&&(this._showPreviousAndNext=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showNumbers",{get:function(){return this._showNumbers},set:function(a){this._showNumbers!==a&&(this._showNumbers=a,this._render())},enumerable:!0,configurable:!0});return b}(a.BaseObject);k.Pager=e;var f=function(a){function b(b,c,e){this._pager=
this._dataSource=null;this._options=e;a.call(this,b,c,e)}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._pager&&!this._pager._isDestroyCalled&&this._pager.destroy(),this._dataSource=this._pager=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"PagerElView"};Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){var b=this;this._dataSource!==a&&(this._dataSource=a,this._pager&&
this._pager.destroy(),this._pager=null,this._dataSource&&this._dataSource.isPagingEnabled&&(this._pager=new e(this._el,this._dataSource,this._options),this._pager.addOnDestroyed(function(){b._pager=null})),b.invokePropChanged("pager"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pager",{get:function(){return this._pager},enumerable:!0,configurable:!0});return b}(r.baseElView.BaseElView);k.PagerElView=f;a.global.registerElView("pager",f);a.global.onModuleLoaded("pager",k)})(r.pager||
(r.pager={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts;k.css={stackpanel:"ria-stackpanel",item:"stackpanel-item",currentItem:"current-item"};var e=function(e){function b(b,c,h,f){e.call(this);this._app=b;this._el=c;this._$el=a.global.$(this._el);this._objId="pnl"+g.getNewID();if(h&&!(h instanceof r.collection.Collection))throw Error(a.ERRS.ERR_STACKPNL_DATASRC_INVALID);this._dataSource=h;this._isDSFilling=!1;this._orientation=f.orientation||"horizontal";this._templateID=f.templateID;
this._currentItem=null;this._$el.addClass(k.css.stackpanel);this._itemMap={};if(!this._templateID)throw Error(a.ERRS.ERR_STACKPNL_TEMPLATE_INVALID);this._dataSource&&this._bindDS();a.global._trackSelectable(this)}__extends(b,e);b.prototype._getEventNames=function(){var a=e.prototype._getEventNames.call(this);return["item_clicked"].concat(a)};b.prototype.addOnItemClicked=function(a,b){this.addHandler("item_clicked",a,b)};b.prototype.removeOnItemClicked=function(a){this.removeHandler("item_clicked",
a)};b.prototype._onKeyDown=function(a,b){var e=this._dataSource,f=q.KEYS;if(e)if("horizontal"==this._orientation)switch(a){case f.left:b.preventDefault();e.movePrev(!0)&&this.scrollIntoView(e.currentItem);break;case f.right:b.preventDefault(),e.moveNext(!0)&&this.scrollIntoView(e.currentItem)}else switch(a){case f.up:b.preventDefault();e.movePrev(!0)&&this.scrollIntoView(e.currentItem);break;case f.down:b.preventDefault(),e.moveNext(!0)&&this.scrollIntoView(e.currentItem)}};b.prototype._onKeyUp=function(a,
b){};b.prototype._updateCurrent=function(b,c){var e=this._currentItem;if(e!==b){this._currentItem=b;e&&(e=this._itemMap[e._key])&&a.global.$(e.div).removeClass(k.css.currentItem);if(b&&(e=this._itemMap[b._key]))a.global.$(e.div).addClass(k.css.currentItem),c&&e.div.scrollIntoView(!1);this.raisePropertyChanged("currentItem")}};b.prototype._onDSCurrentChanged=function(a){(a=this._dataSource.currentItem)?this._updateCurrent(a,!0):this._updateCurrent(null,!1)};b.prototype._onDSCollectionChanged=function(b){var c=
this,e=r.collection.consts.COLL_CHANGE_TYPE,f=b.items;switch(b.change_type){case e.RESET:this._isDSFilling||this._refresh();break;case e.ADDED:this._isDSFilling||c._appendItems(f);break;case e.REMOVE:f.forEach(function(a){c._removeItem(a)});break;case e.REMAP_KEY:if(e=c._itemMap[b.old_key])delete c._itemMap[b.old_key],c._itemMap[b.new_key]=e,e.div.setAttribute(q.DATA_ATTR.DATA_ITEM_KEY,b.new_key);break;default:throw Error(g.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}};b.prototype._onDSFill=
function(a){a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,a.resetUI?this._refresh():this._appendItems(a.newItems))};b.prototype._onItemStatusChanged=function(b,c){var e=q.CHANGE_TYPE.DELETED,f=b._changeType,g=this._itemMap[b._key];g&&(f===e?a.global.$(g.div).hide():c===e&&f!==e&&a.global.$(g.div).show())};b.prototype._createTemplate=function(a){var b=new r.template.Template(this.app,this._templateID);b.dataContext=a;return b};b.prototype._appendItems=function(a){if(!this._isDestroyCalled){var b=
this;a.forEach(function(a){b._itemMap[a._key]||b._appendItem(a)})}};b.prototype._appendItem=function(a){if(a._key){var b=this,e=b._createElement("div"),f=e.get(0),g=b._createTemplate(a);e.addClass(k.css.item);e.append(g.el);"horizontal"==this._orientation&&e.css("display","inline-block");b._$el.append(e);e.attr(q.DATA_ATTR.DATA_ITEM_KEY,a._key);e.click(function(a){a=this.getAttribute(q.DATA_ATTR.DATA_ITEM_KEY);(a=b._itemMap[a])&&b._onItemClicked(a.div,a.item)});b._itemMap[a._key]={div:f,template:g,
item:a}}};b.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addOnCollChanged(function(e,f){b===e&&a._onDSCollectionChanged(f)},a._objId),b.addOnFill(function(e,f){b===e&&a._onDSFill(f)},a._objId),b.addOnPropertyChange("currentItem",function(e,f){b===e&&a._onDSCurrentChanged(f)},a._objId),b.addOnStatusChanged(function(e,f){b===e&&a._onItemStatusChanged(f.item,f.oldChangeType)},a._objId),this._refresh())};b.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};
b.prototype._createElement=function(b){return a.global.$(a.global.document.createElement(b))};b.prototype._onItemClicked=function(a,b){this._updateCurrent(b,!1);this._dataSource.currentItem=b;this.raiseEvent("item_clicked",{item:b})};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global._untrackSelectable(this),this._unbindDS(),this._clearContent(),this._$el.removeClass(k.css.stackpanel),this._currentItem=this._$el=this._el=null,this._itemMap={},this._app=null,e.prototype.destroy.call(this))};
b.prototype._clearContent=function(){var a=this;a._$el.empty();g.forEachProp(a._itemMap,function(b){a._removeItemByKey(b)})};b.prototype._removeItemByKey=function(a){var b=this._itemMap[a];b&&(delete this._itemMap[a],b.template.destroy())};b.prototype._removeItem=function(b){b=b._key;var c=this._itemMap[b];c&&(delete this._itemMap[b],c.template.destroy(),a.global.$(c.div).remove())};b.prototype._refresh=function(){var a=this._dataSource,b=this;this._clearContent();a&&a.forEach(function(a){b._appendItem(a)})};
b.prototype.scrollIntoView=function(a){a&&(a=this._itemMap[a._key])&&a.div.scrollIntoView(!1)};b.prototype.getDivElementByItem=function(a){a=this._itemMap[a._key];return!a?null:a.div};b.prototype.toString=function(){return"StackPanel"};Object.defineProperty(b.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"containerEl",{get:function(){return this._el},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._dataSource},set:function(a){a!==this._dataSource&&(null!==this._dataSource&&this._unbindDS(),this._dataSource=a,null!==this._dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"currentItem",{get:function(){return this._currentItem},
enumerable:!0,configurable:!0});return b}(a.BaseObject);k.StackPanel=e;var f=function(a){function b(b,c,e){this._panel=this._dataSource=null;this._options=e;a.call(this,b,c,e)}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._panel&&!this._panel._isDestroyCalled&&this._panel.destroy(),this._dataSource=this._panel=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"StackPanelElView"};Object.defineProperty(b.prototype,"dataSource",
{get:function(){return this._dataSource},set:function(a){var b=this;this._dataSource!==a&&(this._dataSource=a,this._panel&&this._panel.destroy(),this._panel=null,this._dataSource&&(this._panel=new e(this.app,this._el,this._dataSource,this._options),this._panel.addOnDestroyed(function(){b._panel=null})),b.invokePropChanged("panel"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0});return b}(r.baseElView.BaseElView);
k.StackPanelElView=f;a.global.registerElView("stackpanel",f);a.global.onModuleLoaded("stackpanel",k)})(r.stackpanel||(r.stackpanel={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(k){var g=a.global.utils,q=a.global.consts;k.css={dataform:"ria-dataform"};var e=a.localizable.VALIDATE,f=function(b){function d(c,d){b.call(this);var e=this,f;this._app=c;this._el=d;this._$el=a.global.$(this._el);this._objId="frm"+g.getNewID();this._dataContext=null;this._$el.addClass(k.css.dataform);this._isDisabled=this._isEditing=!1;this._content=[];this._lfTime=null;this._supportErrNotify=this._supportEdit=this._contentCreated=!1;this._errors=this._parentDataForm=
null;if(f=this._getParentDataForm(this._el))e._parentDataForm=c.getElementView(f),e._parentDataForm.addOnDestroyed(function(a,b){e._isDestroyCalled||e.destroy()},e._objId)}__extends(d,b);Object.defineProperty(d.prototype,"_DATA_CONTENT_SELECTOR",{get:function(){return"*["+q.DATA_ATTR.DATA_CONTENT+"]:not(["+q.DATA_ATTR.DATA_COLUMN+"])"},enumerable:!0,configurable:!0});d.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],d=0,e=a.length;d<e;d+=1)g.check.isBinding(a[d])&&
b.push(a[d]);return b};d.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],d=0,e=a.length;d<e;d+=1)g.check.isElView(a[d])&&b.push(a[d]);return b};d.prototype._updateIsDisabled=function(){var a,b,d,e=this._getBindings(),f=this._getElViews(),g=this.app._getElViewType(q.ELVIEW_NM.DATAFORM);a=0;for(b=e.length;a<b;a+=1)d=e[a],d.isDisabled=this._isDisabled;a=0;for(b=f.length;a<b;a+=1)d=f[a],d instanceof g&&d.form&&(d.form.isDisabled=this._isDisabled)};d.prototype._updateContent=
function(){var b=this._dataContext,d=this;if(this._contentCreated)this._content.forEach(function(a){a.dataContext=b;a.isEditing=d.isEditing}),this._getBindings().forEach(function(a){a.isSourceFixed||(a.source=b)});else if(b){var e=g.check.isFunction(b.getFieldInfo),f=a.ArrayHelper.fromList(this._el.querySelectorAll(d._DATA_CONTENT_SELECTOR)),k=this.isEditing;f.forEach(function(f){if(d._getParentDataForm(f)===d._el){var l=f.getAttribute(q.DATA_ATTR.DATA_CONTENT),l=r.baseContent.parseContentAttr(l);
if(l.fieldName&&!l.fieldInfo){if(!e)throw Error(a.ERRS.ERR_DCTX_HAS_NO_FIELDINFO);l.fieldInfo=b.getFieldInfo(l.fieldName);if(!l.fieldInfo)throw Error(g.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",l.fieldName));}var v=d.app._getContentType(l);(f=d.app._getContent(v,l,f,b,k))&&d._content.push(f)}});this._lfTime=d.app._bindElements(this._el,b,!0);this._contentCreated=!0}};d.prototype._getParentDataForm=function(b){if(!b)return null;b=b.parentElement;var d;if(b){if(b===this._el)return this._el;d=b.getAttribute(q.DATA_ATTR.DATA_VIEW);
if(!d)return this._getParentDataForm(b);d=a.global.parser.parseOptions(d);return 0<d.length&&d[0].name==q.ELVIEW_NM.DATAFORM?b:this._getParentDataForm(b)}return null};d.prototype._onDSErrorsChanged=function(){this.validationErrors=this._dataContext.getAllErrors()};d.prototype._bindDS=function(){var a=this._dataContext,b=this;a&&(a.addOnDestroyed(function(a,c){b.dataContext=null},b._objId),this._supportEdit&&a.addOnPropertyChange("isEditing",function(a,c){b.isEditing=a.isEditing},b._objId),this._supportErrNotify&&
a.addOnErrorsChanged(function(a,c){b._onDSErrorsChanged()},b._objId))};d.prototype._unbindDS=function(){var a=this._dataContext;this.validationErrors=null;a&&!a._isDestroyCalled&&a.removeNSHandlers(this._objId)};d.prototype._clearContent=function(){this._content.forEach(function(a){a.destroy()});this._content=[];this._lfTime&&(this._lfTime.destroy(),this._lfTime=null);this._contentCreated=!1};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clearContent();this._$el.removeClass(k.css.dataform);
this._$el=this._el=null;this._unbindDS();var a=this._parentDataForm;this._parentDataForm=null;a&&!a._isDestroyCalled&&a.removeNSHandlers(this._objId);this._dataContext=null;this._contentCreated=!1;this._app=null;b.prototype.destroy.call(this)}};d.prototype.toString=function(){return"DataForm"};Object.defineProperty(d.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"dataContext",{get:function(){return this._dataContext},set:function(b){var d;try{if(b!==this._dataContext){if(b&&!g.check.isBaseObj(b))throw Error(a.ERRS.ERR_DATAFRM_DCTX_INVALID);this._unbindDS();this._supportErrNotify=this._supportEdit=!1;if(d=this._dataContext=b)this._supportEdit=g.check.isEditable(d),this._supportErrNotify=r.binding._checkIsErrorNotification(d);this._bindDS();this._updateContent();this.raisePropertyChanged("dataContext");d&&(this._supportEdit&&
this._isEditing!==d.isEditing&&(this.isEditing=d.isEditing),this._supportErrNotify&&this._onDSErrorsChanged())}}catch(e){a.global.reThrow(e,this._onError(e,this))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEditing",{get:function(){return this._isEditing},set:function(b){var d=this._dataContext;if(d){var e=this._isEditing,f;if(!this._supportEdit&&b!==e)this._isEditing=b,this._updateContent(),this.raisePropertyChanged("isEditing");else{this._supportEdit&&(f=d);if(b!==e)try{b?
f.beginEdit():f.endEdit()}catch(g){a.global.reThrow(g,this._onError(g,d))}this._supportEdit&&f.isEditing!==e&&(this._isEditing=f.isEditing,this._updateContent(),this.raisePropertyChanged("isEditing"))}}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"validationErrors",{get:function(){return this._errors},set:function(a){a!==this._errors&&(this._errors=a,this.raisePropertyChanged("validationErrors"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isDisabled",
{get:function(){return this._isDisabled},set:function(a){this._isDisabled!==a&&(this._isDisabled=!!a,this._updateIsDisabled(),this.raisePropertyChanged("isDisabled"))},enumerable:!0,configurable:!0});return d}(a.BaseObject);k.DataForm=f;var l=function(b){function d(a,d,e){this._form=this._dataContext=null;this._options=e;b.call(this,a,d,e)}__extends(d,b);d.prototype._getErrorTipInfo=function(a){var b=["<b>",e.errorInfo,"</b>","<ul>"];a.forEach(function(a){var c=a.fieldName,d="";c&&(d=e.errorField+
" "+c);a.errors.forEach(function(a){d=d?d+" -> "+a:a});b.push("<li>"+d+"</li>");d=""});b.push("</ul>");return b.join("")};d.prototype._updateErrorUI=function(b,d){if(b){var e=this.$el;if(d&&0<d.length){var f,k=a.global.getImagePath("warning.png");f=a.global.$('<img name="error_info" alt="error_info" class="error-info" />');e.prepend(f);f.get(0).src=k;g.addToolTip(f,this._getErrorTipInfo(d),r.baseElView.css.errorTip);this._setFieldError(!0)}else e.children('img[name="error_info"]').remove(),this._setFieldError(!1)}};
d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._form&&!this._form._isDestroyCalled&&this._form.destroy(),this._dataContext=this._form=null,b.prototype.destroy.call(this))};d.prototype.toString=function(){return"DataFormElView"};Object.defineProperty(d.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){var b=this;this._dataContext!==a&&(this._dataContext=a,this._form||(this._form=new f(this.app,this._el)),this._form.dataContext=this._dataContext,
this._form.addOnDestroyed(function(){b._form=null}),this._form.addOnPropertyChange("validationErrors",function(a,c){b.validationErrors=a.validationErrors},this._objId),b.invokePropChanged("form"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"form",{get:function(){return this._form},enumerable:!0,configurable:!0});return d}(r.baseElView.BaseElView);k.DataFormElView=l;a.global.registerType("DataFormElView",l);a.global.registerElView(q.ELVIEW_NM.DATAFORM,l);a.global.onModuleLoaded("dataform",
k)})(r.dataform||(r.dataform={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){var r=function(k){function g(q){k.call(this);var e="default",f=[];q&&(q.application_name&&(e=q.application_name),q.user_modules&&(f=q.user_modules));if(a.global.findApp(e))throw Error(a.global.utils.format(a.ERRS.ERR_APP_NAME_NOT_UNIQUE,e));this._app_name=e;this._objId="app:"+a.global.utils.getNewID();this._options=q;this._objLifeTime=null;this._ELV_STORE_KEY=a.global.consts.DATA_ATTR.EL_VIEW_KEY+g._newInstanceNum;g._newInstanceNum+=1;this._contentFactory=null;this._contentFactories=
[];this._objMaps=[];this._exports={};this._modules={};this._elViewStore={};this._nextElViewStoreKey=0;this._userCode={};this._viewModels={};this._initModules();this._initUserModules(f);var l=null;this._contentFactories.forEach(function(a){l=a(l)});this._contentFactory=l;a.global._registerApp(this)}__extends(g,k);g._newInstanceNum=1;Object.defineProperty(g.prototype,"_DATA_BIND_SELECTOR",{get:function(){return["*[",a.global.consts.DATA_ATTR.DATA_BIND,"]"].join("")},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"_DATA_VIEW_SELECTOR",{get:function(){return["*[",a.global.consts.DATA_ATTR.DATA_VIEW,"]"].join("")},enumerable:!0,configurable:!0});g.prototype._cleanUpObjMaps=function(){var g=this;this._objMaps.forEach(function(e){a.global.utils.forEachProp(e,function(f){f=e[f];f instanceof a.BaseObject&&(f._isDestroyed||f.removeNSHandlers(g.uniqueID))})});this._objMaps=[]};g.prototype._initModules=function(){var g=this;g.global.moduleNames.forEach(function(e){a.MOD[e]&&a.MOD[e].initModule&&
a.MOD[e].initModule(g)})};g.prototype._initUserModules=function(a){var e=this;a.forEach(function(a){e._modules[a.name]=a.initFn(e)})};g.prototype._onError=function(g,e){if(a.global._checkIsDummy(g))return!0;var f=k.prototype._onError.call(this,g,e);return!f?a.global._onError(g,e):f};g.prototype._getElView=function(a){return(a=a.getAttribute(this._ELV_STORE_KEY))?this._elViewStore[a]:null};g.prototype._setElView=function(a,e){var f=a.getAttribute(this._ELV_STORE_KEY);f?e?this._elViewStore[f]=e:(a.removeAttribute(this._ELV_STORE_KEY),
delete this._elViewStore[f]):e&&(f="s_"+this._nextElViewStoreKey,this._nextElViewStoreKey+=1,a.setAttribute(this._ELV_STORE_KEY,f),this._elViewStore[f]=e)};g.prototype._bindTemplateElements=function(g){var e=this,f=e.global,k=a.ArrayHelper.fromList(g.querySelectorAll(e._DATA_BIND_SELECTOR+", "+e._DATA_VIEW_SELECTOR)),b=a.MOD.utils.LifeTimeScope.create();(g.hasAttribute(f.consts.DATA_ATTR.DATA_BIND)||g.hasAttribute(f.consts.DATA_ATTR.DATA_VIEW))&&k.push(g);k.forEach(function(d){var c,h,g,k,l;if(!e.global.utils.check.isInsideDataForm(d)&&
(l=e.getElementView(d),b.addObj(l),d.hasAttribute(f.consts.DATA_ATTR.DATA_VIEW)&&d.removeAttribute(f.consts.DATA_ATTR.DATA_VIEW),c=d.getAttribute(f.consts.DATA_ATTR.DATA_BIND))){d.removeAttribute(f.consts.DATA_ATTR.DATA_BIND);k=f.parser.parseOptions(c);c=0;for(h=k.length;c<h;c+=1)d=a.MOD.baseContent.getBindingOptions(e,k[c],l,null),g=e.bind(d),d.target=null,b.addObj(g)}});return b};g.prototype._bindElements=function(g,e,f){var k=this,b=k.global;g=g||b.document;g=a.ArrayHelper.fromList(g.querySelectorAll(k._DATA_BIND_SELECTOR+
", "+k._DATA_VIEW_SELECTOR));var d=a.MOD.utils.LifeTimeScope.create();g.forEach(function(c){var h,g;if(f||!b.utils.check.isInsideDataForm(c)){if(!f&&(c.hasAttribute(b.consts.DATA_ATTR.DATA_APP)&&(h=c.getAttribute(b.consts.DATA_ATTR.DATA_APP)),h&&k.appName!==h||!h&&"default"!==k.appName))return;h=k.getElementView(c);d.addObj(h);if(c=c.getAttribute(b.consts.DATA_ATTR.DATA_BIND)){c=b.parser.parseOptions(c);for(var q=0,r=c.length;q<r;q+=1)g=a.MOD.baseContent.getBindingOptions(k,c[q],h,e),d.addObj(k.bind(g))}}});
return d};g.prototype._getContent=function(a,e,f,g,b){return new a(this,f,e,g,b)};g.prototype._getContentType=function(a){return this.contentFactory.getContentType(a)};g.prototype._destroyBindings=function(){this._objLifeTime&&(this._objLifeTime.destroy(),this._objLifeTime=null)};g.prototype._setUpBindings=function(){var a=this.global.document;this._destroyBindings();this._objLifeTime=this._bindElements(a,this,!1)};g.prototype.registerElView=function(g,e){var f="elvws."+g;if(a.global._getObject(this,
f))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,g));a.global._registerObject(this,f,e)};g.prototype.getElementView=function(g){var e,f,k;if(f=this._getElView(g))return f;if(g.hasAttribute(a.global.consts.DATA_ATTR.DATA_VIEW)&&(f=g.getAttribute(a.global.consts.DATA_ATTR.DATA_VIEW),(f=a.global.parser.parseOptions(f))&&0<f.length)){f=f[0];if(f.name&&"default"!=f.name&&(e=this._getElViewType(f.name),!e))throw Error(a.global.utils.format(a.ERRS.ERR_ELVIEW_NOT_REGISTERED,f.name));
f.options&&(k=f.options)}if(!e){f=g.nodeName.toLowerCase();switch(f){case "input":e=g.getAttribute("type");f=f+":"+e;e=this._getElViewType(f);break;default:e=this._getElViewType(f)}if(!e)throw Error(a.global.utils.format(a.ERRS.ERR_ELVIEW_NOT_CREATED,f));}return f=new e(this,g,k||{})};g.prototype.bind=function(g){return new a.MOD.binding.Binding(g)};g.prototype.registerContentFactory=function(a){this._contentFactories.push(a)};g.prototype.registerConverter=function(g,e){var f="converters."+g;if(a.global._getObject(this,
f))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,g));a.global._registerObject(this,f,e)};g.prototype.getConverter=function(g){var e="converters."+g,f=a.global._getObject(this,e);f||(f=a.global._getObject(a.global,e));if(!f)throw Error(a.global.utils.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,g));return f};g.prototype.registerType=function(g,e){return a.global._registerObject(this,"types."+g,e)};g.prototype.getType=function(g){g="types."+g;var e=a.global._getObject(this,g);e||
(e=a.global._getObject(a.global,g));return e};g.prototype._getElViewType=function(g){g="elvws."+g;var e=a.global._getObject(this,g);e||(e=a.global._getObject(a.global,g));return e};g.prototype.registerObject=function(g,e){var f=this,k="objects."+g;e instanceof a.BaseObject&&e.addOnDestroyed(function(b,c){a.global._removeObject(f,k)},f.uniqueID);var b=a.global._registerObject(this,k,e);0>this._objMaps.indexOf(b)&&this._objMaps.push(b)};g.prototype.getObject=function(g){return a.global._getObject(this,
"objects."+g)};g.prototype.onStartUp=function(){};g.prototype.startUp=function(g){var e=this,f=function(){e.onStartUp();g&&g.apply(e,[e]);e._setUpBindings()};try{if(g&&!a.global.utils.check.isFunction(g))throw Error(a.ERRS.ERR_APP_SETUP_INVALID);a.global._waitForNotLoading(f,null)}catch(k){a.global.reThrow(k,e._onError(k,e))}};g.prototype.loadTemplates=function(g){this.loadTemplatesAsync(function(){return a.global.utils.performAjaxGet(g)})};g.prototype.loadTemplatesAsync=function(g){a.global._loadTemplatesAsync(g,
this)};g.prototype.registerTemplateLoader=function(g,e){a.global._registerTemplateLoader(this.appName+"."+g,{fn_loader:e})};g.prototype.getTemplateLoader=function(g){var e=a.global._getTemplateLoader(this.appName+"."+g);e||(e=a.global._getTemplateLoader(g));return e};g.prototype.registerTemplateGroup=function(g,e){e=a.global.utils.extend(!1,{fn_loader:null,url:null,names:null,app:this},e);a.global._registerTemplateGroup(this.appName+"."+g,e)};g.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=
!0;try{this._contentFactories=[],a.global._unregisterApp(this),this._destroyBindings(),this._cleanUpObjMaps(),this._exports={},this._modules={},this._elViewStore={},this._userCode={},this._viewModels={},this._contentFactory=null}finally{k.prototype.destroy.call(this)}}};g.prototype.toString=function(){return"Application: "+this.appName};Object.defineProperty(g.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"options",{get:function(){return this._options},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"contentFactory",{get:function(){return this._contentFactory},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"appName",{get:function(){return this._app_name},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"modules",{get:function(){return this._modules},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"global",{get:function(){return a.global},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"UC",{get:function(){return this._userCode},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"VM",{get:function(){return this._viewModels},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"app",{get:function(){return this},enumerable:!0,configurable:!0});return g}(a.BaseObject);a.Application=r;a.global.registerType("Application",r)})(RIAPP||(RIAPP={}));
